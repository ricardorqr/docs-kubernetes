<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Install and Set Up kubectl on macOS</h1><h2 id="before-you-begin">Before you begin</h2><p>You must use a kubectl version that is within one minor version difference of
your cluster. For example, a v1.34 client can communicate
with v1.33, v1.34,
and v1.35 control planes.
Using the latest compatible version of kubectl helps avoid unforeseen issues.</p><h2 id="install-kubectl-on-macos">Install kubectl on macOS</h2><p>The following methods exist for installing kubectl on macOS:</p><ul><li><a href="#install-kubectl-on-macos">Install kubectl on macOS</a><ul><li><a href="#install-kubectl-binary-with-curl-on-macos">Install kubectl binary with curl on macOS</a></li><li><a href="#install-with-homebrew-on-macos">Install with Homebrew on macOS</a></li><li><a href="#install-with-macports-on-macos">Install with Macports on macOS</a></li></ul></li><li><a href="#verify-kubectl-configuration">Verify kubectl configuration</a></li><li><a href="#optional-kubectl-configurations-and-plugins">Optional kubectl configurations and plugins</a><ul><li><a href="#enable-shell-autocompletion">Enable shell autocompletion</a></li><li><a href="#install-kubectl-convert-plugin">Install <code>kubectl convert</code> plugin</a></li></ul></li></ul><h3 id="install-kubectl-binary-with-curl-on-macos">Install kubectl binary with curl on macOS</h3><ol><li><p>Download the latest release:</p><ul class="nav nav-tabs" id="download-binary-macos" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#download-binary-macos-0" role="tab" aria-controls="download-binary-macos-0" aria-selected="true">Intel</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#download-binary-macos-1" role="tab" aria-controls="download-binary-macos-1">Apple Silicon</a></li></ul><div class="tab-content" id="download-binary-macos"><div id="download-binary-macos-0" class="tab-pane show active" role="tabpanel" aria-labelledby="download-binary-macos-0"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/darwin/amd64/kubectl"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div><div id="download-binary-macos-1" class="tab-pane" role="tabpanel" aria-labelledby="download-binary-macos-1"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/darwin/arm64/kubectl"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4><p>To download a specific version, replace the <code>$(curl -L -s https://dl.k8s.io/release/stable.txt)</code>
portion of the command with the specific version.</p><p>For example, to download version 1.34.0 on Intel macOS, type:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>curl -LO <span style="color:#b44">"https://dl.k8s.io/release/v1.34.0/bin/darwin/amd64/kubectl"</span>
</span></span></code></pre></div><p>And for macOS on Apple Silicon, type:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>curl -LO <span style="color:#b44">"https://dl.k8s.io/release/v1.34.0/bin/darwin/arm64/kubectl"</span>
</span></span></code></pre></div></div></li><li><p>Validate the binary (optional)</p><p>Download the kubectl checksum file:</p><ul class="nav nav-tabs" id="download-checksum-macos" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#download-checksum-macos-0" role="tab" aria-controls="download-checksum-macos-0" aria-selected="true">Intel</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#download-checksum-macos-1" role="tab" aria-controls="download-checksum-macos-1">Apple Silicon</a></li></ul><div class="tab-content" id="download-checksum-macos"><div id="download-checksum-macos-0" class="tab-pane show active" role="tabpanel" aria-labelledby="download-checksum-macos-0"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/darwin/amd64/kubectl.sha256"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div><div id="download-checksum-macos-1" class="tab-pane" role="tabpanel" aria-labelledby="download-checksum-macos-1"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/darwin/arm64/kubectl.sha256"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div></div><p>Validate the kubectl binary against the checksum file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b44">"</span><span style="color:#a2f;font-weight:700">$(</span>cat kubectl.sha256<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">  kubectl"</span> | shasum -a <span style="color:#666">256</span> --check
</span></span></code></pre></div><p>If valid, the output is:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console"><span style="display:flex"><span><span style="color:#888">kubectl: OK
</span></span></span></code></pre></div><p>If the check fails, <code>shasum</code> exits with nonzero status and prints output similar to:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console"><span style="display:flex"><span><span style="color:#888">kubectl: FAILED
</span></span></span><span style="display:flex"><span><span style="color:#888">shasum: WARNING: 1 computed checksum did NOT match
</span></span></span></code></pre></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>Download the same version of the binary and checksum.</div></li><li><p>Make the kubectl binary executable.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>chmod +x ./kubectl
</span></span></code></pre></div></li><li><p>Move the kubectl binary to a file location on your system <code>PATH</code>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo mv ./kubectl /usr/local/bin/kubectl
</span></span><span style="display:flex"><span>sudo chown root: /usr/local/bin/kubectl
</span></span></code></pre></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>Make sure <code>/usr/local/bin</code> is in your PATH environment variable.</div></li><li><p>Test to ensure the version you installed is up-to-date:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl version --client
</span></span></code></pre></div><p>Or use this for detailed view of version:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cmd" data-lang="cmd"><span style="display:flex"><span>kubectl version --client --output=yaml
</span></span></code></pre></div></li><li><p>After installing and validating kubectl, delete the checksum file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>rm kubectl.sha256
</span></span></code></pre></div></li></ol><h3 id="install-with-homebrew-on-macos">Install with Homebrew on macOS</h3><p>If you are on macOS and using <a href="https://brew.sh/">Homebrew</a> package manager,
you can install kubectl with Homebrew.</p><ol><li><p>Run the installation command:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>brew install kubectl
</span></span></code></pre></div><p>or</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>brew install kubernetes-cli
</span></span></code></pre></div></li><li><p>Test to ensure the version you installed is up-to-date:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl version --client
</span></span></code></pre></div></li></ol><h3 id="install-with-macports-on-macos">Install with Macports on macOS</h3><p>If you are on macOS and using <a href="https://macports.org/">Macports</a> package manager,
you can install kubectl with Macports.</p><ol><li><p>Run the installation command:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo port selfupdate
</span></span><span style="display:flex"><span>sudo port install kubectl
</span></span></code></pre></div></li><li><p>Test to ensure the version you installed is up-to-date:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl version --client
</span></span></code></pre></div></li></ol><h2 id="verify-kubectl-configuration">Verify kubectl configuration</h2><p>In order for kubectl to find and access a Kubernetes cluster, it needs a
<a href="/docs/concepts/configuration/organize-cluster-access-kubeconfig/">kubeconfig file</a>,
which is created automatically when you create a cluster using
<a href="https://github.com/kubernetes/kubernetes/blob/master/cluster/kube-up.sh">kube-up.sh</a>
or successfully deploy a Minikube cluster.
By default, kubectl configuration is located at <code>~/.kube/config</code>.</p><p>Check that kubectl is properly configured by getting the cluster state:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl cluster-info
</span></span></code></pre></div><p>If you see a URL response, kubectl is correctly configured to access your cluster.</p><p>If you see a message similar to the following, kubectl is not configured correctly
or is not able to connect to a Kubernetes cluster.</p><pre tabindex="0"><code>The connection to the server &lt;server-name:port&gt; was refused - did you specify the right host or port?
</code></pre><p>For example, if you are intending to run a Kubernetes cluster on your laptop (locally),
you will need a tool like <a href="https://minikube.sigs.k8s.io/docs/start/">Minikube</a> to be
installed first and then re-run the commands stated above.</p><p>If <code>kubectl cluster-info</code> returns the url response, but you can't access your cluster,
check whether it is configured properly using the following command:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl cluster-info dump
</span></span></code></pre></div><h3 id="no-auth-provider-found">Troubleshooting the 'No Auth Provider Found' error message</h3><p>In Kubernetes 1.26, kubectl removed the built-in authentication for the following cloud
providers' managed Kubernetes offerings. These providers have released kubectl plugins
to provide the cloud-specific authentication. For instructions, refer to the following provider documentation:</p><ul><li>Azure AKS: <a href="https://azure.github.io/kubelogin/">kubelogin plugin</a></li><li>Google Kubernetes Engine: <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl#install_plugin">gke-gcloud-auth-plugin</a></li></ul><p>There could also be other causes for the same error message that are unrelated
to that change.</p><h2 id="optional-kubectl-configurations-and-plugins">Optional kubectl configurations and plugins</h2><h3 id="enable-shell-autocompletion">Enable shell autocompletion</h3><p>kubectl provides autocompletion support for Bash, Zsh, Fish, and PowerShell
which can save you a lot of typing.</p><p>Below are the procedures to set up autocompletion for Bash, Fish, and Zsh.</p><ul class="nav nav-tabs" id="kubectl-autocompletion" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#kubectl-autocompletion-0" role="tab" aria-controls="kubectl-autocompletion-0" aria-selected="true">Bash</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#kubectl-autocompletion-1" role="tab" aria-controls="kubectl-autocompletion-1">Fish</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#kubectl-autocompletion-2" role="tab" aria-controls="kubectl-autocompletion-2">Zsh</a></li></ul><div class="tab-content" id="kubectl-autocompletion"><div id="kubectl-autocompletion-0" class="tab-pane show active" role="tabpanel" aria-labelledby="kubectl-autocompletion-0"><p><h3 id="introduction">Introduction</h3><p>The kubectl completion script for Bash can be generated with <code>kubectl completion bash</code>.
Sourcing this script in your shell enables kubectl completion.</p><p>However, the kubectl completion script depends on
<a href="https://github.com/scop/bash-completion"><strong>bash-completion</strong></a> which you thus have to previously install.</p><div class="alert alert-danger" role="alert"><h4 class="alert-heading">Warning:</h4>There are two versions of bash-completion, v1 and v2. V1 is for Bash 3.2
(which is the default on macOS), and v2 is for Bash 4.1+. The kubectl completion
script <strong>doesn't work</strong> correctly with bash-completion v1 and Bash 3.2.
It requires <strong>bash-completion v2</strong> and <strong>Bash 4.1+</strong>. Thus, to be able to
correctly use kubectl completion on macOS, you have to install and use
Bash 4.1+ (<a href="https://apple.stackexchange.com/a/292760"><em>instructions</em></a>).
The following instructions assume that you use Bash 4.1+
(that is, any Bash version of 4.1 or newer).</div><h3 id="upgrade-bash">Upgrade Bash</h3><p>The instructions here assume you use Bash 4.1+. You can check your Bash's version by running:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b8860b">$BASH_VERSION</span>
</span></span></code></pre></div><p>If it is too old, you can install/upgrade it using Homebrew:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>brew install bash
</span></span></code></pre></div><p>Reload your shell and verify that the desired version is being used:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b8860b">$BASH_VERSION</span> <span style="color:#b8860b">$SHELL</span>
</span></span></code></pre></div><p>Homebrew usually installs it at <code>/usr/local/bin/bash</code>.</p><h3 id="install-bash-completion">Install bash-completion</h3><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>As mentioned, these instructions assume you use Bash 4.1+, which means you will
install bash-completion v2 (in contrast to Bash 3.2 and bash-completion v1,
in which case kubectl completion won't work).</div><p>You can test if you have bash-completion v2 already installed with <code>type _init_completion</code>.
If not, you can install it with Homebrew:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>brew install bash-completion@2
</span></span></code></pre></div><p>As stated in the output of this command, add the following to your <code>~/.bash_profile</code> file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#b8860b">brew_etc</span><span style="color:#666">=</span><span style="color:#b44">"</span><span style="color:#a2f;font-weight:700">$(</span>brew --prefix<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/etc"</span> <span style="color:#666">&amp;&amp;</span> <span style="color:#666">[[</span> -r <span style="color:#b44">"</span><span style="color:#b68;font-weight:700">${</span><span style="color:#b8860b">brew_etc</span><span style="color:#b68;font-weight:700">}</span><span style="color:#b44">/profile.d/bash_completion.sh"</span> <span style="color:#666">]]</span> <span style="color:#666">&amp;&amp;</span> . <span style="color:#b44">"</span><span style="color:#b68;font-weight:700">${</span><span style="color:#b8860b">brew_etc</span><span style="color:#b68;font-weight:700">}</span><span style="color:#b44">/profile.d/bash_completion.sh"</span>
</span></span></code></pre></div><p>Reload your shell and verify that bash-completion v2 is correctly installed with <code>type _init_completion</code>.</p><h3 id="enable-kubectl-autocompletion">Enable kubectl autocompletion</h3><p>You now have to ensure that the kubectl completion script gets sourced in all
your shell sessions. There are multiple ways to achieve this:</p><ul><li><p>Source the completion script in your <code>~/.bash_profile</code> file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b44">'source &lt;(kubectl completion bash)'</span> &gt;&gt;~/.bash_profile
</span></span></code></pre></div></li><li><p>Add the completion script to the <code>/usr/local/etc/bash_completion.d</code> directory:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl completion bash &gt;/usr/local/etc/bash_completion.d/kubectl
</span></span></code></pre></div></li><li><p>If you have an alias for kubectl, you can extend shell completion to work with that alias:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b44">'alias k=kubectl'</span> &gt;&gt;~/.bash_profile
</span></span><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b44">'complete -o default -F __start_kubectl k'</span> &gt;&gt;~/.bash_profile
</span></span></code></pre></div></li><li><p>If you installed kubectl with Homebrew (as explained
<a href="/docs/tasks/tools/install-kubectl-macos/#install-with-homebrew-on-macos">here</a>),
then the kubectl completion script should already be in <code>/usr/local/etc/bash_completion.d/kubectl</code>.
In that case, you don't need to do anything.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>The Homebrew installation of bash-completion v2 sources all the files in the
<code>BASH_COMPLETION_COMPAT_DIR</code> directory, that's why the latter two methods work.</div></li></ul><p>In any case, after reloading your shell, kubectl completion should be working.</p></p></div><div id="kubectl-autocompletion-1" class="tab-pane" role="tabpanel" aria-labelledby="kubectl-autocompletion-1"><p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>Autocomplete for Fish requires kubectl 1.23 or later.</div><p>The kubectl completion script for Fish can be generated with the command <code>kubectl completion fish</code>. Sourcing the completion script in your shell enables kubectl autocompletion.</p><p>To do so in all your shell sessions, add the following line to your <code>~/.config/fish/config.fish</code> file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl completion fish | <span style="color:#a2f">source</span>
</span></span></code></pre></div><p>After reloading your shell, kubectl autocompletion should be working.</p></p></div><div id="kubectl-autocompletion-2" class="tab-pane" role="tabpanel" aria-labelledby="kubectl-autocompletion-2"><p><p>The kubectl completion script for Zsh can be generated with the command <code>kubectl completion zsh</code>. Sourcing the completion script in your shell enables kubectl autocompletion.</p><p>To do so in all your shell sessions, add the following to your <code>~/.zshrc</code> file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-zsh" data-lang="zsh"><span style="display:flex"><span><span style="color:#a2f">source</span> &lt;<span style="color:#666">(</span>kubectl completion zsh<span style="color:#666">)</span>
</span></span></code></pre></div><p>If you have an alias for kubectl, kubectl autocompletion will automatically work with it.</p><p>After reloading your shell, kubectl autocompletion should be working.</p><p>If you get an error like <code>2: command not found: compdef</code>, then add the following to the beginning of your <code>~/.zshrc</code> file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-zsh" data-lang="zsh"><span style="display:flex"><span>autoload -Uz compinit
</span></span><span style="display:flex"><span>compinit
</span></span></code></pre></div></p></div></div><h3 id="configure-kuberc">Configure kuberc</h3><p>See <a href="/docs/reference/kubectl/kuberc/">kuberc</a> for more information.</p><h3 id="install-kubectl-convert-plugin">Install <code>kubectl convert</code> plugin</h3><p>A plugin for Kubernetes command-line tool <code>kubectl</code>, which allows you to convert manifests between different API
versions. This can be particularly helpful to migrate manifests to a non-deprecated api version with newer Kubernetes release.
For more info, visit <a href="/docs/reference/using-api/deprecation-guide/#migrate-to-non-deprecated-apis">migrate to non deprecated apis</a></p><ol><li><p>Download the latest release with the command:</p><ul class="nav nav-tabs" id="download-convert-binary-macos" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#download-convert-binary-macos-0" role="tab" aria-controls="download-convert-binary-macos-0" aria-selected="true">Intel</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#download-convert-binary-macos-1" role="tab" aria-controls="download-convert-binary-macos-1">Apple Silicon</a></li></ul><div class="tab-content" id="download-convert-binary-macos"><div id="download-convert-binary-macos-0" class="tab-pane show active" role="tabpanel" aria-labelledby="download-convert-binary-macos-0"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/darwin/amd64/kubectl-convert"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div><div id="download-convert-binary-macos-1" class="tab-pane" role="tabpanel" aria-labelledby="download-convert-binary-macos-1"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/darwin/arm64/kubectl-convert"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div></div></li><li><p>Validate the binary (optional)</p><p>Download the kubectl-convert checksum file:</p><ul class="nav nav-tabs" id="download-convert-checksum-macos" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#download-convert-checksum-macos-0" role="tab" aria-controls="download-convert-checksum-macos-0" aria-selected="true">Intel</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#download-convert-checksum-macos-1" role="tab" aria-controls="download-convert-checksum-macos-1">Apple Silicon</a></li></ul><div class="tab-content" id="download-convert-checksum-macos"><div id="download-convert-checksum-macos-0" class="tab-pane show active" role="tabpanel" aria-labelledby="download-convert-checksum-macos-0"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/darwin/amd64/kubectl-convert.sha256"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div><div id="download-convert-checksum-macos-1" class="tab-pane" role="tabpanel" aria-labelledby="download-convert-checksum-macos-1"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/darwin/arm64/kubectl-convert.sha256"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div></div><p>Validate the kubectl-convert binary against the checksum file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b44">"</span><span style="color:#a2f;font-weight:700">$(</span>cat kubectl-convert.sha256<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">  kubectl-convert"</span> | shasum -a <span style="color:#666">256</span> --check
</span></span></code></pre></div><p>If valid, the output is:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console"><span style="display:flex"><span><span style="color:#888">kubectl-convert: OK
</span></span></span></code></pre></div><p>If the check fails, <code>shasum</code> exits with nonzero status and prints output similar to:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console"><span style="display:flex"><span><span style="color:#888">kubectl-convert: FAILED
</span></span></span><span style="display:flex"><span><span style="color:#888">shasum: WARNING: 1 computed checksum did NOT match
</span></span></span></code></pre></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>Download the same version of the binary and checksum.</div></li><li><p>Make kubectl-convert binary executable</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>chmod +x ./kubectl-convert
</span></span></code></pre></div></li><li><p>Move the kubectl-convert binary to a file location on your system <code>PATH</code>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo mv ./kubectl-convert /usr/local/bin/kubectl-convert
</span></span><span style="display:flex"><span>sudo chown root: /usr/local/bin/kubectl-convert
</span></span></code></pre></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>Make sure <code>/usr/local/bin</code> is in your PATH environment variable.</div></li><li><p>Verify plugin is successfully installed</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl convert --help
</span></span></code></pre></div><p>If you do not see an error, it means the plugin is successfully installed.</p></li><li><p>After installing the plugin, clean up the installation files:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>rm kubectl-convert kubectl-convert.sha256
</span></span></code></pre></div></li></ol><h3 id="uninstall-kubectl-on-macos">Uninstall kubectl on macOS</h3><p>Depending on how you installed <code>kubectl</code>, use one of the following methods.</p><h3 id="uninstall-kubectl-using-the-command-line">Uninstall kubectl using the command-line</h3><ol><li><p>Locate the <code>kubectl</code> binary on your system:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>which kubectl
</span></span></code></pre></div></li><li><p>Remove the <code>kubectl</code> binary:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo rm &lt;path&gt;
</span></span></code></pre></div><p>Replace <code>&lt;path&gt;</code> with the path to the <code>kubectl</code> binary from the previous step. For example, <code>sudo rm /usr/local/bin/kubectl</code>.</p></li></ol><h3 id="uninstall-kubectl-using-homebrew">Uninstall kubectl using homebrew</h3><p>If you installed <code>kubectl</code> using Homebrew, run the following command:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>brew remove kubectl
</span></span></code></pre></div><h2 id="what-s-next">What's next</h2><ul><li><a href="https://minikube.sigs.k8s.io/docs/start/">Install Minikube</a></li><li>See the <a href="/docs/setup/">getting started guides</a> for more about creating clusters.</li><li><a href="/docs/tasks/access-application-cluster/service-access-application-cluster/">Learn how to launch and expose your application.</a></li><li>If you need access to a cluster you didn't create, see the
<a href="/docs/tasks/access-application-cluster/configure-access-multiple-clusters/">Sharing Cluster Access document</a>.</li><li>Read the <a href="/docs/reference/kubectl/kubectl/">kubectl reference docs</a></li></ul></div>
<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Issue a Certificate for a Kubernetes API Client Using A CertificateSigningRequest</h1><p>Kubernetes lets you use a public key infrastructure (PKI) to authenticate to your cluster
as a client.</p><p>A few steps are required in order to get a normal user to be able to
authenticate and invoke an API. First, this user must have an <a href="https://www.itu.int/rec/T-REC-X.509">X.509</a> certificate
issued by an authority that your Kubernetes cluster trusts. The client must then present that certificate to the Kubernetes API.</p><p>You use a <a href="/concepts/security/certificate-signing-requests/">CertificateSigningRequest</a>
as part of this process, and either you or some other principal must approve the request.</p><p>You will create a private key, and then get a certificate issued, and finally configure
that private key for a client.</p><h2 id="before-you-begin">Before you begin</h2><ul><li><p>You need to have a Kubernetes cluster, and the kubectl command-line tool must
be configured to communicate with your cluster. It is recommended to run this tutorial on a cluster with at least two nodes that are not acting as control plane hosts. If you do not already have a
cluster, you can create one by using
<a href="https://minikube.sigs.k8s.io/docs/tutorials/multi_node/">minikube</a>
or you can use one of these Kubernetes playgrounds:</p><ul><li><a href="https://labs.iximiuz.com/playgrounds?category=kubernetes&amp;filter=all">iximiuz Labs</a></li><li><a href="https://killercoda.com/playgrounds/scenario/kubernetes">Killercoda</a></li><li><a href="https://kodekloud.com/public-playgrounds">KodeKloud</a></li><li><a href="https://labs.play-with-k8s.com/">Play with Kubernetes</a></li></ul></li><li><p>You need the <code>kubectl</code>, <code>openssl</code> and <code>base64</code> utilities.</p></li></ul><p>This page assumes you are using Kubernetes <a class="glossary-tooltip" title="Manages authorization decisions, allowing admins to dynamically configure access policies through the Kubernetes API." data-toggle="tooltip" data-placement="top" href="/docs/reference/access-authn-authz/rbac/" target="_blank" aria-label="role based access control">role based access control</a> (RBAC).
If you have alternative or additional security mechanisms around authorization, you need to account for those as well.</p><h2 id="create-private-key">Create private key</h2><p>In this step, you create a private key. You need to keep this document secret; anyone who has it can impersonate the user.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Create a private key</span>
</span></span><span style="display:flex"><span>openssl genrsa -out myuser.key <span style="color:#666">3072</span>
</span></span></code></pre></div><h2 id="create-x.509-certificatessigningrequest">Create an X.509 certificate signing request</h2><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>This is not the same as the similarly-named CertificateSigningRequest API; the file you generate here goes into the
CertificateSigningRequest.</div><p>It is important to set CN and O attribute of the CSR. CN is the name of the user and O is the group that this user will belong to.
You can refer to <a href="/docs/reference/access-authn-authz/rbac/">RBAC</a> for standard groups.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Change the common name "myuser" to the actual username that you want to use</span>
</span></span><span style="display:flex"><span>openssl req -new -key myuser.key -out myuser.csr -subj <span style="color:#b44">"/CN=myuser"</span>
</span></span></code></pre></div><h2 id="create-k8s-certificatessigningrequest">Create a Kubernetes CertificateSigningRequest</h2><p>Encode the CSR document using this command:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>cat myuser.csr | base64 | tr -d <span style="color:#b44">"\n"</span>
</span></span></code></pre></div><p>Create a <a href="/docs/reference/kubernetes-api/authentication-resources/certificate-signing-request-v1/">CertificateSigningRequest</a>
and submit it to a Kubernetes Cluster via kubectl. Below is a snippet of shell that you can use to generate the
CertificateSigningRequest.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>cat <span style="color:#b44">&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style="display:flex"><span><span style="color:#b44">apiVersion: certificates.k8s.io/v1
</span></span></span><span style="display:flex"><span><span style="color:#b44">kind: CertificateSigningRequest
</span></span></span><span style="display:flex"><span><span style="color:#b44">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#b44">  name: myuser # example
</span></span></span><span style="display:flex"><span><span style="color:#b44">spec:
</span></span></span><span style="display:flex"><span><span style="color:#b44">  # This is an encoded CSR. Change this to the base64-encoded contents of myuser.csr
</span></span></span><span style="display:flex"><span><span style="color:#b44">  request: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0KTUlJQ1ZqQ0NBVDRDQVFBd0VURVBNQTBHQTFVRUF3d0dZVzVuWld4aE1JSUJJakFOQmdrcWhraUc5dzBCQVFFRgpBQU9DQVE4QU1JSUJDZ0tDQVFFQTByczhJTHRHdTYxakx2dHhWTTJSVlRWMDNHWlJTWWw0dWluVWo4RElaWjBOCnR2MUZtRVFSd3VoaUZsOFEzcWl0Qm0wMUFSMkNJVXBGd2ZzSjZ4MXF3ckJzVkhZbGlBNVhwRVpZM3ExcGswSDQKM3Z3aGJlK1o2MVNrVHF5SVBYUUwrTWM5T1Nsbm0xb0R2N0NtSkZNMUlMRVI3QTVGZnZKOEdFRjJ6dHBoaUlFMwpub1dtdHNZb3JuT2wzc2lHQ2ZGZzR4Zmd4eW8ybmlneFNVekl1bXNnVm9PM2ttT0x1RVF6cXpkakJ3TFJXbWlECklmMXBMWnoyalVnald4UkhCM1gyWnVVV1d1T09PZnpXM01LaE8ybHEvZi9DdS8wYk83c0x0MCt3U2ZMSU91TFcKcW90blZtRmxMMytqTy82WDNDKzBERHk5aUtwbXJjVDBnWGZLemE1dHJRSURBUUFCb0FBd0RRWUpLb1pJaHZjTgpBUUVMQlFBRGdnRUJBR05WdmVIOGR4ZzNvK21VeVRkbmFjVmQ1N24zSkExdnZEU1JWREkyQTZ1eXN3ZFp1L1BVCkkwZXpZWFV0RVNnSk1IRmQycVVNMjNuNVJsSXJ3R0xuUXFISUh5VStWWHhsdnZsRnpNOVpEWllSTmU3QlJvYXgKQVlEdUI5STZXT3FYbkFvczFqRmxNUG5NbFpqdU5kSGxpT1BjTU1oNndLaTZzZFhpVStHYTJ2RUVLY01jSVUyRgpvU2djUWdMYTk0aEpacGk3ZnNMdm1OQUxoT045UHdNMGM1dVJVejV4T0dGMUtCbWRSeEgvbUNOS2JKYjFRQm1HCkkwYitEUEdaTktXTU0xMzhIQXdoV0tkNjVoVHdYOWl4V3ZHMkh4TG1WQzg0L1BHT0tWQW9FNkpsYWFHdTlQVmkKdjlOSjVaZlZrcXdCd0hKbzZXdk9xVlA3SVFjZmg3d0drWm89Ci0tLS0tRU5EIENFUlRJRklDQVRFIFJFUVVFU1QtLS0tLQo=
</span></span></span><span style="display:flex"><span><span style="color:#b44">  signerName: kubernetes.io/kube-apiserver-client
</span></span></span><span style="display:flex"><span><span style="color:#b44">  expirationSeconds: 86400  # one day
</span></span></span><span style="display:flex"><span><span style="color:#b44">  usages:
</span></span></span><span style="display:flex"><span><span style="color:#b44">  - client auth
</span></span></span><span style="display:flex"><span><span style="color:#b44">EOF</span>
</span></span></code></pre></div><p>Some points to note:</p><ul><li><code>usages</code> has to be <code>client auth</code></li><li><code>expirationSeconds</code> could be made longer (i.e. <code>864000</code> for ten days) or shorter (i.e. <code>3600</code> for one hour).
You cannot request a duration shorter than 10 minutes.</li><li><code>request</code> is the base64 encoded value of the CSR file content.</li></ul><h2 id="approve-certificate-signing-request">Approve the CertificateSigningRequest</h2><p>Use kubectl to find the CSR you made, and manually approve it.</p><p>Get the list of CSRs:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get csr
</span></span></code></pre></div><p>Approve the CSR:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl certificate approve myuser
</span></span></code></pre></div><h2 id="get-the-certificate">Get the certificate</h2><p>Retrieve the certificate from the CSR, to check it looks OK.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get csr/myuser -o yaml
</span></span></code></pre></div><p>The certificate value is in Base64-encoded format under <code>.status.certificate</code>.</p><p>Export the issued certificate from the CertificateSigningRequest.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get csr myuser -o <span style="color:#b8860b">jsonpath</span><span style="color:#666">=</span><span style="color:#b44">'{.status.certificate}'</span>| base64 -d &gt; myuser.crt
</span></span></code></pre></div><h2 id="configure-the-certificate-into-kubeconfig">Configure the certificate into kubeconfig</h2><p>The next step is to add this user into the kubeconfig file.</p><p>First, you need to add new credentials:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl config set-credentials myuser --client-key<span style="color:#666">=</span>myuser.key --client-certificate<span style="color:#666">=</span>myuser.crt --embed-certs<span style="color:#666">=</span><span style="color:#a2f">true</span>
</span></span></code></pre></div><p>Then, you need to add the context:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl config set-context myuser --cluster<span style="color:#666">=</span>kubernetes --user<span style="color:#666">=</span>myuser
</span></span></code></pre></div><p>To test it:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl --context myuser auth whoami
</span></span></code></pre></div><p>You should see output confirming that you are “myuser“.</p><h2 id="create-role-and-rolebinding">Create Role and RoleBinding</h2><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>If you don't use Kubernetes RBAC, skip this step and make the appropriate changes for the authorization mechanism
your cluster actually uses.</div><p>With the certificate created it is time to define the Role and RoleBinding for
this user to access Kubernetes cluster resources.</p><p>This is a sample command to create a Role for this new user:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create role developer --verb<span style="color:#666">=</span>create --verb<span style="color:#666">=</span>get --verb<span style="color:#666">=</span>list --verb<span style="color:#666">=</span>update --verb<span style="color:#666">=</span>delete --resource<span style="color:#666">=</span>pods
</span></span></code></pre></div><p>This is a sample command to create a RoleBinding for this new user:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create rolebinding developer-binding-myuser --role<span style="color:#666">=</span>developer --user<span style="color:#666">=</span>myuser
</span></span></code></pre></div><h2 id="what-s-next">What's next</h2><ul><li>Read <a href="/docs/tasks/tls/managing-tls-in-a-cluster/">Manage TLS Certificates in a Cluster</a></li><li>For details of X.509 itself, refer to <a href="https://tools.ietf.org/html/rfc5280#section-3.1">RFC 5280</a> section 3.1</li><li>For information on the syntax of PKCS#10 certificate signing requests, refer to <a href="https://tools.ietf.org/html/rfc2986">RFC 2986</a></li><li>Read about <a href="/docs/reference/access-authn-authz/certificate-signing-requests/#cluster-trust-bundles">ClusterTrustBundles</a></li></ul></div>
<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Manual Rotation of CA Certificates</h1><p>This page shows how to manually rotate the certificate authority (CA) certificates.</p><h2 id="before-you-begin">Before you begin</h2><p>You need to have a Kubernetes cluster, and the kubectl command-line tool must
be configured to communicate with your cluster. It is recommended to run this tutorial on a cluster with at least two nodes that are not acting as control plane hosts. If you do not already have a
cluster, you can create one by using
<a href="https://minikube.sigs.k8s.io/docs/tutorials/multi_node/">minikube</a>
or you can use one of these Kubernetes playgrounds:</p><ul><li><a href="https://labs.iximiuz.com/playgrounds?category=kubernetes&amp;filter=all">iximiuz Labs</a></li><li><a href="https://killercoda.com/playgrounds/scenario/kubernetes">Killercoda</a></li><li><a href="https://kodekloud.com/public-playgrounds">KodeKloud</a></li><li><a href="https://labs.play-with-k8s.com/">Play with Kubernetes</a></li></ul><ul><li>For more information about authentication in Kubernetes, see
<a href="/docs/reference/access-authn-authz/authentication/">Authenticating</a>.</li><li>For more information about best practices for CA certificates, see
<a href="/docs/setup/best-practices/certificates/#single-root-ca">Single root CA</a>.</li></ul><h2 id="rotate-the-ca-certificates-manually">Rotate the CA certificates manually</h2><div class="alert alert-caution" role="alert"><h4 class="alert-heading">Caution:</h4><p>Make sure to back up your certificate directory along with configuration files and any other necessary files.</p><p>This approach assumes operation of the Kubernetes control plane in a HA configuration with multiple API servers.
Graceful termination of the API server is also assumed so clients can cleanly disconnect from one API server and
reconnect to another.</p><p>Configurations with a single API server will experience unavailability while the API server is being restarted.</p></div><ol><li><p>Distribute the new CA certificates and private keys (for example: <code>ca.crt</code>, <code>ca.key</code>, <code>front-proxy-ca.crt</code>,
and <code>front-proxy-ca.key</code>) to all your control plane nodes in the Kubernetes certificates directory.</p></li><li><p>Update the <code>--root-ca-file</code> flag for the <a class="glossary-tooltip" title="Control Plane component that runs controller processes." data-toggle="tooltip" data-placement="top" href="/docs/reference/command-line-tools-reference/kube-controller-manager/" target="_blank" aria-label="kube-controller-manager">kube-controller-manager</a> to include
both old and new CA, then restart the kube-controller-manager.</p><p>Any <a class="glossary-tooltip" title="Provides an identity for processes that run in a Pod." data-toggle="tooltip" data-placement="top" href="/docs/tasks/configure-pod-container/configure-service-account/" target="_blank" aria-label="ServiceAccount">ServiceAccount</a> created after this point will get
Secrets that include both old and new CAs.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4><p>The files specified by the kube-controller-manager flags <code>--client-ca-file</code> and <code>--cluster-signing-cert-file</code>
cannot be CA bundles. If these flags and <code>--root-ca-file</code> point to the same <code>ca.crt</code> file which is now a
bundle (includes both old and new CA) you will face an error. To workaround this problem you can copy the new CA
to a separate file and make the flags <code>--client-ca-file</code> and <code>--cluster-signing-cert-file</code> point to the copy.
Once <code>ca.crt</code> is no longer a bundle you can restore the problem flags to point to <code>ca.crt</code> and delete the copy.</p><p><a href="https://github.com/kubernetes/kubeadm/issues/1350">Issue 1350</a> for kubeadm tracks an bug with the
kube-controller-manager being unable to accept a CA bundle.</p></div></li><li><p>Wait for the controller manager to update <code>ca.crt</code> in the service account Secrets to include both old and new CA certificates.</p><p>If any Pods are started before new CA is used by API servers, the new Pods get this update and will trust both
old and new CAs.</p></li><li><p>Restart all pods using in-cluster configurations (for example: kube-proxy, CoreDNS, etc) so they can use the
updated certificate authority data from Secrets that link to ServiceAccounts.</p><ul><li>Make sure CoreDNS, kube-proxy and other Pods using in-cluster configurations are working as expected.</li></ul></li><li><p>Append the both old and new CA to the file against <code>--client-ca-file</code> and <code>--kubelet-certificate-authority</code>
flag in the <code>kube-apiserver</code> configuration.</p></li><li><p>Append the both old and new CA to the file against <code>--client-ca-file</code> flag in the <code>kube-scheduler</code> configuration.</p></li><li><p>Update certificates for user accounts by replacing the content of <code>client-certificate-data</code> and <code>client-key-data</code>
respectively.</p><p>For information about creating certificates for individual user accounts, see
<a href="/docs/setup/best-practices/certificates/#configure-certificates-for-user-accounts">Configure certificates for user accounts</a>.</p><p>Additionally, update the <code>certificate-authority-data</code> section in the kubeconfig files,
respectively with Base64-encoded old and new certificate authority data</p></li><li><p>Update the <code>--root-ca-file</code> flag for the <a class="glossary-tooltip" title="Control plane component that integrates Kubernetes with third-party cloud providers." data-toggle="tooltip" data-placement="top" href="/docs/concepts/architecture/cloud-controller/" target="_blank" aria-label="Cloud Controller Manager">Cloud Controller Manager</a> to include
both old and new CA, then restart the cloud-controller-manager.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>If your cluster does not have a cloud-controller-manager, you can skip this step.</div></li><li><p>Follow the steps below in a rolling fashion.</p><ol><li><p>Restart any other
<a href="/docs/concepts/extend-kubernetes/api-extension/apiserver-aggregation/">aggregated API servers</a> or
webhook handlers to trust the new CA certificates.</p></li><li><p>Restart the kubelet by update the file against <code>clientCAFile</code> in kubelet configuration and
<code>certificate-authority-data</code> in <code>kubelet.conf</code> to use both the old and new CA on all nodes.</p><p>If your kubelet is not using client certificate rotation, update <code>client-certificate-data</code> and
<code>client-key-data</code> in <code>kubelet.conf</code> on all nodes along with the kubelet client certificate file
usually found in <code>/var/lib/kubelet/pki</code>.</p></li><li><p>Restart API servers with the certificates (<code>apiserver.crt</code>, <code>apiserver-kubelet-client.crt</code> and
<code>front-proxy-client.crt</code>) signed by new CA.
You can use the existing private keys or new private keys.
If you changed the private keys then update these in the Kubernetes certificates directory as well.</p><p>Since the Pods in your cluster trust both old and new CAs, there will be a momentarily disconnection
after which pods' Kubernetes clients reconnect to the new API server.
The new API server uses a certificate signed by the new CA.</p><ul><li>Restart the <a class="glossary-tooltip" title="Control plane component that watches for newly created pods with no assigned node, and selects a node for them to run on." data-toggle="tooltip" data-placement="top" href="/docs/reference/command-line-tools-reference/kube-scheduler/" target="_blank" aria-label="kube-scheduler">kube-scheduler</a> to use and
trust the new CAs.</li><li>Make sure control plane components logs no TLS errors.</li></ul><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4><pre><code>  To generate certificates and private keys for your cluster using the `openssl` command line tool,
  see [Certificates (`openssl`)](/docs/tasks/administer-cluster/certificates/#openssl).
  You can also use [`cfssl`](/docs/tasks/administer-cluster/certificates/#cfssl).
</code></pre></div></li><li><p>Annotate any DaemonSets and Deployments to trigger pod replacement in a safer rolling fashion.</p></li></ol><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#a2f;font-weight:700">for</span> namespace in <span style="color:#a2f;font-weight:700">$(</span>kubectl get namespace -o <span style="color:#b8860b">jsonpath</span><span style="color:#666">=</span><span style="color:#b44">'{.items[*].metadata.name}'</span><span style="color:#a2f;font-weight:700">)</span>; <span style="color:#a2f;font-weight:700">do</span>
</span></span><span style="display:flex"><span>    <span style="color:#a2f;font-weight:700">for</span> name in <span style="color:#a2f;font-weight:700">$(</span>kubectl get deployments -n <span style="color:#b8860b">$namespace</span> -o <span style="color:#b8860b">jsonpath</span><span style="color:#666">=</span><span style="color:#b44">'{.items[*].metadata.name}'</span><span style="color:#a2f;font-weight:700">)</span>; <span style="color:#a2f;font-weight:700">do</span>
</span></span><span style="display:flex"><span>        kubectl patch deployment -n <span style="color:#b68;font-weight:700">${</span><span style="color:#b8860b">namespace</span><span style="color:#b68;font-weight:700">}</span> <span style="color:#b68;font-weight:700">${</span><span style="color:#b8860b">name</span><span style="color:#b68;font-weight:700">}</span> -p <span style="color:#b44">'{"spec":{"template":{"metadata":{"annotations":{"ca-rotation": "1"}}}}}'</span>;
</span></span><span style="display:flex"><span>    <span style="color:#a2f;font-weight:700">done</span>
</span></span><span style="display:flex"><span>    <span style="color:#a2f;font-weight:700">for</span> name in <span style="color:#a2f;font-weight:700">$(</span>kubectl get daemonset -n <span style="color:#b8860b">$namespace</span> -o <span style="color:#b8860b">jsonpath</span><span style="color:#666">=</span><span style="color:#b44">'{.items[*].metadata.name}'</span><span style="color:#a2f;font-weight:700">)</span>; <span style="color:#a2f;font-weight:700">do</span>
</span></span><span style="display:flex"><span>        kubectl patch daemonset -n <span style="color:#b68;font-weight:700">${</span><span style="color:#b8860b">namespace</span><span style="color:#b68;font-weight:700">}</span> <span style="color:#b68;font-weight:700">${</span><span style="color:#b8860b">name</span><span style="color:#b68;font-weight:700">}</span> -p <span style="color:#b44">'{"spec":{"template":{"metadata":{"annotations":{"ca-rotation": "1"}}}}}'</span>;
</span></span><span style="display:flex"><span>    <span style="color:#a2f;font-weight:700">done</span>
</span></span><span style="display:flex"><span><span style="color:#a2f;font-weight:700">done</span>
</span></span></code></pre></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4><pre><code>  To limit the number of concurrent disruptions that your application experiences,
  see [configure pod disruption budget](/docs/tasks/run-application/configure-pdb/).
</code></pre></div><pre><code> Depending on how you use StatefulSets you may also need to perform similar rolling replacement.
</code></pre></li><li><p>If your cluster is using bootstrap tokens to join nodes, update the ConfigMap <code>cluster-info</code> in the <code>kube-public</code>
namespace with new CA.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#b8860b">base64_encoded_ca</span><span style="color:#666">=</span><span style="color:#b44">"</span><span style="color:#a2f;font-weight:700">$(</span>base64 -w0 /etc/kubernetes/pki/ca.crt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">"</span>
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>kubectl get cm/cluster-info --namespace kube-public -o yaml | <span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>    /bin/sed <span style="color:#b44">"s/\(certificate-authority-data:\).*/\1 </span><span style="color:#b68;font-weight:700">${</span><span style="color:#b8860b">base64_encoded_ca</span><span style="color:#b68;font-weight:700">}</span><span style="color:#b44">/"</span> | <span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>    kubectl apply -f -
</span></span></code></pre></div></li><li><p>Verify the cluster functionality.</p><ol><li><p>Check the logs from control plane components, along with the kubelet and the kube-proxy.
Ensure those components are not reporting any TLS errors; see
<a href="/docs/tasks/debug/debug-cluster/#looking-at-logs">looking at the logs</a> for more details.</p></li><li><p>Validate logs from any aggregated api servers and pods using in-cluster config.</p></li></ol></li><li><p>Once the cluster functionality is successfully verified:</p><ol><li><p>Update all service account tokens to include new CA certificate only.</p><ul><li>All pods using an in-cluster kubeconfig will eventually need to be restarted to pick up the new Secret,
so that no Pods are relying on the old cluster CA.</li></ul></li><li><p>Restart the control plane components by removing the old CA from the kubeconfig files and the files against
<code>--client-ca-file</code>, <code>--root-ca-file</code> flags resp.</p></li><li><p>On each node, restart the kubelet by removing the old CA from file against the <code>clientCAFile</code> flag
and from the kubelet kubeconfig file. You should carry this out as a rolling update.</p><p>If your cluster lets you make this change, you can also roll it out by replacing nodes rather than
reconfiguring them.</p></li></ol></li></ol></div>
<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Install and Set Up kubectl on Windows</h1><h2 id="before-you-begin">Before you begin</h2><p>You must use a kubectl version that is within one minor version difference of
your cluster. For example, a v1.34 client can communicate
with v1.33, v1.34,
and v1.35 control planes.
Using the latest compatible version of kubectl helps avoid unforeseen issues.</p><h2 id="install-kubectl-on-windows">Install kubectl on Windows</h2><p>The following methods exist for installing kubectl on Windows:</p><ul><li><a href="#install-kubectl-binary-on-windows-via-direct-download-or-curl">Install kubectl binary on Windows (via direct download or curl)</a></li><li><a href="#install-nonstandard-package-tools">Install on Windows using Chocolatey, Scoop, or winget</a></li></ul><h3 id="install-kubectl-binary-on-windows-via-direct-download-or-curl">Install kubectl binary on Windows (via direct download or curl)</h3><ol><li><p>You have two options for installing kubectl on your Windows device</p><ul><li><p>Direct download:</p><p>Download the latest 1.34 patch release binary directly for your specific architecture by visiting the <a href="https://kubernetes.io/releases/download/#binaries">Kubernetes release page</a>. Be sure to select the correct binary for your architecture (e.g., amd64, arm64, etc.).</p></li><li><p>Using curl:</p><p>If you have <code>curl</code> installed, use this command:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span>curl.exe -LO <span style="color:#b44">"https://dl.k8s.io/release/v1.34.0/bin/windows/amd64/kubectl.exe"</span>
</span></span></code></pre></div></li></ul><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>To find out the latest stable version (for example, for scripting), take a look at
<a href="https://dl.k8s.io/release/stable.txt">https://dl.k8s.io/release/stable.txt</a>.</div></li><li><p>Validate the binary (optional)</p><p>Download the <code>kubectl</code> checksum file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span>curl.exe -LO <span style="color:#b44">"https://dl.k8s.io/v1.34.0/bin/windows/amd64/kubectl.exe.sha256"</span>
</span></span></code></pre></div><p>Validate the <code>kubectl</code> binary against the checksum file:</p><ul><li><p>Using Command Prompt to manually compare <code>CertUtil</code>'s output to the checksum file downloaded:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cmd" data-lang="cmd"><span style="display:flex"><span>CertUtil -hashfile kubectl.exe SHA256
</span></span><span style="display:flex"><span><span style="color:#a2f;font-weight:700">type</span> kubectl.exe.sha256
</span></span></code></pre></div></li><li><p>Using PowerShell to automate the verification using the <code>-eq</code> operator to
get a <code>True</code> or <code>False</code> result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span> $(<span style="color:#a2f">Get-FileHash</span> -Algorithm SHA256 .\kubectl.exe).Hash <span style="color:#666">-eq</span> $(<span style="color:#a2f">Get-Content</span> .\kubectl.exe.sha256)
</span></span></code></pre></div></li></ul></li><li><p>Append or prepend the <code>kubectl</code> binary folder to your <code>PATH</code> environment variable.</p></li><li><p>Test to ensure the version of <code>kubectl</code> is the same as downloaded:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cmd" data-lang="cmd"><span style="display:flex"><span>kubectl version --client
</span></span></code></pre></div><p>Or use this for detailed view of version:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cmd" data-lang="cmd"><span style="display:flex"><span>kubectl version --client --output=yaml
</span></span></code></pre></div></li></ol><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4><a href="https://docs.docker.com/docker-for-windows/#kubernetes">Docker Desktop for Windows</a>
adds its own version of <code>kubectl</code> to <code>PATH</code>. If you have installed Docker Desktop before,
you may need to place your <code>PATH</code> entry before the one added by the Docker Desktop
installer or remove the Docker Desktop's <code>kubectl</code>.</div><h3 id="install-nonstandard-package-tools">Install on Windows using Chocolatey, Scoop, or winget</h3><ol><li><p>To install kubectl on Windows you can use either <a href="https://chocolatey.org">Chocolatey</a>
package manager, <a href="https://scoop.sh">Scoop</a> command-line installer, or
<a href="https://learn.microsoft.com/en-us/windows/package-manager/winget/">winget</a> package manager.</p><ul class="nav nav-tabs" id="kubectl-win-install" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#kubectl-win-install-0" role="tab" aria-controls="kubectl-win-install-0" aria-selected="true">choco</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#kubectl-win-install-1" role="tab" aria-controls="kubectl-win-install-1">scoop</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#kubectl-win-install-2" role="tab" aria-controls="kubectl-win-install-2">winget</a></li></ul><div class="tab-content" id="kubectl-win-install"><div id="kubectl-win-install-0" class="tab-pane show active" role="tabpanel" aria-labelledby="kubectl-win-install-0"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span>choco install <span style="color:#a2f">kubernetes-cli</span>
</span></span></code></pre></div></p></div><div id="kubectl-win-install-1" class="tab-pane" role="tabpanel" aria-labelledby="kubectl-win-install-1"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span>scoop install kubectl
</span></span></code></pre></div></p></div><div id="kubectl-win-install-2" class="tab-pane" role="tabpanel" aria-labelledby="kubectl-win-install-2"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span>winget install -e --id Kubernetes.kubectl
</span></span></code></pre></div></p></div></div></li><li><p>Test to ensure the version you installed is up-to-date:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span>kubectl version --client
</span></span></code></pre></div></li><li><p>Navigate to your home directory:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># If you're using cmd.exe, run: cd %USERPROFILE%</span>
</span></span><span style="display:flex"><span><span style="color:#a2f">cd </span>~
</span></span></code></pre></div></li><li><p>Create the <code>.kube</code> directory:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span>mkdir .kube
</span></span></code></pre></div></li><li><p>Change to the <code>.kube</code> directory you just created:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span><span style="color:#a2f">cd </span>.kube
</span></span></code></pre></div></li><li><p>Configure kubectl to use a remote Kubernetes cluster:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span><span style="color:#a2f">New-Item</span> config -type file
</span></span></code></pre></div></li></ol><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>Edit the config file with a text editor of your choice, such as Notepad.</div><h2 id="verify-kubectl-configuration">Verify kubectl configuration</h2><p>In order for kubectl to find and access a Kubernetes cluster, it needs a
<a href="/docs/concepts/configuration/organize-cluster-access-kubeconfig/">kubeconfig file</a>,
which is created automatically when you create a cluster using
<a href="https://github.com/kubernetes/kubernetes/blob/master/cluster/kube-up.sh">kube-up.sh</a>
or successfully deploy a Minikube cluster.
By default, kubectl configuration is located at <code>~/.kube/config</code>.</p><p>Check that kubectl is properly configured by getting the cluster state:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl cluster-info
</span></span></code></pre></div><p>If you see a URL response, kubectl is correctly configured to access your cluster.</p><p>If you see a message similar to the following, kubectl is not configured correctly
or is not able to connect to a Kubernetes cluster.</p><pre tabindex="0"><code>The connection to the server &lt;server-name:port&gt; was refused - did you specify the right host or port?
</code></pre><p>For example, if you are intending to run a Kubernetes cluster on your laptop (locally),
you will need a tool like <a href="https://minikube.sigs.k8s.io/docs/start/">Minikube</a> to be
installed first and then re-run the commands stated above.</p><p>If <code>kubectl cluster-info</code> returns the url response, but you can't access your cluster,
check whether it is configured properly using the following command:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl cluster-info dump
</span></span></code></pre></div><h3 id="no-auth-provider-found">Troubleshooting the 'No Auth Provider Found' error message</h3><p>In Kubernetes 1.26, kubectl removed the built-in authentication for the following cloud
providers' managed Kubernetes offerings. These providers have released kubectl plugins
to provide the cloud-specific authentication. For instructions, refer to the following provider documentation:</p><ul><li>Azure AKS: <a href="https://azure.github.io/kubelogin/">kubelogin plugin</a></li><li>Google Kubernetes Engine: <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl#install_plugin">gke-gcloud-auth-plugin</a></li></ul><p>There could also be other causes for the same error message that are unrelated
to that change.</p><h2 id="optional-kubectl-configurations-and-plugins">Optional kubectl configurations and plugins</h2><h3 id="enable-shell-autocompletion">Enable shell autocompletion</h3><p>kubectl provides autocompletion support for Bash, Zsh, Fish, and PowerShell,
which can save you a lot of typing.</p><p>Below are the procedures to set up autocompletion for PowerShell.</p><p>The kubectl completion script for PowerShell can be generated with the command <code>kubectl completion powershell</code>.</p><p>To do so in all your shell sessions, add the following line to your <code>$PROFILE</code> file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span>kubectl completion powershell | <span style="color:#a2f">Out-String</span> | <span style="color:#a2f">Invoke-Expression</span>
</span></span></code></pre></div><p>This command will regenerate the auto-completion script on every PowerShell start up. You can also add the generated script directly to your <code>$PROFILE</code> file.</p><p>To add the generated script to your <code>$PROFILE</code> file, run the following line in your powershell prompt:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span>kubectl completion powershell &gt;&gt; <span style="color:#b8860b">$PROFILE</span>
</span></span></code></pre></div><p>After reloading your shell, kubectl autocompletion should be working.</p><h3 id="configure-kuberc">Configure kuberc</h3><p>See <a href="/docs/reference/kubectl/kuberc/">kuberc</a> for more information.</p><h3 id="install-kubectl-convert-plugin">Install <code>kubectl convert</code> plugin</h3><p>A plugin for Kubernetes command-line tool <code>kubectl</code>, which allows you to convert manifests between different API
versions. This can be particularly helpful to migrate manifests to a non-deprecated api version with newer Kubernetes release.
For more info, visit <a href="/docs/reference/using-api/deprecation-guide/#migrate-to-non-deprecated-apis">migrate to non deprecated apis</a></p><ol><li><p>Download the latest release with the command:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span>curl.exe -LO <span style="color:#b44">"https://dl.k8s.io/release/v1.34.0/bin/windows/amd64/kubectl-convert.exe"</span>
</span></span></code></pre></div></li><li><p>Validate the binary (optional).</p><p>Download the <code>kubectl-convert</code> checksum file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span>curl.exe -LO <span style="color:#b44">"https://dl.k8s.io/v1.34.0/bin/windows/amd64/kubectl-convert.exe.sha256"</span>
</span></span></code></pre></div><p>Validate the <code>kubectl-convert</code> binary against the checksum file:</p><ul><li><p>Using Command Prompt to manually compare <code>CertUtil</code>'s output to the checksum file downloaded:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cmd" data-lang="cmd"><span style="display:flex"><span>CertUtil -hashfile kubectl-convert.exe SHA256
</span></span><span style="display:flex"><span><span style="color:#a2f;font-weight:700">type</span> kubectl-convert.exe.sha256
</span></span></code></pre></div></li><li><p>Using PowerShell to automate the verification using the <code>-eq</code> operator to get
a <code>True</code> or <code>False</code> result:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span>$($(CertUtil -hashfile .\<span style="color:#a2f">kubectl-convert</span>.exe SHA256)[<span style="color:#666">1</span>] <span style="color:#666">-replace</span> <span style="color:#b44">" "</span>, <span style="color:#b44">""</span>) <span style="color:#666">-eq</span> $(<span style="color:#a2f">type </span>.\<span style="color:#a2f">kubectl-convert</span>.exe.sha256)
</span></span></code></pre></div></li></ul></li><li><p>Append or prepend the <code>kubectl-convert</code> binary folder to your <code>PATH</code> environment variable.</p></li><li><p>Verify the plugin is successfully installed.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl convert --help
</span></span></code></pre></div><p>If you do not see an error, it means the plugin is successfully installed.</p></li><li><p>After installing the plugin, clean up the installation files:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span><span style="color:#a2f">del kubectl-convert</span>.exe
</span></span><span style="display:flex"><span><span style="color:#a2f">del kubectl-convert</span>.exe.sha256
</span></span></code></pre></div></li></ol><h2 id="what-s-next">What's next</h2><ul><li><a href="https://minikube.sigs.k8s.io/docs/start/">Install Minikube</a></li><li>See the <a href="/docs/setup/">getting started guides</a> for more about creating clusters.</li><li><a href="/docs/tasks/access-application-cluster/service-access-application-cluster/">Learn how to launch and expose your application.</a></li><li>If you need access to a cluster you didn't create, see the
<a href="/docs/tasks/access-application-cluster/configure-access-multiple-clusters/">Sharing Cluster Access document</a>.</li><li>Read the <a href="/docs/reference/kubectl/kubectl/">kubectl reference docs</a></li></ul></div>
<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Configure Certificate Rotation for the Kubelet</h1><p>This page shows how to enable and configure certificate rotation for the kubelet.</p><div class="feature-state-notice feature-stable"><span class="feature-state-name">FEATURE STATE:</span>
<code>Kubernetes v1.19 [stable]</code></div><h2 id="before-you-begin">Before you begin</h2><ul><li>Kubernetes version 1.8.0 or later is required</li></ul><h2 id="overview">Overview</h2><p>The kubelet uses certificates for authenticating to the Kubernetes API. By
default, these certificates are issued with one year expiration so that they do
not need to be renewed too frequently.</p><p>Kubernetes contains <a href="/docs/reference/access-authn-authz/kubelet-tls-bootstrapping/">kubelet certificate
rotation</a>,
that will automatically generate a new key and request a new certificate from
the Kubernetes API as the current certificate approaches expiration. Once the
new certificate is available, it will be used for authenticating connections to
the Kubernetes API.</p><h2 id="enabling-client-certificate-rotation">Enabling client certificate rotation</h2><p>The <code>kubelet</code> process accepts an argument <code>--rotate-certificates</code> that controls
if the kubelet will automatically request a new certificate as the expiration of
the certificate currently in use approaches.</p><p>The <code>kube-controller-manager</code> process accepts an argument
<code>--cluster-signing-duration</code> (<code>--experimental-cluster-signing-duration</code> prior to 1.19)
that controls how long certificates will be issued for.</p><h2 id="understanding-the-certificate-rotation-configuration">Understanding the certificate rotation configuration</h2><p>When a kubelet starts up, if it is configured to bootstrap (using the
<code>--bootstrap-kubeconfig</code> flag), it will use its initial certificate to connect
to the Kubernetes API and issue a certificate signing request. You can view the
status of certificate signing requests using:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="display:flex"><span>kubectl get csr
</span></span></code></pre></div><p>Initially a certificate signing request from the kubelet on a node will have a
status of <code>Pending</code>. If the certificate signing requests meets specific
criteria, it will be auto approved by the controller manager, then it will have
a status of <code>Approved</code>. Next, the controller manager will sign a certificate,
issued for the duration specified by the
<code>--cluster-signing-duration</code> parameter, and the signed certificate
will be attached to the certificate signing request.</p><p>The kubelet will retrieve the signed certificate from the Kubernetes API and
write that to disk, in the location specified by <code>--cert-dir</code>. Then the kubelet
will use the new certificate to connect to the Kubernetes API.</p><p>As the expiration of the signed certificate approaches, the kubelet will
automatically issue a new certificate signing request, using the Kubernetes API.
This can happen at any point between 30% and 10% of the time remaining on the
certificate. Again, the controller manager will automatically approve the certificate
request and attach a signed certificate to the certificate signing request. The
kubelet will retrieve the new signed certificate from the Kubernetes API and
write that to disk. Then it will update the connections it has to the
Kubernetes API to reconnect using the new certificate.</p></div>
<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Install and Set Up kubectl on Linux</h1><h2 id="before-you-begin">Before you begin</h2><p>You must use a kubectl version that is within one minor version difference of
your cluster. For example, a v1.34 client can communicate
with v1.33, v1.34,
and v1.35 control planes.
Using the latest compatible version of kubectl helps avoid unforeseen issues.</p><h2 id="install-kubectl-on-linux">Install kubectl on Linux</h2><p>The following methods exist for installing kubectl on Linux:</p><ul><li><a href="#install-kubectl-binary-with-curl-on-linux">Install kubectl binary with curl on Linux</a></li><li><a href="#install-using-native-package-management">Install using native package management</a></li><li><a href="#install-using-other-package-management">Install using other package management</a></li></ul><h3 id="install-kubectl-binary-with-curl-on-linux">Install kubectl binary with curl on Linux</h3><ol><li><p>Download the latest release with the command:</p><ul class="nav nav-tabs" id="download-binary-linux" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#download-binary-linux-0" role="tab" aria-controls="download-binary-linux-0" aria-selected="true">x86-64</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#download-binary-linux-1" role="tab" aria-controls="download-binary-linux-1">ARM64</a></li></ul><div class="tab-content" id="download-binary-linux"><div id="download-binary-linux-0" class="tab-pane show active" role="tabpanel" aria-labelledby="download-binary-linux-0"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/linux/amd64/kubectl"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div><div id="download-binary-linux-1" class="tab-pane" role="tabpanel" aria-labelledby="download-binary-linux-1"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/linux/arm64/kubectl"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4><p>To download a specific version, replace the <code>$(curl -L -s https://dl.k8s.io/release/stable.txt)</code>
portion of the command with the specific version.</p><p>For example, to download version 1.34.0 on Linux x86-64, type:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>curl -LO https://dl.k8s.io/release/v1.34.0/bin/linux/amd64/kubectl
</span></span></code></pre></div><p>And for Linux ARM64, type:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>curl -LO https://dl.k8s.io/release/v1.34.0/bin/linux/arm64/kubectl
</span></span></code></pre></div></div></li><li><p>Validate the binary (optional)</p><p>Download the kubectl checksum file:</p><ul class="nav nav-tabs" id="download-checksum-linux" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#download-checksum-linux-0" role="tab" aria-controls="download-checksum-linux-0" aria-selected="true">x86-64</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#download-checksum-linux-1" role="tab" aria-controls="download-checksum-linux-1">ARM64</a></li></ul><div class="tab-content" id="download-checksum-linux"><div id="download-checksum-linux-0" class="tab-pane show active" role="tabpanel" aria-labelledby="download-checksum-linux-0"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/linux/amd64/kubectl.sha256"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div><div id="download-checksum-linux-1" class="tab-pane" role="tabpanel" aria-labelledby="download-checksum-linux-1"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/linux/arm64/kubectl.sha256"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div></div><p>Validate the kubectl binary against the checksum file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b44">"</span><span style="color:#a2f;font-weight:700">$(</span>cat kubectl.sha256<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">  kubectl"</span> | sha256sum --check
</span></span></code></pre></div><p>If valid, the output is:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console"><span style="display:flex"><span><span style="color:#888">kubectl: OK
</span></span></span></code></pre></div><p>If the check fails, <code>sha256</code> exits with nonzero status and prints output similar to:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console"><span style="display:flex"><span><span style="color:#888">kubectl: FAILED
</span></span></span><span style="display:flex"><span><span style="color:#888">sha256sum: WARNING: 1 computed checksum did NOT match
</span></span></span></code></pre></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>Download the same version of the binary and checksum.</div></li><li><p>Install kubectl</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo install -o root -g root -m <span style="color:#666">0755</span> kubectl /usr/local/bin/kubectl
</span></span></code></pre></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4><p>If you do not have root access on the target system, you can still install
kubectl to the <code>~/.local/bin</code> directory:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>chmod +x kubectl
</span></span><span style="display:flex"><span>mkdir -p ~/.local/bin
</span></span><span style="display:flex"><span>mv ./kubectl ~/.local/bin/kubectl
</span></span><span style="display:flex"><span><span style="color:#080;font-style:italic"># and then append (or prepend) ~/.local/bin to $PATH</span>
</span></span></code></pre></div></div></li><li><p>Test to ensure the version you installed is up-to-date:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>kubectl version --client
</span></span></code></pre></div><p>Or use this for detailed view of version:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cmd" data-lang="cmd"><span style="display:flex"><span>kubectl version --client --output=yaml
</span></span></code></pre></div></li></ol><h3 id="install-using-native-package-management">Install using native package management</h3><ul class="nav nav-tabs" id="kubectl-install" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#kubectl-install-0" role="tab" aria-controls="kubectl-install-0" aria-selected="true">Debian-based distributions</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#kubectl-install-1" role="tab" aria-controls="kubectl-install-1">Red Hat-based distributions</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#kubectl-install-2" role="tab" aria-controls="kubectl-install-2">SUSE-based distributions</a></li></ul><div class="tab-content" id="kubectl-install"><div id="kubectl-install-0" class="tab-pane show active" role="tabpanel" aria-labelledby="kubectl-install-0"><p><ol><li><p>Update the <code>apt</code> package index and install packages needed to use the Kubernetes <code>apt</code> repository:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>sudo apt-get update
</span></span><span style="display:flex"><span><span style="color:#080;font-style:italic"># apt-transport-https may be a dummy package; if so, you can skip that package</span>
</span></span><span style="display:flex"><span>sudo apt-get install -y apt-transport-https ca-certificates curl gnupg
</span></span></code></pre></div></li><li><p>Download the public signing key for the Kubernetes package repositories. The same signing key is used for all repositories so you can disregard the version in the URL:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># If the folder `/etc/apt/keyrings` does not exist, it should be created before the curl command, read the note below.</span>
</span></span><span style="display:flex"><span><span style="color:#080;font-style:italic"># sudo mkdir -p -m 755 /etc/apt/keyrings</span>
</span></span><span style="display:flex"><span>curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.34/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg
</span></span><span style="display:flex"><span>sudo chmod <span style="color:#666">644</span> /etc/apt/keyrings/kubernetes-apt-keyring.gpg <span style="color:#080;font-style:italic"># allow unprivileged APT programs to read this keyring</span>
</span></span></code></pre></div></li></ol><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>In releases older than Debian 12 and Ubuntu 22.04, folder <code>/etc/apt/keyrings</code> does not exist by default, and it should be created before the curl command.</div><ol start="3"><li><p>Add the appropriate Kubernetes <code>apt</code> repository. If you want to use Kubernetes version different than v1.34,
replace v1.34 with the desired minor version in the command below:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># This overwrites any existing configuration in /etc/apt/sources.list.d/kubernetes.list</span>
</span></span><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b44">'deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.34/deb/ /'</span> | sudo tee /etc/apt/sources.list.d/kubernetes.list
</span></span><span style="display:flex"><span>sudo chmod <span style="color:#666">644</span> /etc/apt/sources.list.d/kubernetes.list   <span style="color:#080;font-style:italic"># helps tools such as command-not-found to work correctly</span>
</span></span></code></pre></div></li></ol><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>To upgrade kubectl to another minor release, you'll need to bump the version in <code>/etc/apt/sources.list.d/kubernetes.list</code> before running <code>apt-get update</code> and <code>apt-get upgrade</code>. This procedure is described in more detail in <a href="/docs/tasks/administer-cluster/kubeadm/change-package-repository/">Changing The Kubernetes Package Repository</a>.</div><ol start="4"><li><p>Update <code>apt</code> package index, then install kubectl:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>sudo apt-get update
</span></span><span style="display:flex"><span>sudo apt-get install -y kubectl
</span></span></code></pre></div></li></ol></p></div><div id="kubectl-install-1" class="tab-pane" role="tabpanel" aria-labelledby="kubectl-install-1"><p><ol><li><p>Add the Kubernetes <code>yum</code> repository. If you want to use Kubernetes version
different than v1.34, replace v1.34 with
the desired minor version in the command below.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#080;font-style:italic"># This overwrites any existing configuration in /etc/yum.repos.d/kubernetes.repo</span>
</span></span><span style="display:flex"><span>cat <span style="color:#b44">&lt;&lt;EOF | sudo tee /etc/yum.repos.d/kubernetes.repo
</span></span></span><span style="display:flex"><span><span style="color:#b44">[kubernetes]
</span></span></span><span style="display:flex"><span><span style="color:#b44">name=Kubernetes
</span></span></span><span style="display:flex"><span><span style="color:#b44">baseurl=https://pkgs.k8s.io/core:/stable:/v1.34/rpm/
</span></span></span><span style="display:flex"><span><span style="color:#b44">enabled=1
</span></span></span><span style="display:flex"><span><span style="color:#b44">gpgcheck=1
</span></span></span><span style="display:flex"><span><span style="color:#b44">gpgkey=https://pkgs.k8s.io/core:/stable:/v1.34/rpm/repodata/repomd.xml.key
</span></span></span><span style="display:flex"><span><span style="color:#b44">EOF</span>
</span></span></code></pre></div></li></ol><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>To upgrade kubectl to another minor release, you'll need to bump the version in <code>/etc/yum.repos.d/kubernetes.repo</code> before running <code>yum update</code>. This procedure is described in more detail in <a href="/docs/tasks/administer-cluster/kubeadm/change-package-repository/">Changing The Kubernetes Package Repository</a>.</div><ol start="2"><li><p>Install kubectl using <code>yum</code>:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo yum install -y kubectl
</span></span></code></pre></div></li></ol></p></div><div id="kubectl-install-2" class="tab-pane" role="tabpanel" aria-labelledby="kubectl-install-2"><p><ol><li><p>Add the Kubernetes <code>zypper</code> repository. If you want to use Kubernetes version
different than v1.34, replace v1.34 with
the desired minor version in the command below.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#080;font-style:italic"># This overwrites any existing configuration in /etc/zypp/repos.d/kubernetes.repo</span>
</span></span><span style="display:flex"><span>cat <span style="color:#b44">&lt;&lt;EOF | sudo tee /etc/zypp/repos.d/kubernetes.repo
</span></span></span><span style="display:flex"><span><span style="color:#b44">[kubernetes]
</span></span></span><span style="display:flex"><span><span style="color:#b44">name=Kubernetes
</span></span></span><span style="display:flex"><span><span style="color:#b44">baseurl=https://pkgs.k8s.io/core:/stable:/v1.34/rpm/
</span></span></span><span style="display:flex"><span><span style="color:#b44">enabled=1
</span></span></span><span style="display:flex"><span><span style="color:#b44">gpgcheck=1
</span></span></span><span style="display:flex"><span><span style="color:#b44">gpgkey=https://pkgs.k8s.io/core:/stable:/v1.34/rpm/repodata/repomd.xml.key
</span></span></span><span style="display:flex"><span><span style="color:#b44">EOF</span>
</span></span></code></pre></div></li></ol><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>To upgrade kubectl to another minor release, you'll need to bump the version in <code>/etc/zypp/repos.d/kubernetes.repo</code>
before running <code>zypper update</code>. This procedure is described in more detail in
<a href="/docs/tasks/administer-cluster/kubeadm/change-package-repository/">Changing The Kubernetes Package Repository</a>.</div><ol start="2"><li><p>Update <code>zypper</code> and confirm the new repo addition:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo zypper update
</span></span></code></pre></div><p>When this message appears, press 't' or 'a':</p><pre tabindex="0"><code>New repository or package signing key received:

Repository:       Kubernetes
Key Fingerprint:  1111 2222 3333 4444 5555 6666 7777 8888 9999 AAAA
Key Name:         isv:kubernetes OBS Project &lt;isv:kubernetes@build.opensuse.org&gt;
Key Algorithm:    RSA 2048
Key Created:      Thu 25 Aug 2022 01:21:11 PM -03
Key Expires:      Sat 02 Nov 2024 01:21:11 PM -03 (expires in 85 days)
Rpm Name:         gpg-pubkey-9a296436-6307a177

Note: Signing data enables the recipient to verify that no modifications occurred after the data
were signed. Accepting data with no, wrong or unknown signature can lead to a corrupted system
and in extreme cases even to a system compromise.

Note: A GPG pubkey is clearly identified by its fingerprint. Do not rely on the key's name. If
you are not sure whether the presented key is authentic, ask the repository provider or check
their web site. Many providers maintain a web page showing the fingerprints of the GPG keys they
are using.

Do you want to reject the key, trust temporarily, or trust always? [r/t/a/?] (r): a
</code></pre></li><li><p>Install kubectl using <code>zypper</code>:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo zypper install -y kubectl
</span></span></code></pre></div></li></ol></p></div></div><h3 id="install-using-other-package-management">Install using other package management</h3><ul class="nav nav-tabs" id="other-kubectl-install" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#other-kubectl-install-0" role="tab" aria-controls="other-kubectl-install-0" aria-selected="true">Snap</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#other-kubectl-install-1" role="tab" aria-controls="other-kubectl-install-1">Homebrew</a></li></ul><div class="tab-content" id="other-kubectl-install"><div id="other-kubectl-install-0" class="tab-pane show active" role="tabpanel" aria-labelledby="other-kubectl-install-0"><p><p>If you are on Ubuntu or another Linux distribution that supports the
<a href="https://snapcraft.io/docs/core/install">snap</a> package manager, kubectl
is available as a <a href="https://snapcraft.io/">snap</a> application.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>snap install kubectl --classic
</span></span><span style="display:flex"><span>kubectl version --client
</span></span></code></pre></div></p></div><div id="other-kubectl-install-1" class="tab-pane" role="tabpanel" aria-labelledby="other-kubectl-install-1"><p><p>If you are on Linux and using <a href="https://docs.brew.sh/Homebrew-on-Linux">Homebrew</a>
package manager, kubectl is available for <a href="https://docs.brew.sh/Homebrew-on-Linux#install">installation</a>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>brew install kubectl
</span></span><span style="display:flex"><span>kubectl version --client
</span></span></code></pre></div></p></div></div><h2 id="verify-kubectl-configuration">Verify kubectl configuration</h2><p>In order for kubectl to find and access a Kubernetes cluster, it needs a
<a href="/docs/concepts/configuration/organize-cluster-access-kubeconfig/">kubeconfig file</a>,
which is created automatically when you create a cluster using
<a href="https://github.com/kubernetes/kubernetes/blob/master/cluster/kube-up.sh">kube-up.sh</a>
or successfully deploy a Minikube cluster.
By default, kubectl configuration is located at <code>~/.kube/config</code>.</p><p>Check that kubectl is properly configured by getting the cluster state:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl cluster-info
</span></span></code></pre></div><p>If you see a URL response, kubectl is correctly configured to access your cluster.</p><p>If you see a message similar to the following, kubectl is not configured correctly
or is not able to connect to a Kubernetes cluster.</p><pre tabindex="0"><code>The connection to the server &lt;server-name:port&gt; was refused - did you specify the right host or port?
</code></pre><p>For example, if you are intending to run a Kubernetes cluster on your laptop (locally),
you will need a tool like <a href="https://minikube.sigs.k8s.io/docs/start/">Minikube</a> to be
installed first and then re-run the commands stated above.</p><p>If <code>kubectl cluster-info</code> returns the url response, but you can't access your cluster,
check whether it is configured properly using the following command:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl cluster-info dump
</span></span></code></pre></div><h3 id="no-auth-provider-found">Troubleshooting the 'No Auth Provider Found' error message</h3><p>In Kubernetes 1.26, kubectl removed the built-in authentication for the following cloud
providers' managed Kubernetes offerings. These providers have released kubectl plugins
to provide the cloud-specific authentication. For instructions, refer to the following provider documentation:</p><ul><li>Azure AKS: <a href="https://azure.github.io/kubelogin/">kubelogin plugin</a></li><li>Google Kubernetes Engine: <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl#install_plugin">gke-gcloud-auth-plugin</a></li></ul><p>There could also be other causes for the same error message that are unrelated
to that change.</p><h2 id="optional-kubectl-configurations-and-plugins">Optional kubectl configurations and plugins</h2><h3 id="enable-shell-autocompletion">Enable shell autocompletion</h3><p>kubectl provides autocompletion support for Bash, Zsh, Fish, and PowerShell,
which can save you a lot of typing.</p><p>Below are the procedures to set up autocompletion for Bash, Fish, and Zsh.</p><ul class="nav nav-tabs" id="kubectl-autocompletion" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#kubectl-autocompletion-0" role="tab" aria-controls="kubectl-autocompletion-0" aria-selected="true">Bash</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#kubectl-autocompletion-1" role="tab" aria-controls="kubectl-autocompletion-1">Fish</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#kubectl-autocompletion-2" role="tab" aria-controls="kubectl-autocompletion-2">Zsh</a></li></ul><div class="tab-content" id="kubectl-autocompletion"><div id="kubectl-autocompletion-0" class="tab-pane show active" role="tabpanel" aria-labelledby="kubectl-autocompletion-0"><p><h3 id="introduction">Introduction</h3><p>The kubectl completion script for Bash can be generated with the command <code>kubectl completion bash</code>.
Sourcing the completion script in your shell enables kubectl autocompletion.</p><p>However, the completion script depends on
<a href="https://github.com/scop/bash-completion"><strong>bash-completion</strong></a>,
which means that you have to install this software first
(you can test if you have bash-completion already installed by running <code>type _init_completion</code>).</p><h3 id="install-bash-completion">Install bash-completion</h3><p>bash-completion is provided by many package managers
(see <a href="https://github.com/scop/bash-completion#installation">here</a>).
You can install it with <code>apt-get install bash-completion</code> or <code>yum install bash-completion</code>, etc.</p><p>The above commands create <code>/usr/share/bash-completion/bash_completion</code>,
which is the main script of bash-completion. Depending on your package manager,
you have to manually source this file in your <code>~/.bashrc</code> file.</p><p>To find out, reload your shell and run <code>type _init_completion</code>.
If the command succeeds, you're already set, otherwise add the following to your <code>~/.bashrc</code> file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#a2f">source</span> /usr/share/bash-completion/bash_completion
</span></span></code></pre></div><p>Reload your shell and verify that bash-completion is correctly installed by typing <code>type _init_completion</code>.</p><h3 id="enable-kubectl-autocompletion">Enable kubectl autocompletion</h3><h4 id="bash">Bash</h4><p>You now need to ensure that the kubectl completion script gets sourced in all
your shell sessions. There are two ways in which you can do this:</p><ul class="nav nav-tabs" id="kubectl-bash-autocompletion" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#kubectl-bash-autocompletion-0" role="tab" aria-controls="kubectl-bash-autocompletion-0" aria-selected="true">User</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#kubectl-bash-autocompletion-1" role="tab" aria-controls="kubectl-bash-autocompletion-1">System</a></li></ul><div class="tab-content" id="kubectl-bash-autocompletion"><div id="kubectl-bash-autocompletion-0" class="tab-pane show active" role="tabpanel" aria-labelledby="kubectl-bash-autocompletion-0"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b44">'source &lt;(kubectl completion bash)'</span> &gt;&gt;~/.bashrc
</span></span></code></pre></div></p></div><div id="kubectl-bash-autocompletion-1" class="tab-pane" role="tabpanel" aria-labelledby="kubectl-bash-autocompletion-1"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>kubectl completion bash | sudo tee /etc/bash_completion.d/kubectl &gt; /dev/null
</span></span><span style="display:flex"><span>sudo chmod a+r /etc/bash_completion.d/kubectl
</span></span></code></pre></div></p></div></div><p>If you have an alias for kubectl, you can extend shell completion to work with that alias:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b44">'alias k=kubectl'</span> &gt;&gt;~/.bashrc
</span></span><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b44">'complete -o default -F __start_kubectl k'</span> &gt;&gt;~/.bashrc
</span></span></code></pre></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>bash-completion sources all completion scripts in <code>/etc/bash_completion.d</code>.</div><p>Both approaches are equivalent. After reloading your shell, kubectl autocompletion should be working.
To enable bash autocompletion in current session of shell, source the ~/.bashrc file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#a2f">source</span> ~/.bashrc
</span></span></code></pre></div></p></div><div id="kubectl-autocompletion-1" class="tab-pane" role="tabpanel" aria-labelledby="kubectl-autocompletion-1"><p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>Autocomplete for Fish requires kubectl 1.23 or later.</div><p>The kubectl completion script for Fish can be generated with the command <code>kubectl completion fish</code>. Sourcing the completion script in your shell enables kubectl autocompletion.</p><p>To do so in all your shell sessions, add the following line to your <code>~/.config/fish/config.fish</code> file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl completion fish | <span style="color:#a2f">source</span>
</span></span></code></pre></div><p>After reloading your shell, kubectl autocompletion should be working.</p></p></div><div id="kubectl-autocompletion-2" class="tab-pane" role="tabpanel" aria-labelledby="kubectl-autocompletion-2"><p><p>The kubectl completion script for Zsh can be generated with the command <code>kubectl completion zsh</code>. Sourcing the completion script in your shell enables kubectl autocompletion.</p><p>To do so in all your shell sessions, add the following to your <code>~/.zshrc</code> file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-zsh" data-lang="zsh"><span style="display:flex"><span><span style="color:#a2f">source</span> &lt;<span style="color:#666">(</span>kubectl completion zsh<span style="color:#666">)</span>
</span></span></code></pre></div><p>If you have an alias for kubectl, kubectl autocompletion will automatically work with it.</p><p>After reloading your shell, kubectl autocompletion should be working.</p><p>If you get an error like <code>2: command not found: compdef</code>, then add the following to the beginning of your <code>~/.zshrc</code> file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-zsh" data-lang="zsh"><span style="display:flex"><span>autoload -Uz compinit
</span></span><span style="display:flex"><span>compinit
</span></span></code></pre></div></p></div></div><h3 id="configure-kuberc">Configure kuberc</h3><p>See <a href="/docs/reference/kubectl/kuberc/">kuberc</a> for more information.</p><h3 id="install-kubectl-convert-plugin">Install <code>kubectl convert</code> plugin</h3><p>A plugin for Kubernetes command-line tool <code>kubectl</code>, which allows you to convert manifests between different API
versions. This can be particularly helpful to migrate manifests to a non-deprecated api version with newer Kubernetes release.
For more info, visit <a href="/docs/reference/using-api/deprecation-guide/#migrate-to-non-deprecated-apis">migrate to non deprecated apis</a></p><ol><li><p>Download the latest release with the command:</p><ul class="nav nav-tabs" id="download-convert-binary-linux" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#download-convert-binary-linux-0" role="tab" aria-controls="download-convert-binary-linux-0" aria-selected="true">x86-64</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#download-convert-binary-linux-1" role="tab" aria-controls="download-convert-binary-linux-1">ARM64</a></li></ul><div class="tab-content" id="download-convert-binary-linux"><div id="download-convert-binary-linux-0" class="tab-pane show active" role="tabpanel" aria-labelledby="download-convert-binary-linux-0"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/linux/amd64/kubectl-convert"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div><div id="download-convert-binary-linux-1" class="tab-pane" role="tabpanel" aria-labelledby="download-convert-binary-linux-1"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/linux/arm64/kubectl-convert"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div></div></li><li><p>Validate the binary (optional)</p><p>Download the kubectl-convert checksum file:</p><ul class="nav nav-tabs" id="download-convert-checksum-linux" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#download-convert-checksum-linux-0" role="tab" aria-controls="download-convert-checksum-linux-0" aria-selected="true">x86-64</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#download-convert-checksum-linux-1" role="tab" aria-controls="download-convert-checksum-linux-1">ARM64</a></li></ul><div class="tab-content" id="download-convert-checksum-linux"><div id="download-convert-checksum-linux-0" class="tab-pane show active" role="tabpanel" aria-labelledby="download-convert-checksum-linux-0"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/linux/amd64/kubectl-convert.sha256"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div><div id="download-convert-checksum-linux-1" class="tab-pane" role="tabpanel" aria-labelledby="download-convert-checksum-linux-1"><p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>
</span></span><span style="display:flex"><span>   curl -LO <span style="color:#b44">"https://dl.k8s.io/release/</span><span style="color:#a2f;font-weight:700">$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">/bin/linux/arm64/kubectl-convert.sha256"</span>
</span></span><span style="display:flex"><span>   </span></span></code></pre></div></p></div></div><p>Validate the kubectl-convert binary against the checksum file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b44">"</span><span style="color:#a2f;font-weight:700">$(</span>cat kubectl-convert.sha256<span style="color:#a2f;font-weight:700">)</span><span style="color:#b44"> kubectl-convert"</span> | sha256sum --check
</span></span></code></pre></div><p>If valid, the output is:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console"><span style="display:flex"><span><span style="color:#888">kubectl-convert: OK
</span></span></span></code></pre></div><p>If the check fails, <code>sha256</code> exits with nonzero status and prints output similar to:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console"><span style="display:flex"><span><span style="color:#888">kubectl-convert: FAILED
</span></span></span><span style="display:flex"><span><span style="color:#888">sha256sum: WARNING: 1 computed checksum did NOT match
</span></span></span></code></pre></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>Download the same version of the binary and checksum.</div></li><li><p>Install kubectl-convert</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo install -o root -g root -m <span style="color:#666">0755</span> kubectl-convert /usr/local/bin/kubectl-convert
</span></span></code></pre></div></li><li><p>Verify plugin is successfully installed</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl convert --help
</span></span></code></pre></div><p>If you do not see an error, it means the plugin is successfully installed.</p></li><li><p>After installing the plugin, clean up the installation files:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>rm kubectl-convert kubectl-convert.sha256
</span></span></code></pre></div></li></ol><h2 id="what-s-next">What's next</h2><ul><li><a href="https://minikube.sigs.k8s.io/docs/start/">Install Minikube</a></li><li>See the <a href="/docs/setup/">getting started guides</a> for more about creating clusters.</li><li><a href="/docs/tasks/access-application-cluster/service-access-application-cluster/">Learn how to launch and expose your application.</a></li><li>If you need access to a cluster you didn't create, see the
<a href="/docs/tasks/access-application-cluster/configure-access-multiple-clusters/">Sharing Cluster Access document</a>.</li><li>Read the <a href="/docs/reference/kubectl/kubectl/">kubectl reference docs</a></li></ul></div>
<hr>
<div class="td-content"><h1>TLS</h1><div class="lead">Understand how to protect traffic within your cluster using Transport Layer Security (TLS).</div><div class="section-index"><hr class="panel-line"/><div class="entry"><h5><a href="/docs/tasks/tls/certificate-issue-client-csr/">Issue a Certificate for a Kubernetes API Client Using A CertificateSigningRequest</a></h5><p/></div><div class="entry"><h5><a href="/docs/tasks/tls/certificate-rotation/">Configure Certificate Rotation for the Kubelet</a></h5><p/></div><div class="entry"><h5><a href="/docs/tasks/tls/managing-tls-in-a-cluster/">Manage TLS Certificates in a Cluster</a></h5><p/></div><div class="entry"><h5><a href="/docs/tasks/tls/manual-rotation-of-ca-certificates/">Manual Rotation of CA Certificates</a></h5><p/></div></div></div>
<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Manage TLS Certificates in a Cluster</h1><p>Kubernetes provides a <code>certificates.k8s.io</code> API, which lets you provision TLS
certificates signed by a Certificate Authority (CA) that you control. These CA
and certificates can be used by your workloads to establish trust.</p><p><code>certificates.k8s.io</code> API uses a protocol that is similar to the <a href="https://github.com/ietf-wg-acme/acme/">ACME
draft</a>.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>Certificates created using the <code>certificates.k8s.io</code> API are signed by a
<a href="#configuring-your-cluster-to-provide-signing">dedicated CA</a>. It is possible to configure your cluster to use the cluster root
CA for this purpose, but you should never rely on this. Do not assume that
these certificates will validate against the cluster root CA.</div><h2 id="before-you-begin">Before you begin</h2><p>You need to have a Kubernetes cluster, and the kubectl command-line tool must
be configured to communicate with your cluster. It is recommended to run this tutorial on a cluster with at least two nodes that are not acting as control plane hosts. If you do not already have a
cluster, you can create one by using
<a href="https://minikube.sigs.k8s.io/docs/tutorials/multi_node/">minikube</a>
or you can use one of these Kubernetes playgrounds:</p><ul><li><a href="https://labs.iximiuz.com/playgrounds?category=kubernetes&amp;filter=all">iximiuz Labs</a></li><li><a href="https://killercoda.com/playgrounds/scenario/kubernetes">Killercoda</a></li><li><a href="https://kodekloud.com/public-playgrounds">KodeKloud</a></li><li><a href="https://labs.play-with-k8s.com/">Play with Kubernetes</a></li></ul><p>You need the <code>cfssl</code> tool. You can download <code>cfssl</code> from
<a href="https://github.com/cloudflare/cfssl/releases">https://github.com/cloudflare/cfssl/releases</a>.</p><p>Some steps in this page use the <code>jq</code> tool. If you don't have <code>jq</code>, you can
install it via your operating system's software sources, or fetch it from
<a href="https://jqlang.github.io/jq/">https://jqlang.github.io/jq/</a>.</p><h2 id="trusting-tls-in-a-cluster">Trusting TLS in a cluster</h2><p>Trusting the <a href="#configuring-your-cluster-to-provide-signing">custom CA</a> from an application running as a pod usually requires
some extra application configuration. You will need to add the CA certificate
bundle to the list of CA certificates that the TLS client or server trusts. For
example, you would do this with a golang TLS config by parsing the certificate
chain and adding the parsed certificates to the <code>RootCAs</code> field in the
<a href="https://pkg.go.dev/crypto/tls#Config"><code>tls.Config</code></a> struct.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4><p>Even though the custom CA certificate may be included in the filesystem (in the
ConfigMap <code>kube-root-ca.crt</code>),
you should not use that certificate authority for any purpose other than to verify internal
Kubernetes endpoints. An example of an internal Kubernetes endpoint is the
Service named <code>kubernetes</code> in the default namespace.</p><p>If you want to use a custom certificate authority for your workloads, you should generate
that CA separately, and distribute its CA certificate using a
<a href="/docs/tasks/configure-pod-container/configure-pod-configmap/">ConfigMap</a> that your pods
have access to read.</p></div><h2 id="requesting-a-certificate">Requesting a certificate</h2><p>The following section demonstrates how to create a TLS certificate for a
Kubernetes service accessed through DNS.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>This tutorial uses CFSSL: Cloudflare's PKI and TLS toolkit <a href="https://blog.cloudflare.com/introducing-cfssl/">click here</a> to know more.</div><h2 id="create-a-certificate-signing-request">Create a certificate signing request</h2><p>Generate a private key and certificate signing request (or CSR) by running
the following command:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>cat <span style="color:#b44">&lt;&lt;EOF | cfssl genkey - | cfssljson -bare server
</span></span></span><span style="display:flex"><span><span style="color:#b44">{
</span></span></span><span style="display:flex"><span><span style="color:#b44">  "hosts": [
</span></span></span><span style="display:flex"><span><span style="color:#b44">    "my-svc.my-namespace.svc.cluster.local",
</span></span></span><span style="display:flex"><span><span style="color:#b44">    "my-pod.my-namespace.pod.cluster.local",
</span></span></span><span style="display:flex"><span><span style="color:#b44">    "192.0.2.24",
</span></span></span><span style="display:flex"><span><span style="color:#b44">    "10.0.34.2"
</span></span></span><span style="display:flex"><span><span style="color:#b44">  ],
</span></span></span><span style="display:flex"><span><span style="color:#b44">  "CN": "my-pod.my-namespace.pod.cluster.local",
</span></span></span><span style="display:flex"><span><span style="color:#b44">  "key": {
</span></span></span><span style="display:flex"><span><span style="color:#b44">    "algo": "ecdsa",
</span></span></span><span style="display:flex"><span><span style="color:#b44">    "size": 256
</span></span></span><span style="display:flex"><span><span style="color:#b44">  }
</span></span></span><span style="display:flex"><span><span style="color:#b44">}
</span></span></span><span style="display:flex"><span><span style="color:#b44">EOF</span>
</span></span></code></pre></div><p>Where <code>192.0.2.24</code> is the service's cluster IP,
<code>my-svc.my-namespace.svc.cluster.local</code> is the service's DNS name,
<code>10.0.34.2</code> is the pod's IP and <code>my-pod.my-namespace.pod.cluster.local</code>
is the pod's DNS name. You should see the output similar to:</p><pre tabindex="0"><code>2022/02/01 11:45:32 [INFO] generate received request
2022/02/01 11:45:32 [INFO] received CSR
2022/02/01 11:45:32 [INFO] generating key: ecdsa-256
2022/02/01 11:45:32 [INFO] encoded CSR
</code></pre><p>This command generates two files; it generates <code>server.csr</code> containing the PEM
encoded <a href="https://tools.ietf.org/html/rfc2986">PKCS#10</a> certification request,
and <code>server-key.pem</code> containing the PEM encoded key to the certificate that
is still to be created.</p><h2 id="create-a-certificatesigningrequest-object-to-send-to-the-kubernetes-api">Create a CertificateSigningRequest object to send to the Kubernetes API</h2><p>Generate a CSR manifest (in YAML), and send it to the API server. You can do that by
running the following command:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>cat <span style="color:#b44">&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style="display:flex"><span><span style="color:#b44">apiVersion: certificates.k8s.io/v1
</span></span></span><span style="display:flex"><span><span style="color:#b44">kind: CertificateSigningRequest
</span></span></span><span style="display:flex"><span><span style="color:#b44">metadata:
</span></span></span><span style="display:flex"><span><span style="color:#b44">  name: my-svc.my-namespace
</span></span></span><span style="display:flex"><span><span style="color:#b44">spec:
</span></span></span><span style="display:flex"><span><span style="color:#b44">  request: $(cat server.csr | base64 | tr -d '\n')
</span></span></span><span style="display:flex"><span><span style="color:#b44">  signerName: example.com/serving
</span></span></span><span style="display:flex"><span><span style="color:#b44">  usages:
</span></span></span><span style="display:flex"><span><span style="color:#b44">  - digital signature
</span></span></span><span style="display:flex"><span><span style="color:#b44">  - key encipherment
</span></span></span><span style="display:flex"><span><span style="color:#b44">  - server auth
</span></span></span><span style="display:flex"><span><span style="color:#b44">EOF</span>
</span></span></code></pre></div><p>Notice that the <code>server.csr</code> file created in step 1 is base64 encoded
and stashed in the <code>.spec.request</code> field. You are also requesting a
certificate with the "digital signature", "key encipherment", and "server
auth" key usages, signed by an example <code>example.com/serving</code> signer.
A specific <code>signerName</code> must be requested.
View documentation for <a href="/docs/reference/access-authn-authz/certificate-signing-requests/#signers">supported signer names</a>
for more information.</p><p>The CSR should now be visible from the API in a Pending state. You can see
it by running:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl describe csr my-svc.my-namespace
</span></span></code></pre></div><pre tabindex="0"><code class="language-none" data-lang="none">Name:                   my-svc.my-namespace
Labels:                 &lt;none&gt;
Annotations:            &lt;none&gt;
CreationTimestamp:      Tue, 01 Feb 2022 11:49:15 -0500
Requesting User:        yourname@example.com
Signer:                 example.com/serving
Status:                 Pending
Subject:
        Common Name:    my-pod.my-namespace.pod.cluster.local
        Serial Number:
Subject Alternative Names:
        DNS Names:      my-pod.my-namespace.pod.cluster.local
                        my-svc.my-namespace.svc.cluster.local
        IP Addresses:   192.0.2.24
                        10.0.34.2
Events: &lt;none&gt;
</code></pre><h2 id="get-the-certificate-signing-request-approved">Get the CertificateSigningRequest approved</h2><p>Approving the <a href="/docs/reference/access-authn-authz/certificate-signing-requests/">certificate signing request</a>
is either done by an automated approval process or on a one off basis by a cluster
administrator. If you're authorized to approve a certificate request, you can do that
manually using <code>kubectl</code>; for example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl certificate approve my-svc.my-namespace
</span></span></code></pre></div><pre tabindex="0"><code class="language-none" data-lang="none">certificatesigningrequest.certificates.k8s.io/my-svc.my-namespace approved
</code></pre><p>You should now see the following:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get csr
</span></span></code></pre></div><pre tabindex="0"><code class="language-none" data-lang="none">NAME                  AGE   SIGNERNAME            REQUESTOR              REQUESTEDDURATION   CONDITION
my-svc.my-namespace   10m   example.com/serving   yourname@example.com   &lt;none&gt;              Approved
</code></pre><p>This means the certificate request has been approved and is waiting for the
requested signer to sign it.</p><h2 id="sign-the-certificate-signing-request">Sign the CertificateSigningRequest</h2><p>Next, you'll play the part of a certificate signer, issue the certificate, and upload it to the API.</p><p>A signer would typically watch the CertificateSigningRequest API for objects with its <code>signerName</code>,
check that they have been approved, sign certificates for those requests,
and update the API object status with the issued certificate.</p><h3 id="create-a-certificate-authority">Create a Certificate Authority</h3><p>You need an authority to provide the digital signature on the new certificate.</p><p>First, create a signing certificate by running the following:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>cat <span style="color:#b44">&lt;&lt;EOF | cfssl gencert -initca - | cfssljson -bare ca
</span></span></span><span style="display:flex"><span><span style="color:#b44">{
</span></span></span><span style="display:flex"><span><span style="color:#b44">  "CN": "My Example Signer",
</span></span></span><span style="display:flex"><span><span style="color:#b44">  "key": {
</span></span></span><span style="display:flex"><span><span style="color:#b44">    "algo": "rsa",
</span></span></span><span style="display:flex"><span><span style="color:#b44">    "size": 2048
</span></span></span><span style="display:flex"><span><span style="color:#b44">  }
</span></span></span><span style="display:flex"><span><span style="color:#b44">}
</span></span></span><span style="display:flex"><span><span style="color:#b44">EOF</span>
</span></span></code></pre></div><p>You should see output similar to:</p><pre tabindex="0"><code class="language-none" data-lang="none">2022/02/01 11:50:39 [INFO] generating a new CA key and certificate from CSR
2022/02/01 11:50:39 [INFO] generate received request
2022/02/01 11:50:39 [INFO] received CSR
2022/02/01 11:50:39 [INFO] generating key: rsa-2048
2022/02/01 11:50:39 [INFO] encoded CSR
2022/02/01 11:50:39 [INFO] signed certificate with serial number 263983151013686720899716354349605500797834580472
</code></pre><p>This produces a certificate authority key file (<code>ca-key.pem</code>) and certificate (<code>ca.pem</code>).</p><h3 id="issue-a-certificate">Issue a certificate</h3><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/tls/server-signing-config.json" download="tls/server-signing-config.json"><code>tls/server-signing-config.json</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;tls-server-signing-config-json&quot;)" title="Copy tls/server-signing-config.json to clipboard"/></div><div class="includecode" id="tls-server-signing-config-json"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="display:flex"><span>{
</span></span><span style="display:flex"><span>    <span style="color:green;font-weight:700">"signing"</span>: {
</span></span><span style="display:flex"><span>        <span style="color:green;font-weight:700">"default"</span>: {
</span></span><span style="display:flex"><span>            <span style="color:green;font-weight:700">"usages"</span>: [
</span></span><span style="display:flex"><span>                <span style="color:#b44">"digital signature"</span>,
</span></span><span style="display:flex"><span>                <span style="color:#b44">"key encipherment"</span>,
</span></span><span style="display:flex"><span>                <span style="color:#b44">"server auth"</span>
</span></span><span style="display:flex"><span>            ],
</span></span><span style="display:flex"><span>            <span style="color:green;font-weight:700">"expiry"</span>: <span style="color:#b44">"876000h"</span>,
</span></span><span style="display:flex"><span>            <span style="color:green;font-weight:700">"ca_constraint"</span>: {
</span></span><span style="display:flex"><span>                <span style="color:green;font-weight:700">"is_ca"</span>: <span style="color:#a2f;font-weight:700">false</span>
</span></span><span style="display:flex"><span>            }
</span></span><span style="display:flex"><span>        }
</span></span><span style="display:flex"><span>    }
</span></span><span style="display:flex"><span>}</span></span></code></pre></div></div></div><p>Use a <code>server-signing-config.json</code> signing configuration and the certificate authority key file
and certificate to sign the certificate request:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get csr my-svc.my-namespace -o <span style="color:#b8860b">jsonpath</span><span style="color:#666">=</span><span style="color:#b44">'{.spec.request}'</span> | <span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>  base64 --decode | <span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>  cfssl sign -ca ca.pem -ca-key ca-key.pem -config server-signing-config.json - | <span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>  cfssljson -bare ca-signed-server
</span></span></code></pre></div><p>You should see the output similar to:</p><pre tabindex="0"><code>2022/02/01 11:52:26 [INFO] signed certificate with serial number 576048928624926584381415936700914530534472870337
</code></pre><p>This produces a signed serving certificate file, <code>ca-signed-server.pem</code>.</p><h3 id="upload-the-signed-certificate">Upload the signed certificate</h3><p>Finally, populate the signed certificate in the API object's status:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get csr my-svc.my-namespace -o json | <span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>  jq <span style="color:#b44">'.status.certificate = "'</span><span style="color:#a2f;font-weight:700">$(</span>base64 ca-signed-server.pem | tr -d <span style="color:#b44">'\n'</span><span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">'"'</span> | <span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>  kubectl replace --raw /apis/certificates.k8s.io/v1/certificatesigningrequests/my-svc.my-namespace/status -f -
</span></span></code></pre></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>This uses the command line tool <a href="https://jqlang.github.io/jq/"><code>jq</code></a> to populate the base64-encoded
content in the <code>.status.certificate</code> field.
If you do not have <code>jq</code>, you can also save the JSON output to a file, populate this field manually, and
upload the resulting file.</div><p>Once the CSR is approved and the signed certificate is uploaded, run:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get csr
</span></span></code></pre></div><p>The output is similar to:</p><pre tabindex="0"><code class="language-none" data-lang="none">NAME                  AGE   SIGNERNAME            REQUESTOR              REQUESTEDDURATION   CONDITION
my-svc.my-namespace   20m   example.com/serving   yourname@example.com   &lt;none&gt;              Approved,Issued
</code></pre><h2 id="download-the-certificate-and-use-it">Download the certificate and use it</h2><p>Now, as the requesting user, you can download the issued certificate
and save it to a <code>server.crt</code> file by running the following:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get csr my-svc.my-namespace -o <span style="color:#b8860b">jsonpath</span><span style="color:#666">=</span><span style="color:#b44">'{.status.certificate}'</span> <span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>    | base64 --decode &gt; server.crt
</span></span></code></pre></div><p>Now you can populate <code>server.crt</code> and <code>server-key.pem</code> in a
<a class="glossary-tooltip" title="Stores sensitive information, such as passwords, OAuth tokens, and ssh keys." data-toggle="tooltip" data-placement="top" href="/docs/concepts/configuration/secret/" target="_blank" aria-label="Secret">Secret</a>
that you could later mount into a Pod (for example, to use with a webserver
that serves HTTPS).</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create secret tls server --cert server.crt --key server-key.pem
</span></span></code></pre></div><pre tabindex="0"><code class="language-none" data-lang="none">secret/server created
</code></pre><p>Finally, you can populate <code>ca.pem</code> into a <a class="glossary-tooltip" title="An API object used to store non-confidential data in key-value pairs. Can be consumed as environment variables, command-line arguments, or configuration files in a volume." data-toggle="tooltip" data-placement="top" href="/docs/concepts/configuration/configmap/" target="_blank" aria-label="ConfigMap">ConfigMap</a>
and use it as the trust root to verify the serving certificate:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create configmap example-serving-ca --from-file ca.crt<span style="color:#666">=</span>ca.pem
</span></span></code></pre></div><pre tabindex="0"><code class="language-none" data-lang="none">configmap/example-serving-ca created
</code></pre><h2 id="approving-certificate-signing-requests">Approving CertificateSigningRequests</h2><p>A Kubernetes administrator (with appropriate permissions) can manually approve
(or deny) CertificateSigningRequests by using the <code>kubectl certificate approve</code> and <code>kubectl certificate deny</code> commands. However if you intend
to make heavy usage of this API, you might consider writing an automated
certificates controller.</p><div class="alert alert-caution" role="alert"><h4 class="alert-heading">Caution:</h4><p>The ability to approve CSRs decides who trusts whom within your environment. The
ability to approve CSRs should not be granted broadly or lightly.</p><p>You should make sure that you confidently understand both the verification requirements
that fall on the approver <strong>and</strong> the repercussions of issuing a specific certificate
before you grant the <code>approve</code> permission.</p></div><p>Whether a machine or a human using kubectl as above, the role of the <em>approver</em> is
to verify that the CSR satisfies two requirements:</p><ol><li>The subject of the CSR controls the private key used to sign the CSR. This
addresses the threat of a third party masquerading as an authorized subject.
In the above example, this step would be to verify that the pod controls the
private key used to generate the CSR.</li><li>The subject of the CSR is authorized to act in the requested context. This
addresses the threat of an undesired subject joining the cluster. In the
above example, this step would be to verify that the pod is allowed to
participate in the requested service.</li></ol><p>If and only if these two requirements are met, the approver should approve
the CSR and otherwise should deny the CSR.</p><p>For more information on certificate approval and access control, read
the <a href="/docs/reference/access-authn-authz/certificate-signing-requests/">Certificate Signing Requests</a>
reference page.</p><h2 id="configuring-your-cluster-to-provide-signing">Configuring your cluster to provide signing</h2><p>This page assumes that a signer is set up to serve the certificates API. The
Kubernetes controller manager provides a default implementation of a signer. To
enable it, pass the <code>--cluster-signing-cert-file</code> and
<code>--cluster-signing-key-file</code> parameters to the controller manager with paths to
your Certificate Authority's keypair.</p></div>
<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Install Tools</h1><div class="lead">Set up Kubernetes tools on your computer.</div><h2 id="kubectl">kubectl</h2><p>The Kubernetes command-line tool, <a href="/docs/reference/kubectl/kubectl/">kubectl</a>, allows
you to run commands against Kubernetes clusters.
You can use kubectl to deploy applications, inspect and manage cluster resources,
and view logs. For more information including a complete list of kubectl operations, see the
<a href="/docs/reference/kubectl/"><code>kubectl</code> reference documentation</a>.</p><p>kubectl is installable on a variety of Linux platforms, macOS and Windows.
Find your preferred operating system below.</p><ul><li><a href="/docs/tasks/tools/install-kubectl-linux/">Install kubectl on Linux</a></li><li><a href="/docs/tasks/tools/install-kubectl-macos/">Install kubectl on macOS</a></li><li><a href="/docs/tasks/tools/install-kubectl-windows/">Install kubectl on Windows</a></li></ul><h2 id="kind">kind</h2><p><a href="https://kind.sigs.k8s.io/"><code>kind</code></a> lets you run Kubernetes on
your local computer. This tool requires that you have either
<a href="https://www.docker.com/">Docker</a> or <a href="https://podman.io/">Podman</a> installed.</p><p>The kind <a href="https://kind.sigs.k8s.io/docs/user/quick-start/">Quick Start</a> page
shows you what you need to do to get up and running with kind.</p><p><a class="btn btn-primary" href="https://kind.sigs.k8s.io/docs/user/quick-start/" role="button" aria-label="View kind Quick Start Guide">View kind Quick Start Guide</a></p><h2 id="minikube">minikube</h2><p>Like <code>kind</code>, <a href="https://minikube.sigs.k8s.io/"><code>minikube</code></a> is a tool that lets you run Kubernetes
locally. <code>minikube</code> runs an all-in-one or a multi-node local Kubernetes cluster on your personal
computer (including Windows, macOS and Linux PCs) so that you can try out
Kubernetes, or for daily development work.</p><p>You can follow the official
<a href="https://minikube.sigs.k8s.io/docs/start/">Get Started!</a> guide if your focus is
on getting the tool installed.</p><p><a class="btn btn-primary" href="https://minikube.sigs.k8s.io/docs/start/" role="button" aria-label="View minikube Get Started! Guide">View minikube Get Started! Guide</a></p><p>Once you have <code>minikube</code> working, you can use it to
<a href="/docs/tutorials/hello-minikube/">run a sample application</a>.</p><h2 id="kubeadm">kubeadm</h2><p>You can use the <a class="glossary-tooltip" title="A tool for quickly installing Kubernetes and setting up a secure cluster." data-toggle="tooltip" data-placement="top" href="/docs/reference/setup-tools/kubeadm/" target="_blank" aria-label="kubeadm">kubeadm</a> tool to create and manage Kubernetes clusters.
It performs the actions necessary to get a minimum viable, secure cluster up and running in a user friendly way.</p><p><a href="/docs/setup/production-environment/tools/kubeadm/install-kubeadm/">Installing kubeadm</a> shows you how to install kubeadm.
Once installed, you can use it to <a href="/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/">create a cluster</a>.</p><p><a class="btn btn-primary" href="/docs/setup/production-environment/tools/kubeadm/install-kubeadm/" role="button" aria-label="View kubeadm Install Guide">View kubeadm Install Guide</a></p><div class="section-index"/></div>