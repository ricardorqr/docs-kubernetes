<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Distribute Credentials Securely Using Secrets</h1><p>This page shows how to securely inject sensitive data, such as passwords and
encryption keys, into Pods.</p><h2 id="before-you-begin">Before you begin</h2><p>You need to have a Kubernetes cluster, and the kubectl command-line tool must
be configured to communicate with your cluster. It is recommended to run this tutorial on a cluster with at least two nodes that are not acting as control plane hosts. If you do not already have a
cluster, you can create one by using
<a href="https://minikube.sigs.k8s.io/docs/tutorials/multi_node/">minikube</a>
or you can use one of these Kubernetes playgrounds:</p><ul><li><a href="https://labs.iximiuz.com/playgrounds?category=kubernetes&amp;filter=all">iximiuz Labs</a></li><li><a href="https://killercoda.com/playgrounds/scenario/kubernetes">Killercoda</a></li><li><a href="https://kodekloud.com/public-playgrounds">KodeKloud</a></li><li><a href="https://labs.play-with-k8s.com/">Play with Kubernetes</a></li></ul><h3 id="convert-your-secret-data-to-a-base-64-representation">Convert your secret data to a base-64 representation</h3><p>Suppose you want to have two pieces of secret data: a username <code>my-app</code> and a password
<code>39528$vdg7Jb</code>. First, use a base64 encoding tool to convert your username and password to a base64 representation. Here's an example using the commonly available base64 program:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#a2f">echo</span> -n <span style="color:#b44">'my-app'</span> | base64
</span></span><span style="display:flex"><span><span style="color:#a2f">echo</span> -n <span style="color:#b44">'39528$vdg7Jb'</span> | base64
</span></span></code></pre></div><p>The output shows that the base-64 representation of your username is <code>bXktYXBw</code>,
and the base-64 representation of your password is <code>Mzk1MjgkdmRnN0pi</code>.</p><div class="alert alert-caution" role="alert"><h4 class="alert-heading">Caution:</h4>Use a local tool trusted by your OS to decrease the security risks of external tools.</div><h2 id="create-a-secret">Create a Secret</h2><p>Here is a configuration file you can use to create a Secret that holds your
username and password:</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/pods/inject/secret.yaml" download="pods/inject/secret.yaml"><code>pods/inject/secret.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;pods-inject-secret-yaml&quot;)" title="Copy pods/inject/secret.yaml to clipboard"/></div><div class="includecode" id="pods-inject-secret-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Secret<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>test-secret<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">data</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">username</span>:<span style="color:#bbb"> </span>bXktYXBw<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">password</span>:<span style="color:#bbb"> </span>Mzk1MjgkdmRnN0pi<span style="color:#bbb">
</span></span></span></code></pre></div></div></div><ol><li><p>Create the Secret</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply -f https://k8s.io/examples/pods/inject/secret.yaml
</span></span></code></pre></div></li><li><p>View information about the Secret:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get secret test-secret
</span></span></code></pre></div><p>Output:</p><pre tabindex="0"><code>NAME          TYPE      DATA      AGE
test-secret   Opaque    2         1m
</code></pre></li><li><p>View more detailed information about the Secret:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl describe secret test-secret
</span></span></code></pre></div><p>Output:</p><pre tabindex="0"><code>Name:       test-secret
Namespace:  default
Labels:     &lt;none&gt;
Annotations:    &lt;none&gt;

Type:   Opaque

Data
====
password:   13 bytes
username:   7 bytes
</code></pre></li></ol><h3 id="create-a-secret-directly-with-kubectl">Create a Secret directly with kubectl</h3><p>If you want to skip the Base64 encoding step, you can create the
same Secret using the <code>kubectl create secret</code> command. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create secret generic test-secret --from-literal<span style="color:#666">=</span><span style="color:#b44">'username=my-app'</span> --from-literal<span style="color:#666">=</span><span style="color:#b44">'password=39528$vdg7Jb'</span>
</span></span></code></pre></div><p>This is more convenient. The detailed approach shown earlier runs
through each step explicitly to demonstrate what is happening.</p><h2 id="create-a-pod-that-has-access-to-the-secret-data-through-a-volume">Create a Pod that has access to the secret data through a Volume</h2><p>Here is a configuration file you can use to create a Pod:</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/pods/inject/secret-pod.yaml" download="pods/inject/secret-pod.yaml"><code>pods/inject/secret-pod.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;pods-inject-secret-pod-yaml&quot;)" title="Copy pods/inject/secret-pod.yaml to clipboard"/></div><div class="includecode" id="pods-inject-secret-pod-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>secret-test-pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>test-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>nginx<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">volumeMounts</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># name must match the volume name below</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>secret-volume<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">mountPath</span>:<span style="color:#bbb"> </span>/etc/secret-volume<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">readOnly</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:700">true</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:#080;font-style:italic"># The secret data is exposed to Containers in the Pod through a Volume.</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">volumes</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>secret-volume<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">secret</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">secretName</span>:<span style="color:#bbb"> </span>test-secret<span style="color:#bbb">
</span></span></span></code></pre></div></div></div><ol><li><p>Create the Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply -f https://k8s.io/examples/pods/inject/secret-pod.yaml
</span></span></code></pre></div></li><li><p>Verify that your Pod is running:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get pod secret-test-pod
</span></span></code></pre></div><p>Output:</p><pre tabindex="0"><code>NAME              READY     STATUS    RESTARTS   AGE
secret-test-pod   1/1       Running   0          42m
</code></pre></li><li><p>Get a shell into the Container that is running in your Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl <span style="color:#a2f">exec</span> -i -t secret-test-pod -- /bin/bash
</span></span></code></pre></div></li><li><p>The secret data is exposed to the Container through a Volume mounted under
<code>/etc/secret-volume</code>.</p><p>In your shell, list the files in the <code>/etc/secret-volume</code> directory:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Run this in the shell inside the container</span>
</span></span><span style="display:flex"><span>ls /etc/secret-volume
</span></span></code></pre></div><p>The output shows two files, one for each piece of secret data:</p><pre tabindex="0"><code>password username
</code></pre></li><li><p>In your shell, display the contents of the <code>username</code> and <code>password</code> files:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Run this in the shell inside the container</span>
</span></span><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b44">"</span><span style="color:#a2f;font-weight:700">$(</span> cat /etc/secret-volume/username <span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">"</span>
</span></span><span style="display:flex"><span><span style="color:#a2f">echo</span> <span style="color:#b44">"</span><span style="color:#a2f;font-weight:700">$(</span> cat /etc/secret-volume/password <span style="color:#a2f;font-weight:700">)</span><span style="color:#b44">"</span>
</span></span></code></pre></div><p>The output is your username and password:</p><pre tabindex="0"><code>my-app
39528$vdg7Jb
</code></pre></li></ol><p>Modify your image or command line so that the program looks for files in the
<code>mountPath</code> directory. Each key in the Secret <code>data</code> map becomes a file name
in this directory.</p><h3 id="project-secret-keys-to-specific-file-paths">Project Secret keys to specific file paths</h3><p>You can also control the paths within the volume where Secret keys are projected. Use the
<code>.spec.volumes[].secret.items</code> field to change the target path of each key:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>mypod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>mypod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>redis<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">volumeMounts</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>foo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">mountPath</span>:<span style="color:#bbb"> </span><span style="color:#b44">"/etc/foo"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">readOnly</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:700">true</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">volumes</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>foo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">secret</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">secretName</span>:<span style="color:#bbb"> </span>mysecret<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">items</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span>- <span style="color:green;font-weight:700">key</span>:<span style="color:#bbb"> </span>username<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">path</span>:<span style="color:#bbb"> </span>my-group/my-username<span style="color:#bbb">
</span></span></span></code></pre></div><p>When you deploy this Pod, the following happens:</p><ul><li>The <code>username</code> key from <code>mysecret</code> is available to the container at the path
<code>/etc/foo/my-group/my-username</code> instead of at <code>/etc/foo/username</code>.</li><li>The <code>password</code> key from that Secret object is not projected.</li></ul><p>If you list keys explicitly using <code>.spec.volumes[].secret.items</code>, consider the
following:</p><ul><li>Only keys specified in <code>items</code> are projected.</li><li>To consume all keys from the Secret, all of them must be listed in the
<code>items</code> field.</li><li>All listed keys must exist in the corresponding Secret. Otherwise, the volume
is not created.</li></ul><h3 id="set-posix-permissions-for-secret-keys">Set POSIX permissions for Secret keys</h3><p>You can set the POSIX file access permission bits for a single Secret key.
If you don't specify any permissions, <code>0644</code> is used by default.
You can also set a default POSIX file mode for the entire Secret volume, and
you can override per key if needed.</p><p>For example, you can specify a default mode like this:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>mypod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>mypod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>redis<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">volumeMounts</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>foo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">mountPath</span>:<span style="color:#bbb"> </span><span style="color:#b44">"/etc/foo"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">volumes</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>foo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">secret</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">secretName</span>:<span style="color:#bbb"> </span>mysecret<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">defaultMode</span>:<span style="color:#bbb"> </span><span style="color:#666">0400</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>The Secret is mounted on <code>/etc/foo</code>; all the files created by the
secret volume mount have permission <code>0400</code>.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>If you're defining a Pod or a Pod template using JSON, beware that the JSON
specification doesn't support octal literals for numbers because JSON considers
<code>0400</code> to be the <em>decimal</em> value <code>400</code>. In JSON, use decimal values for the
<code>defaultMode</code> instead. If you're writing YAML, you can write the <code>defaultMode</code>
in octal.</div><h2 id="define-container-environment-variables-using-secret-data">Define container environment variables using Secret data</h2><p>You can consume the data in Secrets as environment variables in your
containers.</p><p>If a container already consumes a Secret in an environment variable,
a Secret update will not be seen by the container unless it is
restarted. There are third party solutions for triggering restarts when
secrets change.</p><h3 id="define-a-container-environment-variable-with-data-from-a-single-secret">Define a container environment variable with data from a single Secret</h3><ul><li><p>Define an environment variable as a key-value pair in a Secret:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create secret generic backend-user --from-literal<span style="color:#666">=</span>backend-username<span style="color:#666">=</span><span style="color:#b44">'backend-admin'</span>
</span></span></code></pre></div></li><li><p>Assign the <code>backend-username</code> value defined in the Secret to the <code>SECRET_USERNAME</code> environment variable in the Pod specification.</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/pods/inject/pod-single-secret-env-variable.yaml" download="pods/inject/pod-single-secret-env-variable.yaml"><code>pods/inject/pod-single-secret-env-variable.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;pods-inject-pod-single-secret-env-variable-yaml&quot;)" title="Copy pods/inject/pod-single-secret-env-variable.yaml to clipboard"/></div><div class="includecode" id="pods-inject-pod-single-secret-env-variable-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>env-single-secret<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>envars-test-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>nginx<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">env</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>SECRET_USERNAME<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">secretKeyRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>backend-user<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">key</span>:<span style="color:#bbb"> </span>backend-username<span style="color:#bbb">
</span></span></span></code></pre></div></div></div></li><li><p>Create the Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create -f https://k8s.io/examples/pods/inject/pod-single-secret-env-variable.yaml
</span></span></code></pre></div></li><li><p>In your shell, display the content of <code>SECRET_USERNAME</code> container environment variable.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl <span style="color:#a2f">exec</span> -i -t env-single-secret -- /bin/sh -c <span style="color:#b44">'echo $SECRET_USERNAME'</span>
</span></span></code></pre></div><p>The output is similar to:</p><pre tabindex="0"><code>backend-admin
</code></pre></li></ul><h3 id="define-container-environment-variables-with-data-from-multiple-secrets">Define container environment variables with data from multiple Secrets</h3><ul><li><p>As with the previous example, create the Secrets first.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create secret generic backend-user --from-literal<span style="color:#666">=</span>backend-username<span style="color:#666">=</span><span style="color:#b44">'backend-admin'</span>
</span></span><span style="display:flex"><span>kubectl create secret generic db-user --from-literal<span style="color:#666">=</span>db-username<span style="color:#666">=</span><span style="color:#b44">'db-admin'</span>
</span></span></code></pre></div></li><li><p>Define the environment variables in the Pod specification.</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/pods/inject/pod-multiple-secret-env-variable.yaml" download="pods/inject/pod-multiple-secret-env-variable.yaml"><code>pods/inject/pod-multiple-secret-env-variable.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;pods-inject-pod-multiple-secret-env-variable-yaml&quot;)" title="Copy pods/inject/pod-multiple-secret-env-variable.yaml to clipboard"/></div><div class="includecode" id="pods-inject-pod-multiple-secret-env-variable-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>envvars-multiple-secrets<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>envars-test-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>nginx<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">env</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>BACKEND_USERNAME<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">secretKeyRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>backend-user<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">key</span>:<span style="color:#bbb"> </span>backend-username<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>DB_USERNAME<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">secretKeyRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>db-user<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">key</span>:<span style="color:#bbb"> </span>db-username<span style="color:#bbb">
</span></span></span></code></pre></div></div></div></li><li><p>Create the Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create -f https://k8s.io/examples/pods/inject/pod-multiple-secret-env-variable.yaml
</span></span></code></pre></div></li><li><p>In your shell, display the container environment variables.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl <span style="color:#a2f">exec</span> -i -t envvars-multiple-secrets -- /bin/sh -c <span style="color:#b44">'env | grep _USERNAME'</span>
</span></span></code></pre></div><p>The output is similar to:</p><pre tabindex="0"><code>DB_USERNAME=db-admin
BACKEND_USERNAME=backend-admin
</code></pre></li></ul><h2 id="configure-all-key-value-pairs-in-a-secret-as-container-environment-variables">Configure all key-value pairs in a Secret as container environment variables</h2><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>This functionality is available in Kubernetes v1.6 and later.</div><ul><li><p>Create a Secret containing multiple key-value pairs</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create secret generic test-secret --from-literal<span style="color:#666">=</span><span style="color:#b8860b">username</span><span style="color:#666">=</span><span style="color:#b44">'my-app'</span> --from-literal<span style="color:#666">=</span><span style="color:#b8860b">password</span><span style="color:#666">=</span><span style="color:#b44">'39528$vdg7Jb'</span>
</span></span></code></pre></div></li><li><p>Use envFrom to define all of the Secret's data as container environment variables.
The key from the Secret becomes the environment variable name in the Pod.</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/pods/inject/pod-secret-envFrom.yaml" download="pods/inject/pod-secret-envFrom.yaml"><code>pods/inject/pod-secret-envFrom.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;pods-inject-pod-secret-envfrom-yaml&quot;)" title="Copy pods/inject/pod-secret-envFrom.yaml to clipboard"/></div><div class="includecode" id="pods-inject-pod-secret-envfrom-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>envfrom-secret<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>envars-test-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>nginx<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">envFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">secretRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>test-secret<span style="color:#bbb">
</span></span></span></code></pre></div></div></div></li><li><p>Create the Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create -f https://k8s.io/examples/pods/inject/pod-secret-envFrom.yaml
</span></span></code></pre></div></li><li><p>In your shell, display <code>username</code> and <code>password</code> container environment variables.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl <span style="color:#a2f">exec</span> -i -t envfrom-secret -- /bin/sh -c <span style="color:#b44">'echo "username: $username\npassword: $password\n"'</span>
</span></span></code></pre></div><p>The output is similar to:</p><pre tabindex="0"><code>username: my-app
password: 39528$vdg7Jb
</code></pre></li></ul><h2 id="provide-prod-test-creds">Example: Provide prod/test credentials to Pods using Secrets</h2><p>This example illustrates a Pod which consumes a secret containing production credentials and
another Pod which consumes a secret with test environment credentials.</p><ol><li><p>Create a secret for prod environment credentials:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create secret generic prod-db-secret --from-literal<span style="color:#666">=</span><span style="color:#b8860b">username</span><span style="color:#666">=</span>produser --from-literal<span style="color:#666">=</span><span style="color:#b8860b">password</span><span style="color:#666">=</span>Y4nys7f11
</span></span></code></pre></div><p>The output is similar to:</p><pre tabindex="0"><code>secret "prod-db-secret" created
</code></pre></li><li><p>Create a secret for test environment credentials.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create secret generic test-db-secret --from-literal<span style="color:#666">=</span><span style="color:#b8860b">username</span><span style="color:#666">=</span>testuser --from-literal<span style="color:#666">=</span><span style="color:#b8860b">password</span><span style="color:#666">=</span>iluvtests
</span></span></code></pre></div><p>The output is similar to:</p><pre tabindex="0"><code>secret "test-db-secret" created
</code></pre><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4><p>Special characters such as <code>$</code>, <code>\</code>, <code>*</code>, <code>=</code>, and <code>!</code> will be interpreted by your
<a href="https://en.wikipedia.org/wiki/Shell_(computing)">shell</a> and require escaping.</p><p>In most shells, the easiest way to escape the password is to surround it with single quotes (<code>'</code>).
For example, if your actual password is <code>S!B\*d$zDsb=</code>, you should execute the command as follows:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create secret generic dev-db-secret --from-literal<span style="color:#666">=</span><span style="color:#b8860b">username</span><span style="color:#666">=</span>devuser --from-literal<span style="color:#666">=</span><span style="color:#b8860b">password</span><span style="color:#666">=</span><span style="color:#b44">'S!B\*d$zDsb='</span>
</span></span></code></pre></div><p>You do not need to escape special characters in passwords from files (<code>--from-file</code>).</p></div></li><li><p>Create the Pod manifests:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>cat <span style="color:#b44">&lt;&lt;EOF &gt; pod.yaml
</span></span></span><span style="display:flex"><span><span style="color:#b44">apiVersion: v1
</span></span></span><span style="display:flex"><span><span style="color:#b44">kind: List
</span></span></span><span style="display:flex"><span><span style="color:#b44">items:
</span></span></span><span style="display:flex"><span><span style="color:#b44">- kind: Pod
</span></span></span><span style="display:flex"><span><span style="color:#b44">  apiVersion: v1
</span></span></span><span style="display:flex"><span><span style="color:#b44">  metadata:
</span></span></span><span style="display:flex"><span><span style="color:#b44">    name: prod-db-client-pod
</span></span></span><span style="display:flex"><span><span style="color:#b44">    labels:
</span></span></span><span style="display:flex"><span><span style="color:#b44">      name: prod-db-client
</span></span></span><span style="display:flex"><span><span style="color:#b44">  spec:
</span></span></span><span style="display:flex"><span><span style="color:#b44">    volumes:
</span></span></span><span style="display:flex"><span><span style="color:#b44">    - name: secret-volume
</span></span></span><span style="display:flex"><span><span style="color:#b44">      secret:
</span></span></span><span style="display:flex"><span><span style="color:#b44">        secretName: prod-db-secret
</span></span></span><span style="display:flex"><span><span style="color:#b44">    containers:
</span></span></span><span style="display:flex"><span><span style="color:#b44">    - name: db-client-container
</span></span></span><span style="display:flex"><span><span style="color:#b44">      image: myClientImage
</span></span></span><span style="display:flex"><span><span style="color:#b44">      volumeMounts:
</span></span></span><span style="display:flex"><span><span style="color:#b44">      - name: secret-volume
</span></span></span><span style="display:flex"><span><span style="color:#b44">        readOnly: true
</span></span></span><span style="display:flex"><span><span style="color:#b44">        mountPath: "/etc/secret-volume"
</span></span></span><span style="display:flex"><span><span style="color:#b44">- kind: Pod
</span></span></span><span style="display:flex"><span><span style="color:#b44">  apiVersion: v1
</span></span></span><span style="display:flex"><span><span style="color:#b44">  metadata:
</span></span></span><span style="display:flex"><span><span style="color:#b44">    name: test-db-client-pod
</span></span></span><span style="display:flex"><span><span style="color:#b44">    labels:
</span></span></span><span style="display:flex"><span><span style="color:#b44">      name: test-db-client
</span></span></span><span style="display:flex"><span><span style="color:#b44">  spec:
</span></span></span><span style="display:flex"><span><span style="color:#b44">    volumes:
</span></span></span><span style="display:flex"><span><span style="color:#b44">    - name: secret-volume
</span></span></span><span style="display:flex"><span><span style="color:#b44">      secret:
</span></span></span><span style="display:flex"><span><span style="color:#b44">        secretName: test-db-secret
</span></span></span><span style="display:flex"><span><span style="color:#b44">    containers:
</span></span></span><span style="display:flex"><span><span style="color:#b44">    - name: db-client-container
</span></span></span><span style="display:flex"><span><span style="color:#b44">      image: myClientImage
</span></span></span><span style="display:flex"><span><span style="color:#b44">      volumeMounts:
</span></span></span><span style="display:flex"><span><span style="color:#b44">      - name: secret-volume
</span></span></span><span style="display:flex"><span><span style="color:#b44">        readOnly: true
</span></span></span><span style="display:flex"><span><span style="color:#b44">        mountPath: "/etc/secret-volume"
</span></span></span><span style="display:flex"><span><span style="color:#b44">EOF</span>
</span></span></code></pre></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>How the specs for the two Pods differ only in one field; this facilitates creating Pods
with different capabilities from a common Pod template.</div></li><li><p>Apply all those objects on the API server by running:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create -f pod.yaml
</span></span></code></pre></div></li></ol><p>Both containers will have the following files present on their filesystems with the values
for each container's environment:</p><pre tabindex="0"><code>/etc/secret-volume/username
/etc/secret-volume/password
</code></pre><p>You could further simplify the base Pod specification by using two service accounts:</p><ol><li><code>prod-user</code> with the <code>prod-db-secret</code></li><li><code>test-user</code> with the <code>test-db-secret</code></li></ol><p>The Pod specification is shortened to:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>prod-db-client-pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">labels</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>prod-db-client<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">serviceAccount</span>:<span style="color:#bbb"> </span>prod-db-client<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>db-client-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>myClientImage<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="references">References</h3><ul><li><a href="/docs/reference/generated/kubernetes-api/v1.34/#secret-v1-core">Secret</a></li><li><a href="/docs/reference/generated/kubernetes-api/v1.34/#volume-v1-core">Volume</a></li><li><a href="/docs/reference/generated/kubernetes-api/v1.34/#pod-v1-core">Pod</a></li></ul><h2 id="what-s-next">What's next</h2><ul><li>Learn more about <a href="/docs/concepts/configuration/secret/">Secrets</a>.</li><li>Learn about <a href="/docs/concepts/storage/volumes/">Volumes</a>.</li></ul></div>
<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Define a Command and Arguments for a Container</h1><p>This page shows how to define commands and arguments when you run a container
in a <a class="glossary-tooltip" title="A Pod represents a set of running containers in your cluster." data-toggle="tooltip" data-placement="top" href="/docs/concepts/workloads/pods/" target="_blank" aria-label="Pod">Pod</a>.</p><h2 id="before-you-begin">Before you begin</h2><p><p>You need to have a Kubernetes cluster, and the kubectl command-line tool must
be configured to communicate with your cluster. It is recommended to run this tutorial on a cluster with at least two nodes that are not acting as control plane hosts. If you do not already have a
cluster, you can create one by using
<a href="https://minikube.sigs.k8s.io/docs/tutorials/multi_node/">minikube</a>
or you can use one of these Kubernetes playgrounds:</p><ul><li><a href="https://labs.iximiuz.com/playgrounds?category=kubernetes&amp;filter=all">iximiuz Labs</a></li><li><a href="https://killercoda.com/playgrounds/scenario/kubernetes">Killercoda</a></li><li><a href="https://kodekloud.com/public-playgrounds">KodeKloud</a></li><li><a href="https://labs.play-with-k8s.com/">Play with Kubernetes</a></li></ul><p>To check the version, enter <code>kubectl version</code>.</p></p><h2 id="define-a-command-and-arguments-when-you-create-a-pod">Define a command and arguments when you create a Pod</h2><p>When you create a Pod, you can define a command and arguments for the
containers that run in the Pod. To define a command, include the <code>command</code>
field in the configuration file. To define arguments for the command, include
the <code>args</code> field in the configuration file. The command and arguments that
you define cannot be changed after the Pod is created.</p><p>The command and arguments that you define in the configuration file
override the default command and arguments provided by the container image.
If you define args, but do not define a command, the default command is used
with your new arguments.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>The <code>command</code> field corresponds to <code>ENTRYPOINT</code>, and the <code>args</code> field corresponds to <code>CMD</code> in some container runtimes.</div><p>In this exercise, you create a Pod that runs one container. The configuration
file for the Pod defines a command and two arguments:</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/pods/commands.yaml" download="pods/commands.yaml"><code>pods/commands.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;pods-commands-yaml&quot;)" title="Copy pods/commands.yaml to clipboard"/></div><div class="includecode" id="pods-commands-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>command-demo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">labels</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">purpose</span>:<span style="color:#bbb"> </span>demonstrate-command<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>command-demo-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>debian<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">command</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"printenv"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">args</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"HOSTNAME"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"KUBERNETES_PORT"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">restartPolicy</span>:<span style="color:#bbb"> </span>OnFailure<span style="color:#bbb">
</span></span></span></code></pre></div></div></div><ol><li><p>Create a Pod based on the YAML configuration file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply -f https://k8s.io/examples/pods/commands.yaml
</span></span></code></pre></div></li><li><p>List the running Pods:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get pods
</span></span></code></pre></div><p>The output shows that the container that ran in the command-demo Pod has
completed.</p></li><li><p>To see the output of the command that ran in the container, view the logs
from the Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl logs command-demo
</span></span></code></pre></div><p>The output shows the values of the HOSTNAME and KUBERNETES_PORT environment
variables:</p><pre tabindex="0"><code>command-demo
tcp://10.3.240.1:443
</code></pre></li></ol><h2 id="use-environment-variables-to-define-arguments">Use environment variables to define arguments</h2><p>In the preceding example, you defined the arguments directly by
providing strings. As an alternative to providing strings directly,
you can define arguments by using environment variables:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">env</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MESSAGE<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"hello world"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">command</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"/bin/echo"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">args</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"$(MESSAGE)"</span>]<span style="color:#bbb">
</span></span></span></code></pre></div><p>This means you can define an argument for a Pod using any of
the techniques available for defining environment variables, including
<a href="/docs/tasks/configure-pod-container/configure-pod-configmap/">ConfigMaps</a>
and
<a href="/docs/concepts/configuration/secret/">Secrets</a>.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>The environment variable appears in parentheses, <code>"$(VAR)"</code>. This is
required for the variable to be expanded in the <code>command</code> or <code>args</code> field.</div><h2 id="run-a-command-in-a-shell">Run a command in a shell</h2><p>In some cases, you need your command to run in a shell. For example, your
command might consist of several commands piped together, or it might be a shell
script. To run your command in a shell, wrap it like this:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>command: <span style="color:#666">[</span><span style="color:#b44">"/bin/sh"</span><span style="color:#666">]</span>
</span></span><span style="display:flex"><span>args: <span style="color:#666">[</span><span style="color:#b44">"-c"</span>, <span style="color:#b44">"while true; do echo hello; sleep 10;done"</span><span style="color:#666">]</span>
</span></span></code></pre></div><h2 id="what-s-next">What's next</h2><ul><li>Learn more about <a href="/docs/tasks/">configuring pods and containers</a>.</li><li>Learn more about <a href="/docs/tasks/debug/debug-application/get-shell-running-container/">running commands in a container</a>.</li><li>See <a href="/docs/reference/generated/kubernetes-api/v1.34/#container-v1-core">Container</a>.</li></ul></div>
<hr>
<div class="td-content"><h1>Inject Data Into Applications</h1><div class="lead">Specify configuration and other data for the Pods that run your workload.</div><div class="section-index"><hr class="panel-line"/><div class="entry"><h5><a href="/docs/tasks/inject-data-application/define-command-argument-container/">Define a Command and Arguments for a Container</a></h5><p/></div><div class="entry"><h5><a href="/docs/tasks/inject-data-application/define-interdependent-environment-variables/">Define Dependent Environment Variables</a></h5><p/></div><div class="entry"><h5><a href="/docs/tasks/inject-data-application/define-environment-variable-container/">Define Environment Variables for a Container</a></h5><p/></div><div class="entry"><h5><a href="/docs/tasks/inject-data-application/define-environment-variable-via-file/">Define Environment Variable Values Using An Init Container</a></h5><p/></div><div class="entry"><h5><a href="/docs/tasks/inject-data-application/environment-variable-expose-pod-information/">Expose Pod Information to Containers Through Environment Variables</a></h5><p/></div><div class="entry"><h5><a href="/docs/tasks/inject-data-application/downward-api-volume-expose-pod-information/">Expose Pod Information to Containers Through Files</a></h5><p/></div><div class="entry"><h5><a href="/docs/tasks/inject-data-application/distribute-credentials-secure/">Distribute Credentials Securely Using Secrets</a></h5><p/></div></div></div>
<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Expose Pod Information to Containers Through Files</h1><p>This page shows how a Pod can use a
<a href="/docs/concepts/storage/volumes/#downwardapi"><code>downwardAPI</code> volume</a>,
to expose information about itself to containers running in the Pod.
A <code>downwardAPI</code> volume can expose Pod fields and container fields.</p><p>In Kubernetes, there are two ways to expose Pod and container fields to a running container:</p><ul><li><a href="/docs/tasks/inject-data-application/environment-variable-expose-pod-information/">Environment variables</a></li><li>Volume files, as explained in this task</li></ul><p>Together, these two ways of exposing Pod and container fields are called the
<em>downward API</em>.</p><h2 id="before-you-begin">Before you begin</h2><p>You need to have a Kubernetes cluster, and the kubectl command-line tool must
be configured to communicate with your cluster. It is recommended to run this tutorial on a cluster with at least two nodes that are not acting as control plane hosts. If you do not already have a
cluster, you can create one by using
<a href="https://minikube.sigs.k8s.io/docs/tutorials/multi_node/">minikube</a>
or you can use one of these Kubernetes playgrounds:</p><ul><li><a href="https://labs.iximiuz.com/playgrounds?category=kubernetes&amp;filter=all">iximiuz Labs</a></li><li><a href="https://killercoda.com/playgrounds/scenario/kubernetes">Killercoda</a></li><li><a href="https://kodekloud.com/public-playgrounds">KodeKloud</a></li><li><a href="https://labs.play-with-k8s.com/">Play with Kubernetes</a></li></ul><h2 id="store-pod-fields">Store Pod fields</h2><p>In this part of exercise, you create a Pod that has one container, and you
project Pod-level fields into the running container as files.
Here is the manifest for the Pod:</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/pods/inject/dapi-volume.yaml" download="pods/inject/dapi-volume.yaml"><code>pods/inject/dapi-volume.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;pods-inject-dapi-volume-yaml&quot;)" title="Copy pods/inject/dapi-volume.yaml to clipboard"/></div><div class="includecode" id="pods-inject-dapi-volume-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>kubernetes-downwardapi-volume-example<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">labels</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">zone</span>:<span style="color:#bbb"> </span>us-est-coast<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">cluster</span>:<span style="color:#bbb"> </span>test-cluster1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">rack</span>:<span style="color:#bbb"> </span>rack-22<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">annotations</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">build</span>:<span style="color:#bbb"> </span>two<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">builder</span>:<span style="color:#bbb"> </span>john-doe<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>client-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>registry.k8s.io/busybox:1.27.2<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">command</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"sh"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"-c"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">args</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span>- while true; do<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>if [[ -e /etc/podinfo/labels ]]; then<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span>echo -en '\n\n'; cat /etc/podinfo/labels; fi;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>if [[ -e /etc/podinfo/annotations ]]; then<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span>echo -en '\n\n'; cat /etc/podinfo/annotations; fi;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>sleep 5;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>done;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">volumeMounts</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">mountPath</span>:<span style="color:#bbb"> </span>/etc/podinfo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">volumes</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">downwardAPI</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">items</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>- <span style="color:green;font-weight:700">path</span>:<span style="color:#bbb"> </span><span style="color:#b44">"labels"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">fieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">fieldPath</span>:<span style="color:#bbb"> </span>metadata.labels<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>- <span style="color:green;font-weight:700">path</span>:<span style="color:#bbb"> </span><span style="color:#b44">"annotations"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">fieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">fieldPath</span>:<span style="color:#bbb"> </span>metadata.annotations<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">
</span></span></span></code></pre></div></div></div><p>In the manifest, you can see that the Pod has a <code>downwardAPI</code> Volume,
and the container mounts the volume at <code>/etc/podinfo</code>.</p><p>Look at the <code>items</code> array under <code>downwardAPI</code>. Each element of the array
defines a <code>downwardAPI</code> volume.
The first element specifies that the value of the Pod's
<code>metadata.labels</code> field should be stored in a file named <code>labels</code>.
The second element specifies that the value of the Pod's <code>annotations</code>
field should be stored in a file named <code>annotations</code>.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>The fields in this example are Pod fields. They are not
fields of the container in the Pod.</div><p>Create the Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply -f https://k8s.io/examples/pods/inject/dapi-volume.yaml
</span></span></code></pre></div><p>Verify that the container in the Pod is running:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get pods
</span></span></code></pre></div><p>View the container's logs:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl logs kubernetes-downwardapi-volume-example
</span></span></code></pre></div><p>The output shows the contents of the <code>labels</code> file and the <code>annotations</code> file:</p><pre tabindex="0"><code>cluster="test-cluster1"
rack="rack-22"
zone="us-est-coast"

build="two"
builder="john-doe"
</code></pre><p>Get a shell into the container that is running in your Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl <span style="color:#a2f">exec</span> -it kubernetes-downwardapi-volume-example -- sh
</span></span></code></pre></div><p>In your shell, view the <code>labels</code> file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>/# cat /etc/podinfo/labels
</span></span></code></pre></div><p>The output shows that all of the Pod's labels have been written
to the <code>labels</code> file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#b8860b">cluster</span><span style="color:#666">=</span><span style="color:#b44">"test-cluster1"</span>
</span></span><span style="display:flex"><span><span style="color:#b8860b">rack</span><span style="color:#666">=</span><span style="color:#b44">"rack-22"</span>
</span></span><span style="display:flex"><span><span style="color:#b8860b">zone</span><span style="color:#666">=</span><span style="color:#b44">"us-est-coast"</span>
</span></span></code></pre></div><p>Similarly, view the <code>annotations</code> file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>/# cat /etc/podinfo/annotations
</span></span></code></pre></div><p>View the files in the <code>/etc/podinfo</code> directory:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>/# ls -laR /etc/podinfo
</span></span></code></pre></div><p>In the output, you can see that the <code>labels</code> and <code>annotations</code> files
are in a temporary subdirectory: in this example,
<code>..2982_06_02_21_47_53.299460680</code>. In the <code>/etc/podinfo</code> directory, <code>..data</code> is
a symbolic link to the temporary subdirectory. Also in the <code>/etc/podinfo</code> directory,
<code>labels</code> and <code>annotations</code> are symbolic links.</p><pre tabindex="0"><code>drwxr-xr-x  ... Feb 6 21:47 ..2982_06_02_21_47_53.299460680
lrwxrwxrwx  ... Feb 6 21:47 ..data -&gt; ..2982_06_02_21_47_53.299460680
lrwxrwxrwx  ... Feb 6 21:47 annotations -&gt; ..data/annotations
lrwxrwxrwx  ... Feb 6 21:47 labels -&gt; ..data/labels

/etc/..2982_06_02_21_47_53.299460680:
total 8
-rw-r--r--  ... Feb  6 21:47 annotations
-rw-r--r--  ... Feb  6 21:47 labels
</code></pre><p>Using symbolic links enables dynamic atomic refresh of the metadata; updates are
written to a new temporary directory, and the <code>..data</code> symlink is updated
atomically using <a href="http://man7.org/linux/man-pages/man2/rename.2.html">rename(2)</a>.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>A container using Downward API as a
<a href="/docs/concepts/storage/volumes/#using-subpath">subPath</a> volume mount will not
receive Downward API updates.</div><p>Exit the shell:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>/# <span style="color:#a2f">exit</span>
</span></span></code></pre></div><h2 id="store-container-fields">Store container fields</h2><p>The preceding exercise, you made Pod-level fields accessible using the
downward API.
In this next exercise, you are going to pass fields that are part of the Pod
definition, but taken from the specific
<a href="/docs/reference/kubernetes-api/workload-resources/pod-v1/#Container">container</a>
rather than from the Pod overall. Here is a manifest for a Pod that again has
just one container:</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/pods/inject/dapi-volume-resources.yaml" download="pods/inject/dapi-volume-resources.yaml"><code>pods/inject/dapi-volume-resources.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;pods-inject-dapi-volume-resources-yaml&quot;)" title="Copy pods/inject/dapi-volume-resources.yaml to clipboard"/></div><div class="includecode" id="pods-inject-dapi-volume-resources-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>kubernetes-downwardapi-volume-example-2<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>client-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>registry.k8s.io/busybox:1.27.2<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">command</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"sh"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"-c"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">args</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span>- while true; do<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>echo -en '\n';<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>if [[ -e /etc/podinfo/cpu_limit ]]; then<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span>echo -en '\n'; cat /etc/podinfo/cpu_limit; fi;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>if [[ -e /etc/podinfo/cpu_request ]]; then<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span>echo -en '\n'; cat /etc/podinfo/cpu_request; fi;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>if [[ -e /etc/podinfo/mem_limit ]]; then<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span>echo -en '\n'; cat /etc/podinfo/mem_limit; fi;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>if [[ -e /etc/podinfo/mem_request ]]; then<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span>echo -en '\n'; cat /etc/podinfo/mem_request; fi;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>sleep 5;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>done;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">resources</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">requests</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">memory</span>:<span style="color:#bbb"> </span><span style="color:#b44">"32Mi"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">cpu</span>:<span style="color:#bbb"> </span><span style="color:#b44">"125m"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">limits</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">memory</span>:<span style="color:#bbb"> </span><span style="color:#b44">"64Mi"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">cpu</span>:<span style="color:#bbb"> </span><span style="color:#b44">"250m"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">volumeMounts</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">mountPath</span>:<span style="color:#bbb"> </span>/etc/podinfo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">volumes</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">downwardAPI</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">items</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>- <span style="color:green;font-weight:700">path</span>:<span style="color:#bbb"> </span><span style="color:#b44">"cpu_limit"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">resourceFieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">containerName</span>:<span style="color:#bbb"> </span>client-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">resource</span>:<span style="color:#bbb"> </span>limits.cpu<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">divisor</span>:<span style="color:#bbb"> </span>1m<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>- <span style="color:green;font-weight:700">path</span>:<span style="color:#bbb"> </span><span style="color:#b44">"cpu_request"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">resourceFieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">containerName</span>:<span style="color:#bbb"> </span>client-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">resource</span>:<span style="color:#bbb"> </span>requests.cpu<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">divisor</span>:<span style="color:#bbb"> </span>1m<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>- <span style="color:green;font-weight:700">path</span>:<span style="color:#bbb"> </span><span style="color:#b44">"mem_limit"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">resourceFieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">containerName</span>:<span style="color:#bbb"> </span>client-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">resource</span>:<span style="color:#bbb"> </span>limits.memory<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">divisor</span>:<span style="color:#bbb"> </span>1Mi<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>- <span style="color:green;font-weight:700">path</span>:<span style="color:#bbb"> </span><span style="color:#b44">"mem_request"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">resourceFieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">containerName</span>:<span style="color:#bbb"> </span>client-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">resource</span>:<span style="color:#bbb"> </span>requests.memory<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">divisor</span>:<span style="color:#bbb"> </span>1Mi<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">
</span></span></span></code></pre></div></div></div><p>In the manifest, you can see that the Pod has a
<a href="/docs/concepts/storage/volumes/#downwardapi"><code>downwardAPI</code> volume</a>,
and that the single container in that Pod mounts the volume at <code>/etc/podinfo</code>.</p><p>Look at the <code>items</code> array under <code>downwardAPI</code>. Each element of the array
defines a file in the downward API volume.</p><p>The first element specifies that in the container named <code>client-container</code>,
the value of the <code>limits.cpu</code> field in the format specified by <code>1m</code> should be
published as a file named <code>cpu_limit</code>. The <code>divisor</code> field is optional and has the
default value of <code>1</code>. A divisor of 1 means cores for <code>cpu</code> resources, or
bytes for <code>memory</code> resources.</p><p>Create the Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply -f https://k8s.io/examples/pods/inject/dapi-volume-resources.yaml
</span></span></code></pre></div><p>Get a shell into the container that is running in your Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl <span style="color:#a2f">exec</span> -it kubernetes-downwardapi-volume-example-2 -- sh
</span></span></code></pre></div><p>In your shell, view the <code>cpu_limit</code> file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Run this in a shell inside the container</span>
</span></span><span style="display:flex"><span>cat /etc/podinfo/cpu_limit
</span></span></code></pre></div><p>You can use similar commands to view the <code>cpu_request</code>, <code>mem_limit</code> and
<code>mem_request</code> files.</p><h2 id="project-keys-to-specific-paths-and-file-permissions">Project keys to specific paths and file permissions</h2><p>You can project keys to specific paths and specific permissions on a per-file
basis. For more information, see
<a href="/docs/concepts/configuration/secret/">Secrets</a>.</p><h2 id="what-s-next">What's next</h2><ul><li>Read the <a href="/docs/reference/kubernetes-api/workload-resources/pod-v1/#PodSpec"><code>spec</code></a>
API definition for Pod. This includes the definition of Container (part of Pod).</li><li>Read the list of <a href="/docs/concepts/workloads/pods/downward-api/#available-fields">available fields</a> that you
can expose using the downward API.</li></ul><p>Read about volumes in the legacy API reference:</p><ul><li>Check the <a href="/docs/reference/generated/kubernetes-api/v1.34/#volume-v1-core"><code>Volume</code></a>
API definition which defines a generic volume in a Pod for containers to access.</li><li>Check the <a href="/docs/reference/generated/kubernetes-api/v1.34/#downwardapivolumesource-v1-core"><code>DownwardAPIVolumeSource</code></a>
API definition which defines a volume that contains Downward API information.</li><li>Check the <a href="/docs/reference/generated/kubernetes-api/v1.34/#downwardapivolumefile-v1-core"><code>DownwardAPIVolumeFile</code></a>
API definition which contains references to object or resource fields for
populating a file in the Downward API volume.</li><li>Check the <a href="/docs/reference/generated/kubernetes-api/v1.34/#resourcefieldselector-v1-core"><code>ResourceFieldSelector</code></a>
API definition which specifies the container resources and their output format.</li></ul></div>
<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Define Dependent Environment Variables</h1><p>This page shows how to define dependent environment variables for a container
in a Kubernetes Pod.</p><h2 id="before-you-begin">Before you begin</h2><p>You need to have a Kubernetes cluster, and the kubectl command-line tool must
be configured to communicate with your cluster. It is recommended to run this tutorial on a cluster with at least two nodes that are not acting as control plane hosts. If you do not already have a
cluster, you can create one by using
<a href="https://minikube.sigs.k8s.io/docs/tutorials/multi_node/">minikube</a>
or you can use one of these Kubernetes playgrounds:</p><ul><li><a href="https://labs.iximiuz.com/playgrounds?category=kubernetes&amp;filter=all">iximiuz Labs</a></li><li><a href="https://killercoda.com/playgrounds/scenario/kubernetes">Killercoda</a></li><li><a href="https://kodekloud.com/public-playgrounds">KodeKloud</a></li><li><a href="https://labs.play-with-k8s.com/">Play with Kubernetes</a></li></ul><h2 id="define-an-environment-dependent-variable-for-a-container">Define an environment dependent variable for a container</h2><p>When you create a Pod, you can set dependent environment variables for the containers that run in the Pod. To set dependent environment variables, you can use $(VAR_NAME) in the <code>value</code> of <code>env</code> in the configuration file.</p><p>In this exercise, you create a Pod that runs one container. The configuration
file for the Pod defines a dependent environment variable with common usage defined. Here is the configuration manifest for the
Pod:</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/pods/inject/dependent-envars.yaml" download="pods/inject/dependent-envars.yaml"><code>pods/inject/dependent-envars.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;pods-inject-dependent-envars-yaml&quot;)" title="Copy pods/inject/dependent-envars.yaml to clipboard"/></div><div class="includecode" id="pods-inject-dependent-envars-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>dependent-envars-demo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>dependent-envars-demo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">args</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- while true; do echo -en '\n'; printf UNCHANGED_REFERENCE=$UNCHANGED_REFERENCE'\n'; printf SERVICE_ADDRESS=$SERVICE_ADDRESS'\n';printf ESCAPED_REFERENCE=$ESCAPED_REFERENCE'\n'; sleep 30; done;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">command</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- sh<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- -c<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>busybox:1.28<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">env</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>SERVICE_PORT<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"80"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>SERVICE_IP<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"172.17.0.1"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>UNCHANGED_REFERENCE<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"$(PROTOCOL)://$(SERVICE_IP):$(SERVICE_PORT)"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>PROTOCOL<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"https"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>SERVICE_ADDRESS<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"$(PROTOCOL)://$(SERVICE_IP):$(SERVICE_PORT)"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>ESCAPED_REFERENCE<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"$$(PROTOCOL)://$(SERVICE_IP):$(SERVICE_PORT)"</span><span style="color:#bbb">
</span></span></span></code></pre></div></div></div><ol><li><p>Create a Pod based on that manifest:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply -f https://k8s.io/examples/pods/inject/dependent-envars.yaml
</span></span></code></pre></div><pre tabindex="0"><code>pod/dependent-envars-demo created
</code></pre></li><li><p>List the running Pods:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get pods dependent-envars-demo
</span></span></code></pre></div><pre tabindex="0"><code>NAME                      READY     STATUS    RESTARTS   AGE
dependent-envars-demo     1/1       Running   0          9s
</code></pre></li><li><p>Check the logs for the container running in your Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl logs pod/dependent-envars-demo
</span></span></code></pre></div><pre tabindex="0"><code>
UNCHANGED_REFERENCE=$(PROTOCOL)://172.17.0.1:80
SERVICE_ADDRESS=https://172.17.0.1:80
ESCAPED_REFERENCE=$(PROTOCOL)://172.17.0.1:80
</code></pre></li></ol><p>As shown above, you have defined the correct dependency reference of <code>SERVICE_ADDRESS</code>, bad dependency reference of <code>UNCHANGED_REFERENCE</code> and skip dependent references of <code>ESCAPED_REFERENCE</code>.</p><p>When an environment variable is already defined when being referenced,
the reference can be correctly resolved, such as in the <code>SERVICE_ADDRESS</code> case.</p><p>Note that order matters in the <code>env</code> list. An environment variable is not considered
"defined" if it is specified further down the list. That is why <code>UNCHANGED_REFERENCE</code>
fails to resolve <code>$(PROTOCOL)</code> in the example above.</p><p>When the environment variable is undefined or only includes some variables, the undefined environment variable is treated as a normal string, such as <code>UNCHANGED_REFERENCE</code>. Note that incorrectly parsed environment variables, in general, will not block the container from starting.</p><p>The <code>$(VAR_NAME)</code> syntax can be escaped with a double <code>$</code>, ie: <code>$$(VAR_NAME)</code>.
Escaped references are never expanded, regardless of whether the referenced variable
is defined or not. This can be seen from the <code>ESCAPED_REFERENCE</code> case above.</p><h2 id="what-s-next">What's next</h2><ul><li>Learn more about <a href="/docs/tasks/inject-data-application/environment-variable-expose-pod-information/">environment variables</a>.</li><li>See <a href="/docs/reference/generated/kubernetes-api/v1.34/#envvarsource-v1-core">EnvVarSource</a>.</li></ul></div>
<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Expose Pod Information to Containers Through Environment Variables</h1><p>This page shows how a Pod can use environment variables to expose information
about itself to containers running in the Pod, using the <em>downward API</em>.
You can use environment variables to expose Pod fields, container fields, or both.</p><p>In Kubernetes, there are two ways to expose Pod and container fields to a running container:</p><ul><li><em>Environment variables</em>, as explained in this task</li><li><a href="/docs/tasks/inject-data-application/downward-api-volume-expose-pod-information/">Volume files</a></li></ul><p>Together, these two ways of exposing Pod and container fields are called the
downward API.</p><p>As Services are the primary mode of communication between containerized applications managed by Kubernetes,
it is helpful to be able to discover them at runtime.</p><p>Read more about accessing Services <a href="/docs/tutorials/services/connect-applications-service/#accessing-the-service">here</a>.</p><h2 id="before-you-begin">Before you begin</h2><p>You need to have a Kubernetes cluster, and the kubectl command-line tool must
be configured to communicate with your cluster. It is recommended to run this tutorial on a cluster with at least two nodes that are not acting as control plane hosts. If you do not already have a
cluster, you can create one by using
<a href="https://minikube.sigs.k8s.io/docs/tutorials/multi_node/">minikube</a>
or you can use one of these Kubernetes playgrounds:</p><ul><li><a href="https://labs.iximiuz.com/playgrounds?category=kubernetes&amp;filter=all">iximiuz Labs</a></li><li><a href="https://killercoda.com/playgrounds/scenario/kubernetes">Killercoda</a></li><li><a href="https://kodekloud.com/public-playgrounds">KodeKloud</a></li><li><a href="https://labs.play-with-k8s.com/">Play with Kubernetes</a></li></ul><h2 id="use-pod-fields-as-values-for-environment-variables">Use Pod fields as values for environment variables</h2><p>In this part of exercise, you create a Pod that has one container, and you
project Pod-level fields into the running container as environment variables.</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/pods/inject/dapi-envars-pod.yaml" download="pods/inject/dapi-envars-pod.yaml"><code>pods/inject/dapi-envars-pod.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;pods-inject-dapi-envars-pod-yaml&quot;)" title="Copy pods/inject/dapi-envars-pod.yaml to clipboard"/></div><div class="includecode" id="pods-inject-dapi-envars-pod-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>dapi-envars-fieldref<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>test-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>registry.k8s.io/busybox:1.27.2<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">command</span>:<span style="color:#bbb"> </span>[<span style="color:#bbb"> </span><span style="color:#b44">"sh"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"-c"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">args</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span>- while true; do<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>echo -en '\n';<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>printenv MY_NODE_NAME MY_POD_NAME MY_POD_NAMESPACE;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>printenv MY_POD_IP MY_POD_SERVICE_ACCOUNT;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>sleep 10;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>done;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">env</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MY_NODE_NAME<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">fieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">fieldPath</span>:<span style="color:#bbb"> </span>spec.nodeName<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MY_POD_NAME<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">fieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">fieldPath</span>:<span style="color:#bbb"> </span>metadata.name<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MY_POD_NAMESPACE<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">fieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">fieldPath</span>:<span style="color:#bbb"> </span>metadata.namespace<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MY_POD_IP<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">fieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">fieldPath</span>:<span style="color:#bbb"> </span>status.podIP<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MY_POD_SERVICE_ACCOUNT<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">fieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">fieldPath</span>:<span style="color:#bbb"> </span>spec.serviceAccountName<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">restartPolicy</span>:<span style="color:#bbb"> </span>Never<span style="color:#bbb">
</span></span></span></code></pre></div></div></div><p>In that manifest, you can see five environment variables. The <code>env</code>
field is an array of
environment variable definitions.
The first element in the array specifies that the <code>MY_NODE_NAME</code> environment
variable gets its value from the Pod's <code>spec.nodeName</code> field. Similarly, the
other environment variables get their names from Pod fields.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>The fields in this example are Pod fields. They are not fields of the
container in the Pod.</div><p>Create the Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply -f https://k8s.io/examples/pods/inject/dapi-envars-pod.yaml
</span></span></code></pre></div><p>Verify that the container in the Pod is running:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># If the new Pod isn't yet healthy, rerun this command a few times.</span>
</span></span><span style="display:flex"><span>kubectl get pods
</span></span></code></pre></div><p>View the container's logs:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl logs dapi-envars-fieldref
</span></span></code></pre></div><p>The output shows the values of selected environment variables:</p><pre tabindex="0"><code>minikube
dapi-envars-fieldref
default
172.17.0.4
default
</code></pre><p>To see why these values are in the log, look at the <code>command</code> and <code>args</code> fields
in the configuration file. When the container starts, it writes the values of
five environment variables to stdout. It repeats this every ten seconds.</p><p>Next, get a shell into the container that is running in your Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl <span style="color:#a2f">exec</span> -it dapi-envars-fieldref -- sh
</span></span></code></pre></div><p>In your shell, view the environment variables:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Run this in a shell inside the container</span>
</span></span><span style="display:flex"><span>printenv
</span></span></code></pre></div><p>The output shows that certain environment variables have been assigned the
values of Pod fields:</p><pre tabindex="0"><code>MY_POD_SERVICE_ACCOUNT=default
...
MY_POD_NAMESPACE=default
MY_POD_IP=172.17.0.4
...
MY_NODE_NAME=minikube
...
MY_POD_NAME=dapi-envars-fieldref
</code></pre><h2 id="use-container-fields-as-values-for-environment-variables">Use container fields as values for environment variables</h2><p>In the preceding exercise, you used information from Pod-level fields as the values
for environment variables.
In this next exercise, you are going to pass fields that are part of the Pod
definition, but taken from the specific
<a href="/docs/reference/kubernetes-api/workload-resources/pod-v1/#Container">container</a>
rather than from the Pod overall.</p><p>Here is a manifest for another Pod that again has just one container:</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/pods/inject/dapi-envars-container.yaml" download="pods/inject/dapi-envars-container.yaml"><code>pods/inject/dapi-envars-container.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;pods-inject-dapi-envars-container-yaml&quot;)" title="Copy pods/inject/dapi-envars-container.yaml to clipboard"/></div><div class="includecode" id="pods-inject-dapi-envars-container-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>dapi-envars-resourcefieldref<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>test-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>registry.k8s.io/busybox:1.27.2<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">command</span>:<span style="color:#bbb"> </span>[<span style="color:#bbb"> </span><span style="color:#b44">"sh"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"-c"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">args</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span>- while true; do<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>echo -en '\n';<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>printenv MY_CPU_REQUEST MY_CPU_LIMIT;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>printenv MY_MEM_REQUEST MY_MEM_LIMIT;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>sleep 10;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>done;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">resources</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">requests</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">memory</span>:<span style="color:#bbb"> </span><span style="color:#b44">"32Mi"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">cpu</span>:<span style="color:#bbb"> </span><span style="color:#b44">"125m"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">limits</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">memory</span>:<span style="color:#bbb"> </span><span style="color:#b44">"64Mi"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">cpu</span>:<span style="color:#bbb"> </span><span style="color:#b44">"250m"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">env</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MY_CPU_REQUEST<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">resourceFieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">containerName</span>:<span style="color:#bbb"> </span>test-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">resource</span>:<span style="color:#bbb"> </span>requests.cpu<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MY_CPU_LIMIT<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">resourceFieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">containerName</span>:<span style="color:#bbb"> </span>test-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">resource</span>:<span style="color:#bbb"> </span>limits.cpu<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MY_MEM_REQUEST<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">resourceFieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">containerName</span>:<span style="color:#bbb"> </span>test-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">resource</span>:<span style="color:#bbb"> </span>requests.memory<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MY_MEM_LIMIT<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">resourceFieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">containerName</span>:<span style="color:#bbb"> </span>test-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">resource</span>:<span style="color:#bbb"> </span>limits.memory<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">restartPolicy</span>:<span style="color:#bbb"> </span>Never<span style="color:#bbb">
</span></span></span></code></pre></div></div></div><p>In this manifest, you can see four environment variables. The <code>env</code>
field is an array of
environment variable definitions.
The first element in the array specifies that the <code>MY_CPU_REQUEST</code> environment
variable gets its value from the <code>requests.cpu</code> field of a container named
<code>test-container</code>. Similarly, the other environment variables get their values
from fields that are specific to this container.</p><p>Create the Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply -f https://k8s.io/examples/pods/inject/dapi-envars-container.yaml
</span></span></code></pre></div><p>Verify that the container in the Pod is running:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># If the new Pod isn't yet healthy, rerun this command a few times.</span>
</span></span><span style="display:flex"><span>kubectl get pods
</span></span></code></pre></div><p>View the container's logs:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl logs dapi-envars-resourcefieldref
</span></span></code></pre></div><p>The output shows the values of selected environment variables:</p><pre tabindex="0"><code>1
1
33554432
67108864
</code></pre><h2 id="what-s-next">What's next</h2><ul><li>Read <a href="/docs/tasks/inject-data-application/define-environment-variable-container/">Defining Environment Variables for a Container</a></li><li>Read the <a href="/docs/reference/kubernetes-api/workload-resources/pod-v1/#PodSpec"><code>spec</code></a>
API definition for Pod. This includes the definition of Container (part of Pod).</li><li>Read the list of <a href="/docs/concepts/workloads/pods/downward-api/#available-fields">available fields</a> that you
can expose using the downward API.</li></ul><p>Read about Pods, containers and environment variables in the legacy API reference:</p><ul><li><a href="/docs/reference/generated/kubernetes-api/v1.34/#podspec-v1-core">PodSpec</a></li><li><a href="/docs/reference/generated/kubernetes-api/v1.34/#container-v1-core">Container</a></li><li><a href="/docs/reference/generated/kubernetes-api/v1.34/#envvar-v1-core">EnvVar</a></li><li><a href="/docs/reference/generated/kubernetes-api/v1.34/#envvarsource-v1-core">EnvVarSource</a></li><li><a href="/docs/reference/generated/kubernetes-api/v1.34/#objectfieldselector-v1-core">ObjectFieldSelector</a></li><li><a href="/docs/reference/generated/kubernetes-api/v1.34/#resourcefieldselector-v1-core">ResourceFieldSelector</a></li></ul></div>
<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Define Environment Variable Values Using An Init Container</h1><div class="feature-state-notice feature-alpha" title="Feature Gate: EnvFiles"><span class="feature-state-name">FEATURE STATE:</span>
<code>Kubernetes v1.34 [alpha]</code> (enabled by default: false)</div><p>This page show how to configure environment variables for containers in a Pod via file.</p><h2 id="before-you-begin">Before you begin</h2><p>You need to have a Kubernetes cluster, and the kubectl command-line tool must
be configured to communicate with your cluster. It is recommended to run this tutorial on a cluster with at least two nodes that are not acting as control plane hosts. If you do not already have a
cluster, you can create one by using
<a href="https://minikube.sigs.k8s.io/docs/tutorials/multi_node/">minikube</a>
or you can use one of these Kubernetes playgrounds:</p><ul><li><a href="https://labs.iximiuz.com/playgrounds?category=kubernetes&amp;filter=all">iximiuz Labs</a></li><li><a href="https://killercoda.com/playgrounds/scenario/kubernetes">Killercoda</a></li><li><a href="https://kodekloud.com/public-playgrounds">KodeKloud</a></li><li><a href="https://labs.play-with-k8s.com/">Play with Kubernetes</a></li></ul><p>Your Kubernetes server must be version v1.34.</p><p>To check the version, enter <code>kubectl version</code>.</p><h2 id="how-the-design-works">How the design works</h2><p>In this exercise, you will create a Pod that sources environment variables from files,
projecting these values into the running container.</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/pods/inject/envars-file-container.yaml" download="pods/inject/envars-file-container.yaml"><code>pods/inject/envars-file-container.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;pods-inject-envars-file-container-yaml&quot;)" title="Copy pods/inject/envars-file-container.yaml to clipboard"/></div><div class="includecode" id="pods-inject-envars-file-container-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>envfile-test-pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">initContainers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>setup-envfile<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb">  </span>nginx<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">command</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">'sh'</span>,<span style="color:#bbb"> </span><span style="color:#b44">'-c'</span>,<span style="color:#bbb"> </span><span style="color:#b44">'echo "DB_ADDRESS=address\nREST_ENDPOINT=endpoint" &gt; /data/config.env'</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">volumeMounts</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>config<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">mountPath</span>:<span style="color:#bbb"> </span>/data<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>use-envfile<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>nginx<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">command</span>:<span style="color:#bbb"> </span>[<span style="color:#bbb"> </span><span style="color:#b44">"/bin/sh"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"-c"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"env"</span><span style="color:#bbb"> </span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">env</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>DB_ADDRESS<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">fileKeyRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">path</span>:<span style="color:#bbb"> </span>config.env<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">volumeName</span>:<span style="color:#bbb"> </span>config<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">key</span>:<span style="color:#bbb"> </span>DB_ADDRESS<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">optional</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:700">false</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">restartPolicy</span>:<span style="color:#bbb"> </span>Never<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">volumes</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>config<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">emptyDir</span>:<span style="color:#bbb"> </span>{}</span></span></code></pre></div></div></div><p>In this manifest, you can see the <code>initContainer</code> mounts an <code>emptyDir</code> volume and writes environment variables to a file within it,
and the regular containers reference both the file and the environment variable key
through the <code>fileKeyRef</code> field without needing to mount the volume.
When <code>optional</code> field is set to false, the specified <code>key</code> in <code>fileKeyRef</code> must exist in the environment variables file.</p><p>The volume will only be mounted to the container that writes to the file
(<code>initContainer</code>), while the consumer container that consumes the environment variable will not have the volume mounted.</p><p>The env file format adheres to the <a href="/docs/tasks/inject-data-application/define-environment-variable-via-file/#env-file-syntax">kubernetes env file standard</a>.</p><p>During container initialization, the kubelet retrieves environment variables
from specified files in the <code>emptyDir</code> volume and exposes them to the container.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4><p>All container types (initContainers, regular containers, sidecars containers,
and ephemeral containers) support environment variable loading from files.</p><p>While these environment variables can store sensitive information,
<code>emptyDir</code> volumes don't provide the same protection mechanisms as
dedicated Secret objects. Therefore, exposing confidential environment variables
to containers through this feature is not considered a security best practice.</p></div><p>Create the Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply -f https://k8s.io/examples/pods/inject/envars-file-container.yaml
</span></span></code></pre></div><p>Verify that the container in the Pod is running:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># If the new Pod isn't yet healthy, rerun this command a few times.</span>
</span></span><span style="display:flex"><span>kubectl get pods
</span></span></code></pre></div><p>Check container logs for environment variables:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl logs dapi-test-pod -c use-envfile | grep DB_ADDRESS
</span></span></code></pre></div><p>The output shows the values of selected environment variables:</p><pre tabindex="0"><code>DB_ADDRESS=address
</code></pre><h2 id="env-file-syntax">Env File Syntax</h2><p>The format of Kubernetes env files originates from <code>.env</code> files.</p><p>In a shell environment, <code>.env</code> files are typically loaded using the <code>source .env</code> command.</p><p>For Kubernetes, the defined env file format adheres to stricter syntax rules:</p><ul><li><p>Blank Lines: Blank lines are ignored.</p></li><li><p>Leading Spaces: Leading spaces on all lines are ignored.</p></li><li><p>Variable Declaration: Variables must be declared as <code>VAR=VAL</code>. Spaces surrounding <code>=</code> and trailing spaces are ignored.</p><pre tabindex="0"><code>VAR=VAL  VAL
</code></pre></li><li><p>Comments: Lines beginning with # are treated as comments and ignored.</p><pre tabindex="0"><code># comment
VAR=VAL  VAL

VAR=VAL # not a comment  VAL # not a comment
</code></pre></li><li><p>Line Continuation: A backslash (<code>\</code>) at the end of a variable declaration line indicates the value continues on the next line. The lines are joined with a single space.</p><pre tabindex="0"><code>VAR=VAL \
VAL2
 VAL VAL2
</code></pre></li></ul><h2 id="what-s-next">What's next</h2><ul><li>Learn more about <a href="/docs/tasks/inject-data-application/environment-variable-expose-pod-information/">environment variables</a>.</li><li>Read <a href="/docs/tasks/inject-data-application/define-environment-variable-container/">Defining Environment Variables for a Container</a></li><li>Read <a href="/docs/tasks/inject-data-application/environment-variable-expose-pod-information/">Expose Pod Information to Containers Through Environment Variables</a></li></ul></div>
<hr>
<div class="td-content"><h1 data-pagefind-weight="10">Define Environment Variables for a Container</h1><p>This page shows how to define environment variables for a container
in a Kubernetes Pod.</p><h2 id="before-you-begin">Before you begin</h2><p>You need to have a Kubernetes cluster, and the kubectl command-line tool must
be configured to communicate with your cluster. It is recommended to run this tutorial on a cluster with at least two nodes that are not acting as control plane hosts. If you do not already have a
cluster, you can create one by using
<a href="https://minikube.sigs.k8s.io/docs/tutorials/multi_node/">minikube</a>
or you can use one of these Kubernetes playgrounds:</p><ul><li><a href="https://labs.iximiuz.com/playgrounds?category=kubernetes&amp;filter=all">iximiuz Labs</a></li><li><a href="https://killercoda.com/playgrounds/scenario/kubernetes">Killercoda</a></li><li><a href="https://kodekloud.com/public-playgrounds">KodeKloud</a></li><li><a href="https://labs.play-with-k8s.com/">Play with Kubernetes</a></li></ul><h2 id="define-an-environment-variable-for-a-container">Define an environment variable for a container</h2><p>When you create a Pod, you can set environment variables for the containers
that run in the Pod. To set environment variables, include the <code>env</code> or
<code>envFrom</code> field in the configuration file.</p><p>The <code>env</code> and <code>envFrom</code> fields have different effects.</p><dl><dt><code>env</code></dt><dd>allows you to set environment variables for a container, specifying a value directly for each variable that you name.</dd><dt><code>envFrom</code></dt><dd>allows you to set environment variables for a container by referencing either a ConfigMap or a Secret.
When you use <code>envFrom</code>, all the key-value pairs in the referenced ConfigMap or Secret
are set as environment variables for the container.
You can also specify a common prefix string.</dd></dl><p>You can read more about <a href="/docs/tasks/configure-pod-container/configure-pod-configmap/#configure-all-key-value-pairs-in-a-configmap-as-container-environment-variables">ConfigMap</a>
and <a href="/docs/tasks/inject-data-application/distribute-credentials-secure/#configure-all-key-value-pairs-in-a-secret-as-container-environment-variables">Secret</a>.</p><p>This page explains how to use <code>env</code>.</p><p>In this exercise, you create a Pod that runs one container. The configuration
file for the Pod defines an environment variable with name <code>DEMO_GREETING</code> and
value <code>"Hello from the environment"</code>. Here is the configuration manifest for the
Pod:</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/pods/inject/envars.yaml" download="pods/inject/envars.yaml"><code>pods/inject/envars.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;pods-inject-envars-yaml&quot;)" title="Copy pods/inject/envars.yaml to clipboard"/></div><div class="includecode" id="pods-inject-envars-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>envar-demo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">labels</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">purpose</span>:<span style="color:#bbb"> </span>demonstrate-envars<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>envar-demo-container<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>gcr.io/google-samples/hello-app:2.0<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">env</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>DEMO_GREETING<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"Hello from the environment"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>DEMO_FAREWELL<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"Such a sweet sorrow"</span><span style="color:#bbb">
</span></span></span></code></pre></div></div></div><ol><li><p>Create a Pod based on that manifest:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply -f https://k8s.io/examples/pods/inject/envars.yaml
</span></span></code></pre></div></li><li><p>List the running Pods:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get pods -l <span style="color:#b8860b">purpose</span><span style="color:#666">=</span>demonstrate-envars
</span></span></code></pre></div><p>The output is similar to:</p><pre tabindex="0"><code>NAME            READY     STATUS    RESTARTS   AGE
envar-demo      1/1       Running   0          9s
</code></pre></li><li><p>List the Pod's container environment variables:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl <span style="color:#a2f">exec</span> envar-demo -- printenv
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>NODE_VERSION=4.4.2
EXAMPLE_SERVICE_PORT_8080_TCP_ADDR=10.3.245.237
HOSTNAME=envar-demo
...
DEMO_GREETING=Hello from the environment
DEMO_FAREWELL=Such a sweet sorrow
</code></pre></li></ol><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>The environment variables set using the <code>env</code> or <code>envFrom</code> field
override any environment variables specified in the container image.</div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>Environment variables may reference each other, however ordering is important.
Variables making use of others defined in the same context must come later in
the list. Similarly, avoid circular references.</div><h2 id="using-environment-variables-inside-of-your-config">Using environment variables inside of your config</h2><p>Environment variables that you define in a Pod's configuration under
<code>.spec.containers[*].env[*]</code> can be used elsewhere in the configuration, for
example in commands and arguments that you set for the Pod's containers.
In the example configuration below, the <code>GREETING</code>, <code>HONORIFIC</code>, and
<code>NAME</code> environment variables are set to <code>Warm greetings to</code>, <code>The Most Honorable</code>, and <code>Kubernetes</code>, respectively. The environment variable
<code>MESSAGE</code> combines the set of all these environment variables and then uses it
as a CLI argument passed to the <code>env-print-demo</code> container.</p><p>Environment variable names may consist of any <a href="https://www.ascii-code.com/characters/printable-characters">printable ASCII characters</a> except '='.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>print-greeting<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>env-print-demo<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>bash<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">env</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>GREETING<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"Warm greetings to"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>HONORIFIC<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"The Most Honorable"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>NAME<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"Kubernetes"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MESSAGE<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"$(GREETING) $(HONORIFIC) $(NAME)"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">command</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"echo"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">args</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"$(MESSAGE)"</span>]<span style="color:#bbb">
</span></span></span></code></pre></div><p>Upon creation, the command <code>echo Warm greetings to The Most Honorable Kubernetes</code> is run on the container.</p><h2 id="what-s-next">What's next</h2><ul><li>Learn more about <a href="/docs/tasks/inject-data-application/environment-variable-expose-pod-information/">environment variables</a>.</li><li>Learn about <a href="/docs/concepts/configuration/secret/#using-secrets-as-environment-variables">using secrets as environment variables</a>.</li><li>See <a href="/docs/reference/generated/kubernetes-api/v1.34/#envvarsource-v1-core">EnvVarSource</a>.</li></ul></div>