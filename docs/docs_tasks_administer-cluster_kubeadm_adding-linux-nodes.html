<div class="td-content"><h1 data-pagefind-weight="10">Adding Linux worker nodes</h1><p>This page explains how to add Linux worker nodes to a kubeadm cluster.</p><h2 id="before-you-begin">Before you begin</h2><ul><li>Each joining worker node has installed the required components from
<a href="/docs/setup/production-environment/tools/kubeadm/install-kubeadm/">Installing kubeadm</a>, such as,
kubeadm, the kubelet and a <a class="glossary-tooltip" title="The container runtime is the software that is responsible for running containers." data-toggle="tooltip" data-placement="top" href="/docs/setup/production-environment/container-runtimes" target="_blank" aria-label="container runtime">container runtime</a>.</li><li>A running kubeadm cluster created by <code>kubeadm init</code> and following the steps
in the document <a href="/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/">Creating a cluster with kubeadm</a>.</li><li>You need superuser access to the node.</li></ul><h2 id="adding-linux-worker-nodes">Adding Linux worker nodes</h2><p>To add new Linux worker nodes to your cluster do the following for each machine:</p><ol><li>Connect to the machine by using SSH or another method.</li><li>Run the command that was output by <code>kubeadm init</code>. For example:</li></ol><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo kubeadm join --token &lt;token&gt; &lt;control-plane-host&gt;:&lt;control-plane-port&gt; --discovery-token-ca-cert-hash sha256:&lt;hash&gt;
</span></span></code></pre></div><h3 id="additional-information-for-kubeadm-join">Additional information for kubeadm join</h3><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>To specify an IPv6 tuple for <code>&lt;control-plane-host&gt;:&lt;control-plane-port&gt;</code>, IPv6 address must be enclosed in square brackets, for example: <code>[2001:db8::101]:2073</code>.</div><p>If you do not have the token, you can get it by running the following command on the control plane node:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Run this on a control plane node</span>
</span></span><span style="display:flex"><span>sudo kubeadm token list
</span></span></code></pre></div><p>The output is similar to this:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console"><span style="display:flex"><span><span style="color:#888">TOKEN                    TTL  EXPIRES              USAGES           DESCRIPTION            EXTRA GROUPS
</span></span></span><span style="display:flex"><span><span style="color:#888">8ewj1p.9r9hcjoqgajrj4gi  23h  2018-06-12T02:51:28Z authentication,  The default bootstrap  system:
</span></span></span><span style="display:flex"><span><span style="color:#888">                                                   signing          token generated by     bootstrappers:
</span></span></span><span style="display:flex"><span><span style="color:#888">                                                                    'kubeadm init'.        kubeadm:
</span></span></span><span style="display:flex"><span><span style="color:#888">                                                                                           default-node-token
</span></span></span></code></pre></div><p>By default, node join tokens expire after 24 hours. If you are joining a node to the cluster after the
current token has expired, you can create a new token by running the following command on the
control plane node:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Run this on a control plane node</span>
</span></span><span style="display:flex"><span>sudo kubeadm token create
</span></span></code></pre></div><p>The output is similar to this:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console"><span style="display:flex"><span><span style="color:#888">5didvk.d09sbcov8ph2amjw
</span></span></span></code></pre></div><p>To print a kubeadm join command while also generating a new token you can use:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span>sudo kubeadm token create --print-join-command
</span></span></code></pre></div><p>If you don't have the value of <code>--discovery-token-ca-cert-hash</code>, you can get it by running the
following commands on the control plane node:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Run this on a control plane node</span>
</span></span><span style="display:flex"><span>sudo cat /etc/kubernetes/pki/ca.crt | openssl x509 -pubkey  | openssl rsa -pubin -outform der 2&gt;/dev/null | <span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>   openssl dgst -sha256 -hex | sed <span style="color:#b44">'s/^.* //'</span>
</span></span></code></pre></div><p>The output is similar to:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console"><span style="display:flex"><span><span style="color:#888">8cb2de97839780a412b93877f8507ad6c94f73add17d5d7058e91741c9d5ec78
</span></span></span></code></pre></div><p>The output of the <code>kubeadm join</code> command should look something like:</p><pre tabindex="0"><code>[preflight] Running pre-flight checks

... (log output of join workflow) ...

Node join complete:
* Certificate signing request sent to control-plane and response
  received.
* Kubelet informed of new secure connection details.

Run 'kubectl get nodes' on control-plane to see this machine join.
</code></pre><p>A few seconds later, you should notice this node in the output from <code>kubectl get nodes</code>.
(for example, run <code>kubectl</code> on a control plane node).</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>As the cluster nodes are usually initialized sequentially, the CoreDNS Pods are likely to all run
on the first control plane node. To provide higher availability, please rebalance the CoreDNS Pods
with <code>kubectl -n kube-system rollout restart deployment coredns</code> after at least one new node is joined.</div><h2 id="what-s-next">What's next</h2><ul><li>See how to <a href="/docs/tasks/administer-cluster/kubeadm/adding-windows-nodes/">add Windows worker nodes</a>.</li></ul></div>