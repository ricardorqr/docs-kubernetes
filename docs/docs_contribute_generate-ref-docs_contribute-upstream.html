<div class="td-content"><h1 data-pagefind-weight="10">Contributing to the Upstream Kubernetes Code</h1><p>This page shows how to contribute to the upstream <code>kubernetes/kubernetes</code> project.
You can fix bugs found in the Kubernetes API documentation or the content of
the Kubernetes components such as <code>kubeadm</code>, <code>kube-apiserver</code>, and <code>kube-controller-manager</code>.</p><p>If you instead want to regenerate the reference documentation for the Kubernetes
API or the <code>kube-*</code> components from the upstream code, see the following instructions:</p><ul><li><a href="/docs/contribute/generate-ref-docs/kubernetes-api/">Generating Reference Documentation for the Kubernetes API</a></li><li><a href="/docs/contribute/generate-ref-docs/kubernetes-components/">Generating Reference Documentation for the Kubernetes Components and Tools</a></li></ul><h2 id="before-you-begin">Before you begin</h2><ul><li><p>You need to have these tools installed:</p><ul><li><a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">Git</a></li><li><a href="https://go.dev/doc/install">Golang</a> version 1.13+</li><li><a href="https://docs.docker.com/engine/installation/">Docker</a></li><li><a href="https://github.com/coreos/etcd/">etcd</a></li><li><a href="https://www.gnu.org/software/make/">make</a></li><li><a href="https://gcc.gnu.org/">gcc compiler/linker</a></li></ul></li><li><p>Your <code>GOPATH</code> environment variable must be set, and the location of <code>etcd</code>
must be in your <code>PATH</code> environment variable.</p></li><li><p>You need to know how to create a pull request to a GitHub repository.
Typically, this involves creating a fork of the repository.
For more information, see <a href="https://help.github.com/articles/creating-a-pull-request/">Creating a Pull Request</a>
and <a href="https://gist.github.com/Chaser324/ce0505fbed06b947d962">GitHub Standard Fork &amp; Pull Request Workflow</a>.</p></li></ul><h2 id="the-big-picture">The big picture</h2><p>The reference documentation for the Kubernetes API and the <code>kube-*</code> components
such as <code>kube-apiserver</code>, <code>kube-controller-manager</code> are automatically generated
from the source code in the <a href="https://github.com/kubernetes/kubernetes/">upstream Kubernetes</a>.</p><p>When you see bugs in the generated documentation, you may want to consider
creating a patch to fix it in the upstream project.</p><h2 id="clone-the-kubernetes-repository">Clone the Kubernetes repository</h2><p>If you don't already have the kubernetes/kubernetes repository, get it now:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>mkdir <span style="color:#b8860b">$GOPATH</span>/src
</span></span><span style="display:flex"><span><span style="color:#a2f">cd</span> <span style="color:#b8860b">$GOPATH</span>/src
</span></span><span style="display:flex"><span>go get github.com/kubernetes/kubernetes
</span></span></code></pre></div><p>Determine the base directory of your clone of the
<a href="https://github.com/kubernetes/kubernetes">kubernetes/kubernetes</a> repository.
For example, if you followed the preceding step to get the repository, your
base directory is <code>$GOPATH/src/github.com/kubernetes/kubernetes</code>.
The remaining steps refer to your base directory as <code>&lt;k8s-base&gt;</code>.</p><p>Determine the base directory of your clone of the
<a href="https://github.com/kubernetes-sigs/reference-docs">kubernetes-sigs/reference-docs</a> repository.
For example, if you followed the preceding step to get the repository, your
base directory is <code>$GOPATH/src/github.com/kubernetes-sigs/reference-docs</code>.
The remaining steps refer to your base directory as <code>&lt;rdocs-base&gt;</code>.</p><h2 id="edit-the-kubernetes-source-code">Edit the Kubernetes source code</h2><p>The Kubernetes API reference documentation is automatically generated from
an OpenAPI spec, which is generated from the Kubernetes source code. If you
want to change the API reference documentation, the first step is to change one
or more comments in the Kubernetes source code.</p><p>The documentation for the <code>kube-*</code> components is also generated from the upstream
source code. You must change the code related to the component
you want to fix in order to fix the generated documentation.</p><h3 id="make-changes-to-the-upstream-source-code">Make changes to the upstream source code</h3><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>The following steps are an example, not a general procedure. Details
will be different in your situation.</div><p>Here's an example of editing a comment in the Kubernetes source code.</p><p>In your local kubernetes/kubernetes repository, check out the default branch,
and make sure it is up to date:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#a2f">cd</span> &lt;k8s-base&gt;
</span></span><span style="display:flex"><span>git checkout master
</span></span><span style="display:flex"><span>git pull https://github.com/kubernetes/kubernetes master
</span></span></code></pre></div><p>Suppose this source file in that default branch has the typo "atmost":</p><p><a href="https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/api/apps/v1/types.go">kubernetes/kubernetes/staging/src/k8s.io/api/apps/v1/types.go</a></p><p>In your local environment, open <code>types.go</code>, and change "atmost" to "at most".</p><p>Verify that you have changed the file:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>git status
</span></span></code></pre></div><p>The output shows that you are on the master branch, and that the <code>types.go</code>
source file has been modified:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>On branch master
</span></span><span style="display:flex"><span>...
</span></span><span style="display:flex"><span>    modified:   staging/src/k8s.io/api/apps/v1/types.go
</span></span></code></pre></div><h3 id="commit-your-edited-file">Commit your edited file</h3><p>Run <code>git add</code> and <code>git commit</code> to commit the changes you have made so far. In the next step,
you will do a second commit. It is important to keep your changes separated into two commits.</p><h3 id="generate-the-openapi-spec-and-related-files">Generate the OpenAPI spec and related files</h3><p>Go to <code>&lt;k8s-base&gt;</code> and run these scripts:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>./hack/update-codegen.sh
</span></span><span style="display:flex"><span>./hack/update-openapi-spec.sh
</span></span></code></pre></div><p>Run <code>git status</code> to see what was generated.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>On branch master
</span></span><span style="display:flex"><span>...
</span></span><span style="display:flex"><span>    modified:   api/openapi-spec/swagger.json
</span></span><span style="display:flex"><span>    modified:   api/openapi-spec/v3/apis__apps__v1_openapi.json
</span></span><span style="display:flex"><span>    modified:   pkg/generated/openapi/zz_generated.openapi.go
</span></span><span style="display:flex"><span>    modified:   staging/src/k8s.io/api/apps/v1/generated.proto
</span></span><span style="display:flex"><span>    modified:   staging/src/k8s.io/api/apps/v1/types_swagger_doc_generated.go
</span></span></code></pre></div><p>View the contents of <code>api/openapi-spec/swagger.json</code> to make sure the typo is fixed.
For example, you could run <code>git diff -a api/openapi-spec/swagger.json</code>.
This is important, because <code>swagger.json</code> is the input to the second stage of
the doc generation process.</p><p>Run <code>git add</code> and <code>git commit</code> to commit your changes. Now you have two commits:
one that contains the edited <code>types.go</code> file, and one that contains the generated OpenAPI spec
and related files. Keep these two commits separate. That is, do not squash your commits.</p><p>Submit your changes as a
<a href="https://help.github.com/articles/creating-a-pull-request/">pull request</a> to the
master branch of the
<a href="https://github.com/kubernetes/kubernetes">kubernetes/kubernetes</a> repository.
Monitor your pull request, and respond to reviewer comments as needed. Continue
to monitor your pull request until it is merged.</p><p><a href="https://github.com/kubernetes/kubernetes/pull/57758">PR 57758</a>
is an example of a pull request that fixes a typo in the Kubernetes source code.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>It can be tricky to determine the correct source file to be changed. In the
preceding example, the authoritative source file is in the <code>staging</code> directory
in the <code>kubernetes/kubernetes</code> repository. But in your situation,the <code>staging</code> directory
might not be the place to find the authoritative source. For guidance, check the
<code>README</code> files in
<a href="https://github.com/kubernetes/kubernetes/tree/master/staging">kubernetes/kubernetes</a>
repository and in related repositories, such as
<a href="https://github.com/kubernetes/apiserver/blob/master/README.md">kubernetes/apiserver</a>.</div><h3 id="cherry-pick-your-commit-into-a-release-branch">Cherry pick your commit into a release branch</h3><p>In the preceding section, you edited a file in the master branch and then ran scripts
to generate an OpenAPI spec and related files. Then you submitted your changes in a pull request
to the master branch of the kubernetes/kubernetes repository. Now suppose you want to backport
your change into a release branch. For example, suppose the master branch is being used to develop
Kubernetes version 1.34, and you want to backport your change into the
release-1.33 branch.</p><p>Recall that your pull request has two commits: one for editing <code>types.go</code>
and one for the files generated by scripts. The next step is to propose a cherry pick of your first
commit into the release-1.33 branch. The idea is to cherry pick the commit
that edited <code>types.go</code>, but not the commit that has the results of running the scripts. For instructions, see
<a href="https://git.k8s.io/community/contributors/devel/sig-release/cherry-picks.md">Propose a Cherry Pick</a>.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>Proposing a cherry pick requires that you have permission to set a label and a milestone in your
pull request. If you don't have those permissions, you will need to work with someone who can set the label
and milestone for you.</div><p>When you have a pull request in place for cherry picking your one commit into the
release-1.33 branch, the next step is to run these scripts in the
release-1.33 branch of your local environment.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>./hack/update-codegen.sh
</span></span><span style="display:flex"><span>./hack/update-openapi-spec.sh
</span></span></code></pre></div><p>Now add a commit to your cherry-pick pull request that has the recently generated OpenAPI spec
and related files. Monitor your pull request until it gets merged into the
release-1.33 branch.</p><p>At this point, both the master branch and the release-1.33 branch have your updated <code>types.go</code>
file and a set of generated files that reflect the change you made to <code>types.go</code>. Note that the
generated OpenAPI spec and other generated files in the release-1.33 branch are not necessarily
the same as the generated files in the master branch. The generated files in the release-1.33 branch
contain API elements only from Kubernetes 1.33. The generated files in the master branch might contain
API elements that are not in 1.33, but are under development for 1.34.</p><h2 id="generate-the-published-reference-docs">Generate the published reference docs</h2><p>The preceding section showed how to edit a source file and then generate
several files, including <code>api/openapi-spec/swagger.json</code> in the
<code>kubernetes/kubernetes</code> repository.
The <code>swagger.json</code> file is the OpenAPI definition file to use for generating
the API reference documentation.</p><p>You are now ready to follow the
<a href="/docs/contribute/generate-ref-docs/kubernetes-api/">Generating Reference Documentation for the Kubernetes API</a>
guide to generate the
<a href="/docs/reference/generated/kubernetes-api/v1.34/">published Kubernetes API reference documentation</a>.</p><h2 id="what-s-next">What's next</h2><ul><li><a href="/docs/contribute/generate-ref-docs/kubernetes-api/">Generating Reference Documentation for the Kubernetes API</a></li><li><a href="/docs/contribute/generate-ref-docs/kubernetes-components/">Generating Reference Docs for Kubernetes Components and Tools</a></li><li><a href="/docs/contribute/generate-ref-docs/kubectl/">Generating Reference Documentation for kubectl Commands</a></li></ul></div>