<div class="td-content"><h1 data-pagefind-weight="10">Install Drivers and Allocate Devices with DRA</h1><div class="feature-state-notice feature-stable" title="Feature Gate: DynamicResourceAllocation"><span class="feature-state-name">FEATURE STATE:</span>
<code>Kubernetes v1.34 [stable]</code> (enabled by default: true)</div><p>This tutorial shows you how to install <a class="glossary-tooltip" title="A Kubernetes feature for requesting and sharing resources, like hardware accelerators, among Pods." data-toggle="tooltip" data-placement="top" href="/docs/concepts/scheduling-eviction/dynamic-resource-allocation/" target="_blank" aria-label="Dynamic Resource Allocation (DRA)">Dynamic Resource Allocation (DRA)</a> drivers in your cluster and how to
use them in conjunction with the DRA APIs to allocate <a class="glossary-tooltip" title="Any resource that's directly or indirectly attached your cluster's nodes, like GPUs or circuit boards." data-toggle="tooltip" data-placement="top" href="/docs/reference/glossary/?all=true#term-device" target="_blank" aria-label="devices">devices</a> to Pods. This page is intended for cluster administrators.</p><p><a class="glossary-tooltip" title="A Kubernetes feature for requesting and sharing resources, like hardware accelerators, among Pods." data-toggle="tooltip" data-placement="top" href="/docs/concepts/scheduling-eviction/dynamic-resource-allocation/" target="_blank" aria-label="Dynamic Resource Allocation (DRA)">Dynamic Resource Allocation (DRA)</a>
lets a cluster manage availability and allocation of hardware resources to
satisfy Pod-based claims for hardware requirements and preferences. To support
this, a mixture of Kubernetes built-in components (like the Kubernetes
scheduler, kubelet, and kube-controller-manager) and third-party drivers from
device owners (called DRA drivers) share the responsibility to advertise,
allocate, prepare, mount, healthcheck, unprepare, and cleanup resources
throughout the Pod lifecycle. These components share information via a series of
DRA specific APIs in the <code>resource.k8s.io</code> API group including <a class="glossary-tooltip" title="A category of devices in the cluster. Users can claim specific devices in a DeviceClass." data-toggle="tooltip" data-placement="top" href="/docs/concepts/scheduling-eviction/dynamic-resource-allocation/#deviceclass" target="_blank" aria-label="DeviceClasses">DeviceClasses</a>, <a class="glossary-tooltip" title="Represents one or more infrastructure resources, like devices, in a pool of similar resources." data-toggle="tooltip" data-placement="top" href="/docs/reference/kubernetes-api/workload-resources/resource-slice-v1beta1/" target="_blank" aria-label="ResourceSlices">ResourceSlices</a>, <a class="glossary-tooltip" title="Describes the resources that a workload needs, such as devices. ResourceClaims can request devices from DeviceClasses." data-toggle="tooltip" data-placement="top" href="/docs/concepts/scheduling-eviction/dynamic-resource-allocation/#resourceclaims-templates" target="_blank" aria-label="ResourceClaims">ResourceClaims</a>, as well as
new fields in the Pod spec itself.</p><h3 id="objectives">Objectives</h3><ul><li>Deploy an example DRA driver</li><li>Deploy a Pod requesting a hardware claim using DRA APIs</li><li>Delete a Pod that has a claim</li></ul><h2 id="before-you-begin">Before you begin</h2><p>Your cluster should support <a href="/docs/reference/access-authn-authz/rbac/">RBAC</a>.
You can try this tutorial with a cluster using a different authorization
mechanism, but in that case you will have to adapt the steps around defining
roles and permissions.</p><p>You need to have a Kubernetes cluster, and the kubectl command-line tool must
be configured to communicate with your cluster. It is recommended to run this tutorial on a cluster with at least two nodes that are not acting as control plane hosts. If you do not already have a
cluster, you can create one by using
<a href="https://minikube.sigs.k8s.io/docs/tutorials/multi_node/">minikube</a>
or you can use one of these Kubernetes playgrounds:</p><ul><li><a href="https://labs.iximiuz.com/playgrounds?category=kubernetes&amp;filter=all">iximiuz Labs</a></li><li><a href="https://killercoda.com/playgrounds/scenario/kubernetes">Killercoda</a></li><li><a href="https://kodekloud.com/public-playgrounds">KodeKloud</a></li><li><a href="https://labs.play-with-k8s.com/">Play with Kubernetes</a></li></ul><p>This tutorial has been tested with Linux nodes, though it may also work with
other types of nodes.</p>Your Kubernetes server must be version v1.34.<p>To check the version, enter <code>kubectl version</code>.</p><p>If your cluster is not currently running Kubernetes 1.34 then please check the documentation for the version of Kubernetes that you
plan to use.</p><h2 id="explore-initial-state">Explore the initial cluster state</h2><p>You can spend some time to observe the initial state of a cluster with DRA
enabled, especially if you have not used these APIs extensively before. If you
set up a new cluster for this tutorial, with no driver installed and no Pod
claims yet to satisfy, the output of these commands won't show any resources.</p><ol><li><p>Get a list of <a class="glossary-tooltip" title="A category of devices in the cluster. Users can claim specific devices in a DeviceClass." data-toggle="tooltip" data-placement="top" href="/docs/concepts/scheduling-eviction/dynamic-resource-allocation/#deviceclass" target="_blank" aria-label="DeviceClasses">DeviceClasses</a>:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get deviceclasses
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>No resources found
</code></pre></li><li><p>Get a list of <a class="glossary-tooltip" title="Represents one or more infrastructure resources, like devices, in a pool of similar resources." data-toggle="tooltip" data-placement="top" href="/docs/reference/kubernetes-api/workload-resources/resource-slice-v1beta1/" target="_blank" aria-label="ResourceSlices">ResourceSlices</a>:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get resourceslices
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>No resources found
</code></pre></li><li><p>Get a list of <a class="glossary-tooltip" title="Describes the resources that a workload needs, such as devices. ResourceClaims can request devices from DeviceClasses." data-toggle="tooltip" data-placement="top" href="/docs/concepts/scheduling-eviction/dynamic-resource-allocation/#resourceclaims-templates" target="_blank" aria-label="ResourceClaims">ResourceClaims</a> and <a class="glossary-tooltip" title="Defines a template for Kubernetes to create ResourceClaims. Used to provide per-Pod access to separate, similar resources." data-toggle="tooltip" data-placement="top" href="/docs/concepts/scheduling-eviction/dynamic-resource-allocation/#resourceclaims-templates" target="_blank" aria-label="ResourceClaimTemplates">ResourceClaimTemplates</a></p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get resourceclaims -A
</span></span><span style="display:flex"><span>kubectl get resourceclaimtemplates -A
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>No resources found
No resources found
</code></pre></li></ol><p>At this point, you have confirmed that DRA is enabled and configured properly in
the cluster, and that no DRA drivers have advertised any resources to the DRA
APIs yet.</p><h2 id="install-example-driver">Install an example DRA driver</h2><p>DRA drivers are third-party applications that run on each node of your cluster
to interface with the hardware of that node and Kubernetes' built-in DRA
components. The installation procedure depends on the driver you choose, but is
likely deployed as a <a class="glossary-tooltip" title="Ensures a copy of a Pod is running across a set of nodes in a cluster." data-toggle="tooltip" data-placement="top" href="/docs/concepts/workloads/controllers/daemonset" target="_blank" aria-label="DaemonSet">DaemonSet</a> to all or a
selection of the nodes (using <a class="glossary-tooltip" title="Allows users to filter a list of resources based on labels." data-toggle="tooltip" data-placement="top" href="/docs/concepts/overview/working-with-objects/labels/" target="_blank" aria-label="selectors">selectors</a> or similar mechanisms) in your cluster.</p><p>Check your driver's documentation for specific installation instructions, which
might include a Helm chart, a set of manifests, or other deployment tooling.</p><p>This tutorial uses an example driver which can be found in the
<a href="https://github.com/kubernetes-sigs/dra-example-driver">kubernetes-sigs/dra-example-driver</a>
repository to demonstrate driver installation. This example driver advertises
simulated GPUs to Kubernetes for your Pods to interact with.</p><h3 id="prepare-cluster-driver">Prepare your cluster for driver installation</h3><p>To simplify cleanup, create a namespace named dra-tutorial:</p><ol><li><p>Create the namespace:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl create namespace dra-tutorial 
</span></span></code></pre></div></li></ol><p>In a production environment, you would likely be using a previously released or
qualified image from the driver vendor or your own organization, and your nodes
would need to have access to the image registry where the driver image is
hosted. In this tutorial, you will use a publicly released image of the
dra-example-driver to simulate access to a DRA driver image.</p><ol><li><p>Confirm your nodes have access to the image by running the following
from within one of your cluster's nodes:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>docker pull registry.k8s.io/dra-example-driver/dra-example-driver:v0.2.0
</span></span></code></pre></div></li></ol><h3 id="deploy-the-dra-driver-components">Deploy the DRA driver components</h3><p>For this tutorial, you will install the critical example resource driver
components individually with <code>kubectl</code>.</p><ol><li><p>Create the DeviceClass representing the device types this DRA driver
supports:</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/dra/driver-install/deviceclass.yaml" download="dra/driver-install/deviceclass.yaml"><code>dra/driver-install/deviceclass.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;dra-driver-install-deviceclass-yaml&quot;)" title="Copy dra/driver-install/deviceclass.yaml to clipboard"/></div><div class="includecode" id="dra-driver-install-deviceclass-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>resource.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>DeviceClass<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>gpu.example.com<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">selectors</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">cel</span>:<span style="color:#bbb"> 
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">expression</span>:<span style="color:#bbb"> </span><span style="color:#b44">"device.driver == 'gpu.example.com'"</span></span></span></code></pre></div></div></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply --server-side -f http://k8s.io/examples/dra/driver-install/deviceclass.yaml
</span></span></code></pre></div></li><li><p>Create the ServiceAccount, ClusterRole and ClusterRoleBinding that will
be used by the driver to gain permissions to interact with the Kubernetes API
on this cluster:</p><ol><li><p>Create the Service Account:</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/dra/driver-install/serviceaccount.yaml" download="dra/driver-install/serviceaccount.yaml"><code>dra/driver-install/serviceaccount.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;dra-driver-install-serviceaccount-yaml&quot;)" title="Copy dra/driver-install/serviceaccount.yaml to clipboard"/></div><div class="includecode" id="dra-driver-install-serviceaccount-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>ServiceAccount<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>dra-example-driver-service-account<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">namespace</span>:<span style="color:#bbb"> </span>dra-tutorial<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">labels</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">app.kubernetes.io/name</span>:<span style="color:#bbb"> </span>dra-example-driver<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">app.kubernetes.io/instance</span>:<span style="color:#bbb"> </span>dra-example-driver</span></span></code></pre></div></div></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply --server-side -f http://k8s.io/examples/dra/driver-install/serviceaccount.yaml
</span></span></code></pre></div></li><li><p>Create the ClusterRole:</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/dra/driver-install/clusterrole.yaml" download="dra/driver-install/clusterrole.yaml"><code>dra/driver-install/clusterrole.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;dra-driver-install-clusterrole-yaml&quot;)" title="Copy dra/driver-install/clusterrole.yaml to clipboard"/></div><div class="includecode" id="dra-driver-install-clusterrole-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>rbac.authorization.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>ClusterRole<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>dra-example-driver-role<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">rules</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/>- <span style="color:green;font-weight:700">apiGroups</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"resource.k8s.io"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">resources</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"resourceclaims"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">verbs</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"get"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/>- <span style="color:green;font-weight:700">apiGroups</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">""</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">resources</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"nodes"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">verbs</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"get"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/>- <span style="color:green;font-weight:700">apiGroups</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"resource.k8s.io"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">resources</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"resourceslices"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">verbs</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"get"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"list"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"watch"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"create"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"update"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"patch"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"delete"</span>]</span></span></code></pre></div></div></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply --server-side -f http://k8s.io/examples/dra/driver-install/clusterrole.yaml
</span></span></code></pre></div></li><li><p>Create the ClusterRoleBinding:</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/dra/driver-install/clusterrolebinding.yaml" download="dra/driver-install/clusterrolebinding.yaml"><code>dra/driver-install/clusterrolebinding.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;dra-driver-install-clusterrolebinding-yaml&quot;)" title="Copy dra/driver-install/clusterrolebinding.yaml to clipboard"/></div><div class="includecode" id="dra-driver-install-clusterrolebinding-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>rbac.authorization.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>ClusterRoleBinding<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>dra-example-driver-role-binding<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">subjects</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/>- <span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>ServiceAccount<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>dra-example-driver-service-account<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">namespace</span>:<span style="color:#bbb"> </span>dra-tutorial<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">roleRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>ClusterRole<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>dra-example-driver-role<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">apiGroup</span>:<span style="color:#bbb"> </span>rbac.authorization.k8s.io</span></span></code></pre></div></div></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply --server-side -f http://k8s.io/examples/dra/driver-install/clusterrolebinding.yaml
</span></span></code></pre></div></li></ol></li><li><p>Create a <a class="glossary-tooltip" title="A mapping from a class name to the scheduling priority that a Pod should have." data-toggle="tooltip" data-placement="top" href="/docs/concepts/scheduling-eviction/pod-priority-preemption/#priorityclass" target="_blank" aria-label="PriorityClass">PriorityClass</a> for the DRA
driver. The PriorityClass prevents preemption of th DRA driver component,
which is responsible for important lifecycle operations for Pods with
claims. Learn more about <a href="/docs/concepts/scheduling-eviction/pod-priority-preemption/">pod priority and preemption
here</a>.</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/dra/driver-install/priorityclass.yaml" download="dra/driver-install/priorityclass.yaml"><code>dra/driver-install/priorityclass.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;dra-driver-install-priorityclass-yaml&quot;)" title="Copy dra/driver-install/priorityclass.yaml to clipboard"/></div><div class="includecode" id="dra-driver-install-priorityclass-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>scheduling.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>PriorityClass<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>dra-driver-high-priority<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#666">1000000</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">globalDefault</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:700">false</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">description</span>:<span style="color:#bbb"> </span><span style="color:#b44">"This priority class should be used for DRA driver pods only."</span></span></span></code></pre></div></div></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply --server-side -f http://k8s.io/examples/dra/driver-install/priorityclass.yaml
</span></span></code></pre></div></li><li><p>Deploy the actual DRA driver as a DaemonSet configured to run the example
driver binary with the permissions provisioned above. The DaemonSet has the
permissions that you granted to the ServiceAccount in the previous steps.</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/dra/driver-install/daemonset.yaml" download="dra/driver-install/daemonset.yaml"><code>dra/driver-install/daemonset.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;dra-driver-install-daemonset-yaml&quot;)" title="Copy dra/driver-install/daemonset.yaml to clipboard"/></div><div class="includecode" id="dra-driver-install-daemonset-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>apps/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>DaemonSet<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>dra-example-driver-kubeletplugin<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">namespace</span>:<span style="color:#bbb"> </span>dra-tutorial<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">labels</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">app.kubernetes.io/name</span>:<span style="color:#bbb"> </span>dra-example-driver<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">selector</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">matchLabels</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">app.kubernetes.io/name</span>:<span style="color:#bbb"> </span>dra-example-driver<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">updateStrategy</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">type</span>:<span style="color:#bbb"> </span>RollingUpdate<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">template</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">labels</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">app.kubernetes.io/name</span>:<span style="color:#bbb"> </span>dra-example-driver<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">priorityClassName</span>:<span style="color:#bbb"> </span>dra-driver-high-priority<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">serviceAccountName</span>:<span style="color:#bbb"> </span>dra-example-driver-service-account<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">securityContext</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>{}<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>plugin<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">securityContext</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">privileged</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:700">true</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>registry.k8s.io/dra-example-driver/dra-example-driver:v0.2.0<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">imagePullPolicy</span>:<span style="color:#bbb"> </span>IfNotPresent<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">command</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"dra-example-kubeletplugin"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">resources</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span>{}<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># Production drivers should always implement a liveness probe</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># For the tutorial we simply omit it</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># livenessProbe:</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic">#   grpc:</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic">#     port: 51515</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic">#     service: liveness</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic">#   failureThreshold: 3</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic">#   periodSeconds: 10</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">env</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>CDI_ROOT<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span>/var/run/cdi<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>KUBELET_REGISTRAR_DIRECTORY_PATH<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"/var/lib/kubelet/plugins_registry"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>KUBELET_PLUGINS_DIRECTORY_PATH<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"/var/lib/kubelet/plugins"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>NODE_NAME<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">fieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">fieldPath</span>:<span style="color:#bbb"> </span>spec.nodeName<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>NAMESPACE<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">valueFrom</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">fieldRef</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">              </span><span style="color:green;font-weight:700">fieldPath</span>:<span style="color:#bbb"> </span>metadata.namespace<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic"># Simulated number of devices the example driver will pretend to have.</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>NUM_DEVICES<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"9"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>HEALTHCHECK_PORT<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">value</span>:<span style="color:#bbb"> </span><span style="color:#b44">"51515"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">volumeMounts</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>plugins-registry<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">mountPath</span>:<span style="color:#bbb"> </span><span style="color:#b44">"/var/lib/kubelet/plugins_registry"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>plugins<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">mountPath</span>:<span style="color:#bbb"> </span><span style="color:#b44">"/var/lib/kubelet/plugins"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>cdi<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">mountPath</span>:<span style="color:#bbb"> </span>/var/run/cdi<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">volumes</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>plugins-registry<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">hostPath</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">path</span>:<span style="color:#bbb"> </span><span style="color:#b44">"/var/lib/kubelet/plugins_registry"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>plugins<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">hostPath</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">path</span>:<span style="color:#bbb"> </span><span style="color:#b44">"/var/lib/kubelet/plugins"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>cdi<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">hostPath</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">path</span>:<span style="color:#bbb"> </span>/var/run/cdi</span></span></code></pre></div></div></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply --server-side -f http://k8s.io/examples/dra/driver-install/daemonset.yaml
</span></span></code></pre></div><p>The DaemonSet is configured with
the volume mounts necessary to interact with the underlying Container Device
Interface (CDI) directory, and to expose its socket to <code>kubelet</code> via the
<code>kubelet/plugins</code> directory.</p></li></ol><h3 id="verify-driver-install">Verify the DRA driver installation</h3><ol><li><p>Get a list of the Pods of the DRA driver DaemonSet across all worker nodes:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get pod -l app.kubernetes.io/name<span style="color:#666">=</span>dra-example-driver -n dra-tutorial
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>NAME                                     READY   STATUS    RESTARTS   AGE
dra-example-driver-kubeletplugin-4sk2x   1/1     Running   0          13s
dra-example-driver-kubeletplugin-cttr2   1/1     Running   0          13s
</code></pre></li><li><p>The initial responsibility of each node's local DRA driver is to update the
cluster with what devices are available to Pods on that node, by publishing its
metadata to the ResourceSlices API. You can check that API to see that each node
with a driver is advertising the device class it represents.</p><p>Check for available ResourceSlices:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get resourceslices
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>NAME                                 NODE           DRIVER            POOL           AGE
kind-worker-gpu.example.com-k69gd    kind-worker    gpu.example.com   kind-worker    19s
kind-worker2-gpu.example.com-qdgpn   kind-worker2   gpu.example.com   kind-worker2   19s
</code></pre></li></ol><p>At this point, you have successfully installed the example DRA driver, and
confirmed its initial configuration. You're now ready to use DRA to schedule
Pods.</p><h2 id="claim-resources-pod">Claim resources and deploy a Pod</h2><p>To request resources using DRA, you create ResourceClaims or
ResourceClaimTemplates that define the resources that your Pods need. In the
example driver, a memory capacity attribute is exposed for mock GPU devices.
This section shows you how to use <a class="glossary-tooltip" title="An expression language that's designed to be safe for executing user code." data-toggle="tooltip" data-placement="top" href="https://cel.dev" target="_blank" aria-label="Common Expression Language">Common Expression Language</a> to
express your requirements in a ResourceClaim, select that ResourceClaim in a Pod
specification, and observe the resource allocation.</p><p>This tutorial showcases only one basic example of a DRA ResourceClaim. Read
<a href="/docs/concepts/scheduling-eviction/dynamic-resource-allocation/">Dynamic Resource
Allocation</a> to
learn more about ResourceClaims.</p><h3 id="create-the-resourceclaim">Create the ResourceClaim</h3><p>In this section, you create a ResourceClaim and reference it in a Pod. Whatever
the claim, the <code>deviceClassName</code> is a required field, narrowing down the scope
of the request to a specific device class. The request itself can include a <a class="glossary-tooltip" title="An expression language that's designed to be safe for executing user code." data-toggle="tooltip" data-placement="top" href="https://cel.dev" target="_blank" aria-label="Common Expression Language">Common Expression Language</a> expression that references attributes that
may be advertised by the driver managing that device class.</p><p>In this example, you will create a request for any GPU advertising over 10Gi
memory capacity. The attribute exposing capacity from the example driver takes
the form <code>device.capacity['gpu.example.com'].memory</code>. Note also that the name of
the claim is set to <code>some-gpu</code>.</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/dra/driver-install/example/resourceclaim.yaml" download="dra/driver-install/example/resourceclaim.yaml"><code>dra/driver-install/example/resourceclaim.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;dra-driver-install-example-resourceclaim-yaml&quot;)" title="Copy dra/driver-install/example/resourceclaim.yaml to clipboard"/></div><div class="includecode" id="dra-driver-install-example-resourceclaim-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>resource.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>ResourceClaim<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"> </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>some-gpu<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"> </span><span style="color:green;font-weight:700">namespace</span>:<span style="color:#bbb"> </span>dra-tutorial<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">   </span><span style="color:green;font-weight:700">devices</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">     </span><span style="color:green;font-weight:700">requests</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">     </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>some-gpu<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">       </span><span style="color:green;font-weight:700">exactly</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">         </span><span style="color:green;font-weight:700">deviceClassName</span>:<span style="color:#bbb"> </span>gpu.example.com<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">         </span><span style="color:green;font-weight:700">selectors</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">         </span>- <span style="color:green;font-weight:700">cel</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">             </span><span style="color:green;font-weight:700">expression</span>:<span style="color:#bbb"> </span><span style="color:#b44">"device.capacity['gpu.example.com'].memory.compareTo(quantity('10Gi')) &gt;= 0"</span></span></span></code></pre></div></div></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply --server-side -f http://k8s.io/examples/dra/driver-install/example/resourceclaim.yaml
</span></span></code></pre></div><h3 id="create-the-pod-that-references-that-resourceclaim">Create the Pod that references that ResourceClaim</h3><p>Below is the Pod manifest referencing the ResourceClaim you just made,
<code>some-gpu</code>, in the <code>spec.resourceClaims.resourceClaimName</code> field. The local name
for that claim, <code>gpu</code>, is then used in the
<code>spec.containers.resources.claims.name</code> field to allocate the claim to the Pod's
underlying container.</p><div class="highlight code-sample"><div class="copy-code-icon"><a href="https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/dra/driver-install/example/pod.yaml" download="dra/driver-install/example/pod.yaml"><code>dra/driver-install/example/pod.yaml</code>
</a><img src="/images/copycode.svg" class="icon-copycode" onclick="copyCode(&quot;dra-driver-install-example-pod-yaml&quot;)" title="Copy dra/driver-install/example/pod.yaml to clipboard"/></div><div class="includecode" id="dra-driver-install-example-pod-yaml"><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>pod0<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">namespace</span>:<span style="color:#bbb"> </span>dra-tutorial<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">labels</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">app</span>:<span style="color:#bbb"> </span>pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>ctr0<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>ubuntu:24.04<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">command</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"bash"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"-c"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">args</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"export; trap 'exit 0' TERM; sleep 9999 &amp; wait"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">resources</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">claims</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>gpu<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">resourceClaims</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>gpu<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">resourceClaimName</span>:<span style="color:#bbb"> </span>some-gpu</span></span></code></pre></div></div></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl apply --server-side -f http://k8s.io/examples/dra/driver-install/example/pod.yaml
</span></span></code></pre></div><ol><li><p>Confirm the pod has deployed:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get pod pod0 -n dra-tutorial
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>NAME   READY   STATUS    RESTARTS   AGE
pod0   1/1     Running   0          9s
</code></pre></li></ol><h3 id="explore-the-dra-state">Explore the DRA state</h3><p>After you create the Pod, the cluster tries to schedule that Pod to a node where
Kubernetes can satisfy the ResourceClaim. In this tutorial, the DRA driver is
deployed on all nodes, and is advertising mock GPUs on all nodes, all of which
have enough capacity advertised to satisfy the Pod's claim, so Kubernetes can
schedule this Pod on any node and can allocate any of the mock GPUs on that
node.</p><p>When Kubernetes allocates a mock GPU to a Pod, the example driver adds
environment variables in each container it is allocated to in order to indicate
which GPUs <em>would</em> have been injected into them by a real resource driver and
how they would have been configured, so you can check those environment
variables to see how the Pods have been handled by the system.</p><ol><li><p>Check the Pod logs, which report the name of the mock GPU that was allocated:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl logs pod0 -c ctr0 -n dra-tutorial | grep -E <span style="color:#b44">"GPU_DEVICE_[0-9]+="</span> | grep -v <span style="color:#b44">"RESOURCE_CLAIM"</span>
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>declare -x GPU_DEVICE_0="gpu-0"
</code></pre></li><li><p>Check the state of the ResourceClaim object:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get resourceclaims -n dra-tutorial
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>NAME       STATE                AGE
some-gpu   allocated,reserved   34s
</code></pre><p>In this output, the <code>STATE</code> column shows that the ResourceClaim is allocated
and reserved.</p></li><li><p>Check the details of the <code>some-gpu</code> ResourceClaim. The <code>status</code> stanza of
the ResourceClaim has information about the allocated device and the Pod it
has been reserved for:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get resourceclaim some-gpu -n dra-tutorial -o yaml
</span></span></code></pre></div><p>The output is similar to this:<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>resource.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>ResourceClaim<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">creationTimestamp</span>:<span style="color:#bbb"> </span><span style="color:#b44">"2025-08-20T18:17:31Z"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">finalizers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style="color:#bbb">    </span>- resource.kubernetes.io/delete-protection<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>some-gpu<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">namespace</span>:<span style="color:#bbb"> </span>dra-tutorial<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">resourceVersion</span>:<span style="color:#bbb"> </span><span style="color:#b44">"2326"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">uid</span>:<span style="color:#bbb"> </span>d3e48dbf-40da-47c3-a7b9-f7d54d1051c3<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">devices</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">requests</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">exactly</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">allocationMode</span>:<span style="color:#bbb"> </span>ExactCount<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">count</span>:<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">deviceClassName</span>:<span style="color:#bbb"> </span>gpu.example.com<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">selectors</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style="color:#bbb">            </span>- <span style="color:green;font-weight:700">cel</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style="color:#bbb">                </span><span style="color:green;font-weight:700">expression</span>:<span style="color:#bbb"> </span>device.capacity['gpu.example.com'].memory.compareTo(quantity('10Gi'))<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style="color:#bbb">                </span>&gt;= 0<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>some-gpu<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style="color:#bbb"/><span style="color:green;font-weight:700">status</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">allocation</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">devices</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">results</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;background-color:#dfdfdf"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">device</span>:<span style="color:#bbb"> </span>gpu-0<span style="color:#bbb">
</span></span></span><span style="display:flex;background-color:#dfdfdf"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">driver</span>:<span style="color:#bbb"> </span>gpu.example.com<span style="color:#bbb">
</span></span></span><span style="display:flex;background-color:#dfdfdf"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">pool</span>:<span style="color:#bbb"> </span>kind-worker<span style="color:#bbb">
</span></span></span><span style="display:flex;background-color:#dfdfdf"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">request</span>:<span style="color:#bbb"> </span>some-gpu<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">nodeSelector</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">nodeSelectorTerms</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">matchFields</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span><span style="color:#bbb">            </span>- <span style="color:green;font-weight:700">key</span>:<span style="color:#bbb"> </span>metadata.name<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">operator</span>:<span style="color:#bbb"> </span>In<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span><span style="color:#bbb">            </span><span style="color:green;font-weight:700">values</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span><span style="color:#bbb">            </span>- kind-worker<span style="color:#bbb">
</span></span></span><span style="display:flex;background-color:#dfdfdf"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">reservedFor</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;background-color:#dfdfdf"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span><span style="color:#bbb">    </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>pod0<span style="color:#bbb">
</span></span></span><span style="display:flex;background-color:#dfdfdf"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">resource</span>:<span style="color:#bbb"> </span>pods<span style="color:#bbb">
</span></span></span><span style="display:flex;background-color:#dfdfdf"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">uid</span>:<span style="color:#bbb"> </span>c4dadf20-392a-474d-a47b-ab82080c8bd7</span></span></code></pre></div></p></li><li><p>To check how the driver handled device allocation, get the logs for the
driver DaemonSet Pods:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl logs -l app.kubernetes.io/name<span style="color:#666">=</span>dra-example-driver -n dra-tutorial
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>I0820 18:17:44.131324       1 driver.go:106] PrepareResourceClaims is called: number of claims: 1
I0820 18:17:44.135056       1 driver.go:133] Returning newly prepared devices for claim 'd3e48dbf-40da-47c3-a7b9-f7d54d1051c3': [{[some-gpu] kind-worker gpu-0 [k8s.gpu.example.com/gpu=common k8s.gpu.example.com/gpu=d3e48dbf-40da-47c3-a7b9-f7d54d1051c3-gpu-0]}]
</code></pre></li></ol><p>You have now successfully deployed a Pod that claims devices using DRA, verified
that the Pod was scheduled to an appropriate node, and saw that the associated
DRA APIs kinds were updated with the allocation status.</p><h2 id="delete-pod-claim">Delete a Pod that has a claim</h2><p>When a Pod with a claim is deleted, the DRA driver deallocates the resource so
it can be available for future scheduling. To validate this behavior, delete the
Pod that you created in the previous steps and watch the corresponding changes
to the ResourceClaim and driver.</p><ol><li><p>Delete the <code>pod0</code> Pod:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl delete pod pod0 -n dra-tutorial
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>pod "pod0" deleted
</code></pre></li></ol><h3 id="observe-the-dra-state">Observe the DRA state</h3><p>When the Pod is deleted, the driver deallocates the device from the
ResourceClaim and updates the ResourceClaim resource in the Kubernetes API. The
ResourceClaim has a <code>pending</code> state until it's referenced in a new Pod.</p><ol><li><p>Check the state of the <code>some-gpu</code> ResourceClaim:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get resourceclaims -n dra-tutorial
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>NAME       STATE     AGE
some-gpu   pending   76s
</code></pre></li><li><p>Verify that the driver has processed unpreparing the device for this claim by
checking the driver logs:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl logs -l app.kubernetes.io/name<span style="color:#666">=</span>dra-example-driver -n dra-tutorial
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>I0820 18:22:15.629376       1 driver.go:138] UnprepareResourceClaims is called: number of claims: 1
</code></pre></li></ol><p>You have now deleted a Pod that had a claim, and observed that the driver took
action to unprepare the underlying hardware resource and update the DRA APIs to
reflect that the resource is available again for future scheduling.</p><h2 id="cleaning-up">Cleaning up</h2><p>To clean up the resources that you created in this tutorial, follow these steps:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl delete namespace dra-tutorial
</span></span><span style="display:flex"><span>kubectl delete deviceclass gpu.example.com
</span></span><span style="display:flex"><span>kubectl delete clusterrole dra-example-driver-role
</span></span><span style="display:flex"><span>kubectl delete clusterrolebinding dra-example-driver-role-binding
</span></span><span style="display:flex"><span>kubectl delete priorityclass dra-driver-high-priority
</span></span></code></pre></div><h2 id="what-s-next">What's next</h2><ul><li><a href="/docs/concepts/scheduling-eviction/dynamic-resource-allocation/">Learn more about DRA</a></li><li><a href="/docs/tasks/configure-pod-container/assign-resources/allocate-devices-dra/">Allocate Devices to Workloads with DRA</a></li></ul></div>