<div class="td-content"><h1 data-pagefind-weight="10">Debugging Kubernetes Nodes With Kubectl</h1><p>This page shows how to debug a <a href="/docs/concepts/architecture/nodes/">node</a>
running on the Kubernetes cluster using <code>kubectl debug</code> command.</p><h2 id="before-you-begin">Before you begin</h2><p><p>You need to have a Kubernetes cluster, and the kubectl command-line tool must
be configured to communicate with your cluster. It is recommended to run this tutorial on a cluster with at least two nodes that are not acting as control plane hosts. If you do not already have a
cluster, you can create one by using
<a href="https://minikube.sigs.k8s.io/docs/tutorials/multi_node/">minikube</a>
or you can use one of these Kubernetes playgrounds:</p><ul><li><a href="https://labs.iximiuz.com/playgrounds?category=kubernetes&amp;filter=all">iximiuz Labs</a></li><li><a href="https://killercoda.com/playgrounds/scenario/kubernetes">Killercoda</a></li><li><a href="https://kodekloud.com/public-playgrounds">KodeKloud</a></li><li><a href="https://labs.play-with-k8s.com/">Play with Kubernetes</a></li></ul>Your Kubernetes server must be at or later than version 1.2.<p>To check the version, enter <code>kubectl version</code>.</p></p><p>You need to have permission to create Pods and to assign those new Pods to arbitrary nodes.
You also need to be authorized to create Pods that access filesystems from the host.</p><h2 id="debugging-a-node-using-kubectl-debug-node">Debugging a Node using <code>kubectl debug node</code></h2><p>Use the <code>kubectl debug node</code> command to deploy a Pod to a Node that you want to troubleshoot.
This command is helpful in scenarios where you can't access your Node by using an SSH connection.
When the Pod is created, the Pod opens an interactive shell on the Node.
To create an interactive shell on a Node named “mynode”, run:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl debug node/mynode -it --image<span style="color:#666">=</span>ubuntu
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console"><span style="display:flex"><span><span style="color:#888">Creating debugging pod node-debugger-mynode-pdx84 with container debugger on node mynode.
</span></span></span><span style="display:flex"><span><span style="color:#888">If you don't see a command prompt, try pressing enter.
</span></span></span><span style="display:flex"><span><span style="color:#888">root@mynode:/#
</span></span></span></code></pre></div><p>The debug command helps to gather information and troubleshoot issues. Commands
that you might use include <code>ip</code>, <code>ifconfig</code>, <code>nc</code>, <code>ping</code>, and <code>ps</code> and so on. You can also
install other tools, such as <code>mtr</code>, <code>tcpdump</code>, and <code>curl</code>, from the respective package manager.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>The debug commands may differ based on the image the debugging pod is using and
these commands might need to be installed.</div><p>The debugging Pod can access the root filesystem of the Node, mounted at <code>/host</code> in the Pod.
If you run your kubelet in a filesystem namespace,
the debugging Pod sees the root for that namespace, not for the entire node. For a typical Linux node,
you can look at the following paths to find relevant logs:</p><dl><dt><code>/host/var/log/kubelet.log</code></dt><dd>Logs from the <code>kubelet</code>, responsible for running containers on the node.</dd><dt><code>/host/var/log/kube-proxy.log</code></dt><dd>Logs from <code>kube-proxy</code>, which is responsible for directing traffic to Service endpoints.</dd><dt><code>/host/var/log/containerd.log</code></dt><dd>Logs from the <code>containerd</code> process running on the node.</dd><dt><code>/host/var/log/syslog</code></dt><dd>Shows general messages and information regarding the system.</dd><dt><code>/host/var/log/kern.log</code></dt><dd>Shows kernel logs.</dd></dl><p>When creating a debugging session on a Node, keep in mind that:</p><ul><li><code>kubectl debug</code> automatically generates the name of the new pod, based on
the name of the node.</li><li>The root filesystem of the Node will be mounted at <code>/host</code>.</li><li>Although the container runs in the host IPC, Network, and PID namespaces,
the pod isn't privileged. This means that reading some process information might fail
because access to that information is restricted to superusers. For example, <code>chroot /host</code> will fail.
If you need a privileged pod, create it manually or use the <code>--profile=sysadmin</code> flag.</li><li>By applying <a href="/docs/tasks/debug/debug-application/debug-running-pod/#debugging-profiles">Debugging Profiles</a>, you can set specific properties such as <a href="/docs/tasks/configure-pod-container/security-context/">securityContext</a> to a debugging Pod.</li></ul><h2 id="cleaning-up">Cleaning up</h2><p>When you finish using the debugging Pod, delete it:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get pods
</span></span></code></pre></div><pre tabindex="0"><code class="language-none" data-lang="none">NAME                          READY   STATUS       RESTARTS   AGE
node-debugger-mynode-pdx84    0/1     Completed    0          8m1s
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Change the pod name accordingly</span>
</span></span><span style="display:flex"><span>kubectl delete pod node-debugger-mynode-pdx84 --now
</span></span></code></pre></div><pre tabindex="0"><code class="language-none" data-lang="none">pod "node-debugger-mynode-pdx84" deleted
</code></pre><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>The <code>kubectl debug node</code> command won't work if the Node is down (disconnected
from the network, or kubelet dies and won't restart, etc.).
Check <a href="/docs/tasks/debug/debug-cluster/#example-debugging-a-down-unreachable-node">debugging a down/unreachable node </a>in that case.</div></div>