<div class="td-content"><h1 data-pagefind-weight="10">Pod Security Admission</h1><div class="lead">An overview of the Pod Security Admission Controller, which can enforce the Pod Security Standards.</div><div class="feature-state-notice feature-stable"><span class="feature-state-name">FEATURE STATE:</span>
<code>Kubernetes v1.25 [stable]</code></div><p>The Kubernetes <a href="/docs/concepts/security/pod-security-standards/">Pod Security Standards</a> define
different isolation levels for Pods. These standards let you define how you want to restrict the
behavior of pods in a clear, consistent fashion.</p><p>Kubernetes offers a built-in <em>Pod Security</em> <a class="glossary-tooltip" title="A piece of code that intercepts requests to the Kubernetes API server prior to persistence of the object." data-toggle="tooltip" data-placement="top" href="/docs/reference/access-authn-authz/admission-controllers/" target="_blank" aria-label="admission controller">admission controller</a> to enforce the Pod Security Standards. Pod security restrictions
are applied at the <a class="glossary-tooltip" title="An abstraction used by Kubernetes to support isolation of groups of resources within a single cluster." data-toggle="tooltip" data-placement="top" href="/docs/concepts/overview/working-with-objects/namespaces" target="_blank" aria-label="namespace">namespace</a> level when pods are
created.</p><h3 id="built-in-pod-security-admission-enforcement">Built-in Pod Security admission enforcement</h3><p>This page is part of the documentation for Kubernetes v1.34.
If you are running a different version of Kubernetes, consult the documentation for that release.</p><h2 id="pod-security-levels">Pod Security levels</h2><p>Pod Security admission places requirements on a Pod's <a href="/docs/tasks/configure-pod-container/security-context/">Security
Context</a> and other related fields according
to the three levels defined by the <a href="/docs/concepts/security/pod-security-standards/">Pod Security
Standards</a>: <code>privileged</code>, <code>baseline</code>, and
<code>restricted</code>. Refer to the <a href="/docs/concepts/security/pod-security-standards/">Pod Security Standards</a>
page for an in-depth look at those requirements.</p><h2 id="pod-security-admission-labels-for-namespaces">Pod Security Admission labels for namespaces</h2><p>Once the feature is enabled or the webhook is installed, you can configure namespaces to define the admission
control mode you want to use for pod security in each namespace. Kubernetes defines a set of
<a class="glossary-tooltip" title="Tags objects with identifying attributes that are meaningful and relevant to users." data-toggle="tooltip" data-placement="top" href="/docs/concepts/overview/working-with-objects/labels" target="_blank" aria-label="labels">labels</a> that you can set to define which of the
predefined Pod Security Standard levels you want to use for a namespace. The label you select
defines what action the <a class="glossary-tooltip" title="The container orchestration layer that exposes the API and interfaces to define, deploy, and manage the lifecycle of containers." data-toggle="tooltip" data-placement="top" href="/docs/reference/glossary/?all=true#term-control-plane" target="_blank" aria-label="control plane">control plane</a>
takes if a potential violation is detected:</p><table><caption style="display:none">Pod Security Admission modes</caption><thead><tr><th style="text-align:left">Mode</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left"><strong>enforce</strong></td><td style="text-align:left">Policy violations will cause the pod to be rejected.</td></tr><tr><td style="text-align:left"><strong>audit</strong></td><td style="text-align:left">Policy violations will trigger the addition of an audit annotation to the event recorded in the <a href="/docs/tasks/debug/debug-cluster/audit/">audit log</a>, but are otherwise allowed.</td></tr><tr><td style="text-align:left"><strong>warn</strong></td><td style="text-align:left">Policy violations will trigger a user-facing warning, but are otherwise allowed.</td></tr></tbody></table><p>A namespace can configure any or all modes, or even set a different level for different modes.</p><p>For each mode, there are two labels that determine the policy used:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:#080;font-style:italic"># The per-mode level label indicates which policy level to apply for the mode.</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:#080;font-style:italic">#</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:#080;font-style:italic"># MODE must be one of `enforce`, `audit`, or `warn`.</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:#080;font-style:italic"># LEVEL must be one of `privileged`, `baseline`, or `restricted`.</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">pod-security.kubernetes.io/&lt;MODE&gt;</span>:<span style="color:#bbb"> </span>&lt;LEVEL&gt;<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:#080;font-style:italic"># Optional: per-mode version label that can be used to pin the policy to the</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:#080;font-style:italic"># version that shipped with a given Kubernetes minor version (for example v1.34).</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:#080;font-style:italic">#</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:#080;font-style:italic"># MODE must be one of `enforce`, `audit`, or `warn`.</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:#080;font-style:italic"># VERSION must be a valid Kubernetes minor version, or `latest`.</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">pod-security.kubernetes.io/&lt;MODE&gt;-version</span>:<span style="color:#bbb"> </span>&lt;VERSION&gt;<span style="color:#bbb">
</span></span></span></code></pre></div><p>Check out <a href="/docs/tasks/configure-pod-container/enforce-standards-namespace-labels/">Enforce Pod Security Standards with Namespace Labels</a> to see example usage.</p><h2 id="workload-resources-and-pod-templates">Workload resources and Pod templates</h2><p>Pods are often created indirectly, by creating a <a href="/docs/concepts/workloads/controllers/">workload
object</a> such as a <a class="glossary-tooltip" title="Manages a replicated application on your cluster." data-toggle="tooltip" data-placement="top" href="/docs/concepts/workloads/controllers/deployment/" target="_blank" aria-label="Deployment">Deployment</a> or <a class="glossary-tooltip" title="A finite or batch task that runs to completion." data-toggle="tooltip" data-placement="top" href="/docs/concepts/workloads/controllers/job/" target="_blank" aria-label="Job">Job</a>. The workload object defines a
<em>Pod template</em> and a <a class="glossary-tooltip" title="A control loop that watches the shared state of the cluster through the apiserver and makes changes attempting to move the current state towards the desired state." data-toggle="tooltip" data-placement="top" href="/docs/concepts/architecture/controller/" target="_blank" aria-label="controller">controller</a> for the
workload resource creates Pods based on that template. To help catch violations early, both the
audit and warning modes are applied to the workload resources. However, enforce mode is <strong>not</strong>
applied to workload resources, only to the resulting pod objects.</p><h2 id="exemptions">Exemptions</h2><p>You can define <em>exemptions</em> from pod security enforcement in order to allow the creation of pods that
would have otherwise been prohibited due to the policy associated with a given namespace.
Exemptions can be statically configured in the
<a href="/docs/tasks/configure-pod-container/enforce-standards-admission-controller/#configure-the-admission-controller">Admission Controller configuration</a>.</p><p>Exemptions must be explicitly enumerated. Requests meeting exemption criteria are <em>ignored</em> by the
Admission Controller (all <code>enforce</code>, <code>audit</code> and <code>warn</code> behaviors are skipped). Exemption dimensions include:</p><ul><li><strong>Usernames:</strong> requests from users with an exempt authenticated (or impersonated) username are
ignored.</li><li><strong>RuntimeClassNames:</strong> pods and <a href="#workload-resources-and-pod-templates">workload resources</a> specifying an exempt runtime class name are
ignored.</li><li><strong>Namespaces:</strong> pods and <a href="#workload-resources-and-pod-templates">workload resources</a> in an exempt namespace are ignored.</li></ul><div class="alert alert-caution" role="alert"><h4 class="alert-heading">Caution:</h4>Most pods are created by a controller in response to a <a href="#workload-resources-and-pod-templates">workload
resource</a>, meaning that exempting an end user will only
exempt them from enforcement when creating pods directly, but not when creating a workload resource.
Controller service accounts (such as <code>system:serviceaccount:kube-system:replicaset-controller</code>)
should generally not be exempted, as doing so would implicitly exempt any user that can create the
corresponding workload resource.</div><p>Updates to the following pod fields are exempt from policy checks, meaning that if a pod update
request only changes these fields, it will not be denied even if the pod is in violation of the
current policy level:</p><ul><li>Any metadata updates <strong>except</strong> changes to the seccomp or AppArmor annotations:<ul><li><code>seccomp.security.alpha.kubernetes.io/pod</code> (deprecated)</li><li><code>container.seccomp.security.alpha.kubernetes.io/*</code> (deprecated)</li><li><code>container.apparmor.security.beta.kubernetes.io/*</code> (deprecated)</li></ul></li><li>Valid updates to <code>.spec.activeDeadlineSeconds</code></li><li>Valid updates to <code>.spec.tolerations</code></li></ul><h2 id="metrics">Metrics</h2><p>Here are the Prometheus metrics exposed by kube-apiserver:</p><ul><li><code>pod_security_errors_total</code>: This metric indicates the number of errors preventing normal evaluation.
Non-fatal errors may result in the latest restricted profile being used for enforcement.</li><li><code>pod_security_evaluations_total</code>: This metric indicates the number of policy evaluations that have occurred,
not counting ignored or exempt requests during exporting.</li><li><code>pod_security_exemptions_total</code>: This metric indicates the number of exempt requests, not counting ignored
or out of scope requests.</li></ul><h2 id="what-s-next">What's next</h2><ul><li><a href="/docs/concepts/security/pod-security-standards/">Pod Security Standards</a></li><li><a href="/docs/setup/best-practices/enforcing-pod-security-standards/">Enforcing Pod Security Standards</a></li><li><a href="/docs/tasks/configure-pod-container/enforce-standards-admission-controller/">Enforce Pod Security Standards by Configuring the Built-in Admission Controller</a></li><li><a href="/docs/tasks/configure-pod-container/enforce-standards-namespace-labels/">Enforce Pod Security Standards with Namespace Labels</a></li></ul><p>If you are running an older version of Kubernetes and want to upgrade
to a version of Kubernetes that does not include PodSecurityPolicies,
read <a href="/docs/tasks/configure-pod-container/migrate-from-psp/">migrate from PodSecurityPolicy to the Built-In PodSecurity Admission Controller</a>.</p></div>