<div class="td-content"><h1 data-pagefind-weight="10">Application Security Checklist</h1><div class="lead">Baseline guidelines around ensuring application security on Kubernetes, aimed at application developers</div><p>This checklist aims to provide basic guidelines on securing applications
running in Kubernetes from a developer's perspective.
This list is not meant to be exhaustive and is intended to evolve over time.</p><p>On how to read and use this document:</p><ul><li>The order of topics does not reflect an order of priority.</li><li>Some checklist items are detailed in the paragraph below the list of each section.</li><li>This checklist assumes that a <code>developer</code> is a Kubernetes cluster user who
interacts with namespaced scope objects.</li></ul><div class="alert alert-caution" role="alert"><h4 class="alert-heading">Caution:</h4>Checklists are <strong>not</strong> sufficient for attaining a good security posture on their own.
A good security posture requires constant attention and improvement, but a checklist
can be the first step on the never-ending journey towards security preparedness.
Some recommendations in this checklist may be too restrictive or too lax for
your specific security needs. Since Kubernetes security is not "one size fits all",
each category of checklist items should be evaluated on its merits.</div><h2 id="base-security-hardening">Base security hardening</h2><p>The following checklist provides base security hardening recommendations that
would apply to most applications deploying to Kubernetes.</p><h3 id="application-design">Application design</h3><ul><li><input disabled="" type="checkbox"/> Follow the right
<a href="https://www.cncf.io/wp-content/uploads/2022/06/CNCF_cloud-native-security-whitepaper-May2022-v2.pdf">security principles</a>
when designing applications.</li><li><input disabled="" type="checkbox"/> Application configured with appropriate <a class="glossary-tooltip" title="QoS Class (Quality of Service Class) provides a way for Kubernetes to classify pods within the cluster into several classes and make decisions about scheduling and eviction." data-toggle="tooltip" data-placement="top" href="/docs/concepts/workloads/pods/pod-qos/" target="_blank" aria-label="QoS class">QoS class</a>
through resource request and limits.<ul><li><input disabled="" type="checkbox"/> Memory limit is set for the workloads with a limit equal to or greater than the request.</li><li><input disabled="" type="checkbox"/> CPU limit might be set on sensitive workloads.</li></ul></li></ul><h3 id="service-account">Service account</h3><ul><li><input disabled="" type="checkbox"/> Avoid using the <code>default</code> ServiceAccount. Instead, create ServiceAccounts for
each workload or microservice.</li><li><input disabled="" type="checkbox"/> <code>automountServiceAccountToken</code> should be set to <code>false</code> unless the pod
specifically requires access to the Kubernetes API to operate.</li></ul><h3 id="security-context-pod">Pod-level <code>securityContext</code> recommendations</h3><ul><li><input disabled="" type="checkbox"/> Set <code>runAsNonRoot: true</code>.</li><li><input disabled="" type="checkbox"/> Configure the container to execute as a less privileged user
(for example, using <code>runAsUser</code> and <code>runAsGroup</code>), and configure appropriate
permissions on files or directories inside the container image.</li><li><input disabled="" type="checkbox"/> Optionally add a supplementary group with <code>fsGroup</code> to access persistent volumes.</li><li><input disabled="" type="checkbox"/> The application deploys into a namespace that enforces an appropriate
<a href="/docs/concepts/security/pod-security-standards/">Pod security standard</a>.
If you cannot control this enforcement for the cluster(s) where the application is
deployed, take this into account either through documentation or additional defense in depth.</li></ul><h3 id="security-context-container">Container-level <code>securityContext</code> recommendations</h3><ul><li><input disabled="" type="checkbox"/> Disable privilege escalations using <code>allowPrivilegeEscalation: false</code>.</li><li><input disabled="" type="checkbox"/> Configure the root filesystem to be read-only with <code>readOnlyRootFilesystem: true</code>.</li><li><input disabled="" type="checkbox"/> Avoid running privileged containers (set <code>privileged: false</code>).</li><li><input disabled="" type="checkbox"/> Drop all capabilities from the containers and add back only specific ones
that are needed for operation of the container.</li></ul><h3 id="rbac">Role Based Access Control (RBAC)</h3><ul><li><input disabled="" type="checkbox"/> Permissions such as <strong>create</strong>, <strong>patch</strong>, <strong>update</strong> and <strong>delete</strong>
should be only granted if necessary.</li><li><input disabled="" type="checkbox"/> Avoid creating RBAC permissions to create or update roles which can lead to
<a href="/docs/reference/access-authn-authz/rbac/#privilege-escalation-prevention-and-bootstrapping">privilege escalation</a>.</li><li><input disabled="" type="checkbox"/> Review bindings for the <code>system:unauthenticated</code> group and remove them where
possible, as this gives access to anyone who can contact the API server at a network level.</li></ul><p>The <strong>create</strong>, <strong>update</strong> and <strong>delete</strong> verbs should be permitted judiciously.
The <strong>patch</strong> verb if allowed on a Namespace can
<a href="/docs/concepts/security/rbac-good-practices/#namespace-modification">allow users to update labels on the namespace or deployments</a>
which can increase the attack surface.</p><p>For sensitive workloads, consider providing a recommended ValidatingAdmissionPolicy
that further restricts the permitted write actions.</p><h3 id="image-security">Image security</h3><ul><li><input disabled="" type="checkbox"/> Using an image scanning tool to scan an image before deploying containers in the Kubernetes cluster.</li><li><input disabled="" type="checkbox"/> Use container signing to validate the container image signature before deploying to the Kubernetes cluster.</li></ul><h3 id="network-policies">Network policies</h3><ul><li><input disabled="" type="checkbox"/> Configure <a href="/docs/concepts/services-networking/network-policies/">NetworkPolicies</a>
to only allow expected ingress and egress traffic from the pods.</li></ul><p>Make sure that your cluster provides and enforces NetworkPolicy.
If you are writing an application that users will deploy to different clusters,
consider whether you can assume that NetworkPolicy is available and enforced.</p><h2 id="advanced">Advanced security hardening</h2><p>This section of this guide covers some advanced security hardening points
which might be valuable based on different Kubernetes environment setup.</p><h3 id="linux-container-security">Linux container security</h3><p>Configure <a class="glossary-tooltip" title="The securityContext field defines privilege and access control settings for a Pod or container." data-toggle="tooltip" data-placement="top" href="/docs/tasks/configure-pod-container/security-context/" target="_blank" aria-label="Security Context">Security Context</a>
for the pod-container.</p><ul><li><input disabled="" type="checkbox"/> <a href="/docs/tasks/configure-pod-container/security-context/#set-the-seccomp-profile-for-a-container">Set the Seccomp Profile for a Container</a>.</li><li><input disabled="" type="checkbox"/> <a href="/docs/tutorials/security/apparmor/">Restrict a Container's Access to Resources with AppArmor</a>.</li><li><input disabled="" type="checkbox"/> <a href="/docs/tasks/configure-pod-container/security-context/#assign-selinux-labels-to-a-container">Assign SELinux Labels to a Container</a>.</li></ul><h3 id="runtime-classes">Runtime classes</h3><ul><li><input disabled="" type="checkbox"/> Configure appropriate runtime classes for containers.</li></ul><div class="alert alert-secondary callout third-party-content" role="alert"><strong>Note:</strong>â€ˆThis section links to third party projects that provide functionality required by Kubernetes. The Kubernetes project authors aren't responsible for these projects, which are listed alphabetically. To add a project to this list, read the <a href="/docs/contribute/style/content-guide/#third-party-content">content guide</a> before submitting a change. <a href="#third-party-content-disclaimer">More information.</a></div><p>Some containers may require a different isolation level from what is provided by
the default runtime of the cluster. <code>runtimeClassName</code> can be used in a podspec
to define a different runtime class.</p><p>For sensitive workloads consider using kernel emulation tools like
<a href="https://gvisor.dev/docs/">gVisor</a>, or virtualized isolation using a mechanism
such as <a href="https://katacontainers.io/">kata-containers</a>.</p><p>In high trust environments, consider using
<a href="/blog/2023/07/06/confidential-kubernetes/">confidential virtual machines</a>
to improve cluster security even further.</p></div>