<div class="td-content"><h1 data-pagefind-weight="10">Node-specific Volume Limits</h1><p>This page describes the maximum number of volumes that can be attached
to a Node for various cloud providers.</p><p>Cloud providers like Google, Amazon, and Microsoft typically have a limit on
how many volumes can be attached to a Node. It is important for Kubernetes to
respect those limits. Otherwise, Pods scheduled on a Node could get stuck
waiting for volumes to attach.</p><h2 id="kubernetes-default-limits">Kubernetes default limits</h2><p>The Kubernetes scheduler has default limits on the number of volumes
that can be attached to a Node:</p><table><tr><th>Cloud service</th><th>Maximum volumes per Node</th></tr><tr><td><a href="https://aws.amazon.com/ebs/">Amazon Elastic Block Store (EBS)</a></td><td>39</td></tr><tr><td><a href="https://cloud.google.com/persistent-disk/">Google Persistent Disk</a></td><td>16</td></tr><tr><td><a href="https://azure.microsoft.com/en-us/services/storage/main-disks/">Microsoft Azure Disk Storage</a></td><td>16</td></tr></table><h2 id="dynamic-volume-limits">Dynamic volume limits</h2><div class="feature-state-notice feature-stable"><span class="feature-state-name">FEATURE STATE:</span>
<code>Kubernetes v1.17 [stable]</code></div><p>Dynamic volume limits are supported for following volume types.</p><ul><li>Amazon EBS</li><li>Google Persistent Disk</li><li>Azure Disk</li><li>CSI</li></ul><p>For volumes managed by in-tree volume plugins, Kubernetes automatically determines the Node
type and enforces the appropriate maximum number of volumes for the node. For example:</p><ul><li><p>On
<a href="https://cloud.google.com/compute/">Google Compute Engine</a>,
up to 127 volumes can be attached to a node, <a href="https://cloud.google.com/compute/docs/disks/#pdnumberlimits">depending on the node
type</a>.</p></li><li><p>For Amazon EBS disks on M5,C5,R5,T3 and Z1D instance types, Kubernetes allows only 25
volumes to be attached to a Node. For other instance types on
<a href="https://aws.amazon.com/ec2/">Amazon Elastic Compute Cloud (EC2)</a>,
Kubernetes allows 39 volumes to be attached to a Node.</p></li><li><p>On Azure, up to 64 disks can be attached to a node, depending on the node type. For more details, refer to <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sizes">Sizes for virtual machines in Azure</a>.</p></li><li><p>If a CSI storage driver advertises a maximum number of volumes for a Node (using <code>NodeGetInfo</code>), the <a class="glossary-tooltip" title="Control plane component that watches for newly created pods with no assigned node, and selects a node for them to run on." data-toggle="tooltip" data-placement="top" href="/docs/reference/command-line-tools-reference/kube-scheduler/" target="_blank" aria-label="kube-scheduler">kube-scheduler</a> honors that limit.
Refer to the <a href="https://github.com/container-storage-interface/spec/blob/master/spec.md#nodegetinfo">CSI specifications</a> for details.</p></li><li><p>For volumes managed by in-tree plugins that have been migrated to a CSI driver, the maximum number of volumes will be the one reported by the CSI driver.</p></li></ul><h3 id="mutable-csi-node-allocatable-count">Mutable CSI Node Allocatable Count</h3><div class="feature-state-notice feature-beta" title="Feature Gate: MutableCSINodeAllocatableCount"><span class="feature-state-name">FEATURE STATE:</span>
<code>Kubernetes v1.34 [beta]</code> (enabled by default: false)</div><p>CSI drivers can dynamically adjust the maximum number of volumes that can be attached to a Node at runtime. This enhances scheduling accuracy and reduces pod scheduling failures due to changes in resource availability.</p><p>To use this feature, you must enable the <code>MutableCSINodeAllocatableCount</code> feature gate on the following components:</p><ul><li><code>kube-apiserver</code></li><li><code>kubelet</code></li></ul><h4 id="periodic-updates">Periodic Updates</h4><p>When enabled, CSI drivers can request periodic updates to their volume limits by setting the <code>nodeAllocatableUpdatePeriodSeconds</code> field in the <code>CSIDriver</code> specification. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>storage.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>CSIDriver<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>hostpath.csi.k8s.io<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">nodeAllocatableUpdatePeriodSeconds</span>:<span style="color:#bbb"> </span><span style="color:#666">60</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>Kubelet will periodically call the corresponding CSI driverâ€™s <code>NodeGetInfo</code> endpoint to refresh the maximum number of attachable volumes, using the interval specified in <code>nodeAllocatableUpdatePeriodSeconds</code>. The minimum allowed value for this field is 10 seconds.</p><p>If a volume attachment operation fails with a <code>ResourceExhausted</code> error (gRPC code 8), Kubernetes triggers an immediate update to the allocatable volume count for that Node. Additionally, kubelet marks affected pods as Failed, allowing their controllers to handle recreation. This prevents pods from getting stuck indefinitely in the <code>ContainerCreating</code> state.</p></div>