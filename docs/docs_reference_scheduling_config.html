<div class="td-content"><h1 data-pagefind-weight="10">Scheduler Configuration</h1><div class="feature-state-notice feature-stable"><span class="feature-state-name">FEATURE STATE:</span>
<code>Kubernetes v1.25 [stable]</code></div><p>You can customize the behavior of the <code>kube-scheduler</code> by writing a configuration
file and passing its path as a command line argument.</p><p>A scheduling Profile allows you to configure the different stages of scheduling
in the <a class="glossary-tooltip" title="Control plane component that watches for newly created pods with no assigned node, and selects a node for them to run on." data-toggle="tooltip" data-placement="top" href="/docs/reference/command-line-tools-reference/kube-scheduler/" target="_blank" aria-label="kube-scheduler">kube-scheduler</a>.
Each stage is exposed in an extension point. Plugins provide scheduling behaviors
by implementing one or more of these extension points.</p><p>You can specify scheduling profiles by running <code>kube-scheduler --config &lt;filename&gt;</code>,
using the
KubeSchedulerConfiguration <a href="/docs/reference/config-api/kube-scheduler-config.v1/">v1</a>
struct.</p><p>A minimal configuration looks as follows:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>kubescheduler.config.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>KubeSchedulerConfiguration<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">clientConnection</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">kubeconfig</span>:<span style="color:#bbb"> </span>/etc/srv/kubernetes/kube-scheduler/kubeconfig<span style="color:#bbb">
</span></span></span></code></pre></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>KubeSchedulerConfiguration v1beta3 is deprecated in v1.26 and is removed in v1.29.
Please migrate KubeSchedulerConfiguration to <a href="/docs/reference/config-api/kube-scheduler-config.v1/">v1</a>.</div><h2 id="profiles">Profiles</h2><p>A scheduling Profile allows you to configure the different stages of scheduling
in the <a class="glossary-tooltip" title="Control plane component that watches for newly created pods with no assigned node, and selects a node for them to run on." data-toggle="tooltip" data-placement="top" href="/docs/reference/command-line-tools-reference/kube-scheduler/" target="_blank" aria-label="kube-scheduler">kube-scheduler</a>.
Each stage is exposed in an <a href="#extension-points">extension point</a>.
<a href="#scheduling-plugins">Plugins</a> provide scheduling behaviors by implementing one
or more of these extension points.</p><p>You can configure a single instance of <code>kube-scheduler</code> to run
<a href="#multiple-profiles">multiple profiles</a>.</p><h3 id="extension-points">Extension points</h3><p>Scheduling happens in a series of stages that are exposed through the following
extension points:</p><ol><li><code>queueSort</code>: These plugins provide an ordering function that is used to
sort pending Pods in the scheduling queue. Exactly one queue sort plugin
may be enabled at a time.</li><li><code>preFilter</code>: These plugins are used to pre-process or check information
about a Pod or the cluster before filtering. They can mark a pod as
unschedulable.</li><li><code>filter</code>: These plugins are the equivalent of Predicates in a scheduling
Policy and are used to filter out nodes that can not run the Pod. Filters
are called in the configured order. A pod is marked as unschedulable if no
nodes pass all the filters.</li><li><code>postFilter</code>: These plugins are called in their configured order when no
feasible nodes were found for the pod. If any <code>postFilter</code> plugin marks the
Pod <em>schedulable</em>, the remaining plugins are not called.</li><li><code>preScore</code>: This is an informational extension point that can be used
for doing pre-scoring work.</li><li><code>score</code>: These plugins provide a score to each node that has passed the
filtering phase. The scheduler will then select the node with the highest
weighted scores sum.</li><li><code>reserve</code>: This is an informational extension point that notifies plugins
when resources have been reserved for a given Pod. Plugins also implement an
<code>Unreserve</code> call that gets called in the case of failure during or after
<code>Reserve</code>.</li><li><code>permit</code>: These plugins can prevent or delay the binding of a Pod.</li><li><code>preBind</code>: These plugins perform any work required before a Pod is bound.</li><li><code>bind</code>: The plugins bind a Pod to a Node. <code>bind</code> plugins are called in order
and once one has done the binding, the remaining plugins are skipped. At
least one bind plugin is required.</li><li><code>postBind</code>: This is an informational extension point that is called after
a Pod has been bound.</li><li><code>multiPoint</code>: This is a config-only field that allows plugins to be enabled
or disabled for all of their applicable extension points simultaneously.</li></ol><p>For each extension point, you could disable specific <a href="#scheduling-plugins">default plugins</a>
or enable your own. For example:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>kubescheduler.config.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>KubeSchedulerConfiguration<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">profiles</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">plugins</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">score</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">disabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>PodTopologySpread<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">enabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MyCustomPluginA<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">weight</span>:<span style="color:#bbb"> </span><span style="color:#666">2</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MyCustomPluginB<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">weight</span>:<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>You can use <code>*</code> as name in the disabled array to disable all default plugins
for that extension point. This can also be used to rearrange plugins order, if
desired.</p><h3 id="scheduling-plugins">Scheduling plugins</h3><p>The following plugins, enabled by default, implement one or more of these
extension points:</p><ul><li><code>ImageLocality</code>: Favors nodes that already have the container images that the
Pod runs.
Extension points: <code>score</code>.</li><li><code>TaintToleration</code>: Implements
<a href="/docs/concepts/scheduling-eviction/taint-and-toleration/">taints and tolerations</a>.
Implements extension points: <code>filter</code>, <code>preScore</code>, <code>score</code>.</li><li><code>NodeName</code>: Checks if a Pod spec node name matches the current node.
Extension points: <code>filter</code>.</li><li><code>NodePorts</code>: Checks if a node has free ports for the requested Pod ports.
Extension points: <code>preFilter</code>, <code>filter</code>.</li><li><code>NodeAffinity</code>: Implements
<a href="/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector">node selectors</a>
and <a href="/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity">node affinity</a>.
Extension points: <code>filter</code>, <code>score</code>.</li><li><code>PodTopologySpread</code>: Implements
<a href="/docs/concepts/scheduling-eviction/topology-spread-constraints/">Pod topology spread</a>.
Extension points: <code>preFilter</code>, <code>filter</code>, <code>preScore</code>, <code>score</code>.</li><li><code>NodeUnschedulable</code>: Filters out nodes that have <code>.spec.unschedulable</code> set to
true.
Extension points: <code>filter</code>.</li><li><code>NodeResourcesFit</code>: Checks if the node has all the resources that the Pod is
requesting. The score can use one of three strategies: <code>LeastAllocated</code>
(default), <code>MostAllocated</code> and <code>RequestedToCapacityRatio</code>.
Extension points: <code>preFilter</code>, <code>filter</code>, <code>score</code>.</li><li><code>NodeResourcesBalancedAllocation</code>: Favors nodes that would obtain a more
balanced resource usage if the Pod is scheduled there.
Extension points: <code>score</code>.</li><li><code>VolumeBinding</code>: Checks if the node has or if it can bind the requested
<a class="glossary-tooltip" title="A directory containing data, accessible to the containers in a pod." data-toggle="tooltip" data-placement="top" href="/docs/concepts/storage/volumes/" target="_blank" aria-label="volumes">volumes</a>.
Extension points: <code>preFilter</code>, <code>filter</code>, <code>reserve</code>, <code>preBind</code>, <code>score</code>.<div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4><code>score</code> extension point is enabled when <code>StorageCapacityScoring</code> feature is
enabled. It prioritizes the smallest PVs that can fit the requested volume
size.</div></li><li><code>VolumeRestrictions</code>: Checks that volumes mounted in the node satisfy
restrictions that are specific to the volume provider.
Extension points: <code>filter</code>.</li><li><code>VolumeZone</code>: Checks that volumes requested satisfy any zone requirements they
might have.
Extension points: <code>filter</code>.</li><li><code>NodeVolumeLimits</code>: Checks that CSI volume limits can be satisfied for the
node.
Extension points: <code>filter</code>.</li><li><code>EBSLimits</code>: Checks that AWS EBS volume limits can be satisfied for the node.
Extension points: <code>filter</code>.</li><li><code>GCEPDLimits</code>: Checks that GCP-PD volume limits can be satisfied for the node.
Extension points: <code>filter</code>.</li><li><code>AzureDiskLimits</code>: Checks that Azure disk volume limits can be satisfied for
the node.
Extension points: <code>filter</code>.</li><li><code>InterPodAffinity</code>: Implements
<a href="/docs/concepts/scheduling-eviction/assign-pod-node/#inter-pod-affinity-and-anti-affinity">inter-Pod affinity and anti-affinity</a>.
Extension points: <code>preFilter</code>, <code>filter</code>, <code>preScore</code>, <code>score</code>.</li><li><code>PrioritySort</code>: Provides the default priority based sorting.
Extension points: <code>queueSort</code>.</li><li><code>DefaultBinder</code>: Provides the default binding mechanism.
Extension points: <code>bind</code>.</li><li><code>DefaultPreemption</code>: Provides the default preemption mechanism.
Extension points: <code>postFilter</code>.</li></ul><p>You can also enable the following plugins, through the component config APIs,
that are not enabled by default:</p><ul><li><code>CinderLimits</code>: Checks that <a href="https://docs.openstack.org/cinder/">OpenStack Cinder</a>
volume limits can be satisfied for the node.
Extension points: <code>filter</code>.</li></ul><h3 id="multiple-profiles">Multiple profiles</h3><p>You can configure <code>kube-scheduler</code> to run more than one profile.
Each profile has an associated scheduler name and can have a different set of
plugins configured in its <a href="#extension-points">extension points</a>.</p><p>With the following sample configuration, the scheduler will run with two
profiles: one with the default plugins and one with all scoring plugins
disabled.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>kubescheduler.config.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>KubeSchedulerConfiguration<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">profiles</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">schedulerName</span>:<span style="color:#bbb"> </span>default-scheduler<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">schedulerName</span>:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:700">no</span>-scoring-scheduler<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">plugins</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">preScore</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">disabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'*'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">score</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">disabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'*'</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>Pods that want to be scheduled according to a specific profile can include
the corresponding scheduler name in its <code>.spec.schedulerName</code>.</p><p>By default, one profile with the scheduler name <code>default-scheduler</code> is created.
This profile includes the default plugins described above. When declaring more
than one profile, a unique scheduler name for each of them is required.</p><p>If a Pod doesn't specify a scheduler name, kube-apiserver will set it to
<code>default-scheduler</code>. Therefore, a profile with this scheduler name should exist
to get those pods scheduled.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4><p>Pod's scheduling events have <code>.spec.schedulerName</code> as their <code>reportingController</code>.
Events for leader election use the scheduler name of the first profile in the list.</p><p>For more information, please refer to the <code>reportingController</code> section under
<a href="/docs/reference/kubernetes-api/cluster-resources/event-v1/">Event API Reference</a>.</p></div><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>All profiles must use the same plugin in the <code>queueSort</code> extension point and have
the same configuration parameters (if applicable). This is because the scheduler
only has one pending pods queue.</div><h3 id="multipoint">Plugins that apply to multiple extension points</h3><p>Starting from <code>kubescheduler.config.k8s.io/v1beta3</code>, there is an additional field in the
profile config, <code>multiPoint</code>, which allows for easily enabling or disabling a plugin
across several extension points. The intent of <code>multiPoint</code> config is to simplify the
configuration needed for users and administrators when using custom profiles.</p><p>Consider a plugin, <code>MyPlugin</code>, which implements the <code>preScore</code>, <code>score</code>, <code>preFilter</code>,
and <code>filter</code> extension points. To enable <code>MyPlugin</code> for all its available extension
points, the profile config looks like:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>kubescheduler.config.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>KubeSchedulerConfiguration<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">profiles</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">schedulerName</span>:<span style="color:#bbb"> </span>multipoint-scheduler<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">plugins</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">multiPoint</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">enabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MyPlugin<span style="color:#bbb">
</span></span></span></code></pre></div><p>This would equate to manually enabling <code>MyPlugin</code> for all of its extension
points, like so:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>kubescheduler.config.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>KubeSchedulerConfiguration<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">profiles</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">schedulerName</span>:<span style="color:#bbb"> </span>non-multipoint-scheduler<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">plugins</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">preScore</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">enabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MyPlugin<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">score</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">enabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MyPlugin<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">preFilter</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">enabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MyPlugin<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">filter</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">enabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>MyPlugin<span style="color:#bbb">
</span></span></span></code></pre></div><p>One benefit of using <code>multiPoint</code> here is that if <code>MyPlugin</code> implements another
extension point in the future, the <code>multiPoint</code> config will automatically enable it
for the new extension.</p><p>Specific extension points can be excluded from <code>MultiPoint</code> expansion using
the <code>disabled</code> field for that extension point. This works with disabling default
plugins, non-default plugins, or with the wildcard (<code>'*'</code>) to disable all plugins.
An example of this, disabling <code>Score</code> and <code>PreScore</code>, would be:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>kubescheduler.config.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>KubeSchedulerConfiguration<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">profiles</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">schedulerName</span>:<span style="color:#bbb"> </span>non-multipoint-scheduler<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">plugins</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">multiPoint</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">enabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'MyPlugin'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">preScore</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">disabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'*'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">score</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">disabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'*'</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>Starting from <code>kubescheduler.config.k8s.io/v1beta3</code>, all <a href="#scheduling-plugins">default plugins</a>
are enabled internally through <code>MultiPoint</code>.
However, individual extension points are still available to allow flexible
reconfiguration of the default values (such as ordering and Score weights). For
example, consider two Score plugins <code>DefaultScore1</code> and <code>DefaultScore2</code>, each with
a weight of <code>1</code>. They can be reordered with different weights like so:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>kubescheduler.config.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>KubeSchedulerConfiguration<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">profiles</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">schedulerName</span>:<span style="color:#bbb"> </span>multipoint-scheduler<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">plugins</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">score</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">enabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'DefaultScore2'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">weight</span>:<span style="color:#bbb"> </span><span style="color:#666">5</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>In this example, it's unnecessary to specify the plugins in <code>MultiPoint</code> explicitly
because they are default plugins. And the only plugin specified in <code>Score</code> is <code>DefaultScore2</code>.
This is because plugins set through specific extension points will always take precedence
over <code>MultiPoint</code> plugins. So, this snippet essentially re-orders the two plugins
without needing to specify both of them.</p><p>The general hierarchy for precedence when configuring <code>MultiPoint</code> plugins is as follows:</p><ol><li>Specific extension points run first, and their settings override whatever is set elsewhere</li><li>Plugins manually configured through <code>MultiPoint</code> and their settings</li><li>Default plugins and their default settings</li></ol><p>To demonstrate the above hierarchy, the following example is based on these plugins:</p><table><thead><tr><th>Plugin</th><th>Extension Points</th></tr></thead><tbody><tr><td><code>DefaultQueueSort</code></td><td><code>QueueSort</code></td></tr><tr><td><code>CustomQueueSort</code></td><td><code>QueueSort</code></td></tr><tr><td><code>DefaultPlugin1</code></td><td><code>Score</code>, <code>Filter</code></td></tr><tr><td><code>DefaultPlugin2</code></td><td><code>Score</code></td></tr><tr><td><code>CustomPlugin1</code></td><td><code>Score</code>, <code>Filter</code></td></tr><tr><td><code>CustomPlugin2</code></td><td><code>Score</code>, <code>Filter</code></td></tr></tbody></table><p>A valid sample configuration for these plugins would be:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>kubescheduler.config.k8s.io/v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>KubeSchedulerConfiguration<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">profiles</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">schedulerName</span>:<span style="color:#bbb"> </span>multipoint-scheduler<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">plugins</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">multiPoint</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">enabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'CustomQueueSort'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'CustomPlugin1'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">weight</span>:<span style="color:#bbb"> </span><span style="color:#666">3</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'CustomPlugin2'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">disabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'DefaultQueueSort'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">filter</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">disabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'DefaultPlugin1'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">score</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">enabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'DefaultPlugin2'</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>Note that there is no error for re-declaring a <code>MultiPoint</code> plugin in a specific
extension point. The re-declaration is ignored (and logged), as specific extension points
take precedence.</p><p>Besides keeping most of the config in one spot, this sample does a few things:</p><ul><li>Enables the custom <code>queueSort</code> plugin and disables the default one</li><li>Enables <code>CustomPlugin1</code> and <code>CustomPlugin2</code>, which will run first for all of their extension points</li><li>Disables <code>DefaultPlugin1</code>, but only for <code>filter</code></li><li>Reorders <code>DefaultPlugin2</code> to run first in <code>score</code> (even before the custom plugins)</li></ul><p>In versions of the config before <code>v1beta3</code>, without <code>multiPoint</code>, the above snippet would equate to this:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>kubescheduler.config.k8s.io/v1beta2<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>KubeSchedulerConfiguration<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">profiles</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">schedulerName</span>:<span style="color:#bbb"> </span>multipoint-scheduler<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">plugins</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:#080;font-style:italic"># Disable the default QueueSort plugin</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">queueSort</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">enabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'CustomQueueSort'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">disabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'DefaultQueueSort'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:#080;font-style:italic"># Enable custom Filter plugins</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">filter</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">enabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'CustomPlugin1'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'CustomPlugin2'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'DefaultPlugin2'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">disabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'DefaultPlugin1'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:#080;font-style:italic"># Enable and reorder custom score plugins</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">score</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">enabled</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'DefaultPlugin2'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">weight</span>:<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span><span style="color:#b44">'DefaultPlugin1'</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">weight</span>:<span style="color:#bbb"> </span><span style="color:#666">3</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>While this is a complicated example, it demonstrates the flexibility of <code>MultiPoint</code> config
as well as its seamless integration with the existing methods for configuring extension points.</p><h2 id="scheduler-configuration-migrations">Scheduler configuration migrations</h2><ul class="nav nav-tabs" id="tab-with-md" role="tablist"><li class="nav-item"><a data-toggle="tab" class="nav-link active" href="#tab-with-md-0" role="tab" aria-controls="tab-with-md-0" aria-selected="true">v1beta1 → v1beta2</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#tab-with-md-1" role="tab" aria-controls="tab-with-md-1">v1beta2 → v1beta3</a></li><li class="nav-item"><a data-toggle="tab" class="nav-link" href="#tab-with-md-2" role="tab" aria-controls="tab-with-md-2">v1beta3 → v1</a></li></ul><div class="tab-content" id="tab-with-md"><div id="tab-with-md-0" class="tab-pane show active" role="tabpanel" aria-labelledby="tab-with-md-0"><p><ul><li><p>With the v1beta2 configuration version, you can use a new score extension for the
<code>NodeResourcesFit</code> plugin.
The new extension combines the functionalities of the <code>NodeResourcesLeastAllocated</code>,
<code>NodeResourcesMostAllocated</code> and <code>RequestedToCapacityRatio</code> plugins.
For example, if you previously used the <code>NodeResourcesMostAllocated</code> plugin, you
would instead use <code>NodeResourcesFit</code> (enabled by default) and add a <code>pluginConfig</code>
with a <code>scoreStrategy</code> that is similar to:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>kubescheduler.config.k8s.io/v1beta2<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>KubeSchedulerConfiguration<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">profiles</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/>- <span style="color:green;font-weight:700">pluginConfig</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">args</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">scoringStrategy</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">resources</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>cpu<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">          </span><span style="color:green;font-weight:700">weight</span>:<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">type</span>:<span style="color:#bbb"> </span>MostAllocated<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>NodeResourcesFit<span style="color:#bbb">
</span></span></span></code></pre></div></li><li><p>The scheduler plugin <code>NodeLabel</code> is deprecated; instead, use the <a href="/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity"><code>NodeAffinity</code></a> plugin (enabled by default) to achieve similar behavior.</p></li><li><p>The scheduler plugin <code>ServiceAffinity</code> is deprecated; instead, use the <a href="/docs/concepts/scheduling-eviction/assign-pod-node/#inter-pod-affinity-and-anti-affinity"><code>InterPodAffinity</code></a> plugin (enabled by default) to achieve similar behavior.</p></li><li><p>The scheduler plugin <code>NodePreferAvoidPods</code> is deprecated; instead, use <a href="/docs/concepts/scheduling-eviction/taint-and-toleration/">node taints</a> to achieve similar behavior.</p></li><li><p>A plugin enabled in a v1beta2 configuration file takes precedence over the default configuration for that plugin.</p></li><li><p>Invalid <code>host</code> or <code>port</code> configured for scheduler healthz and metrics bind address will cause validation failure.</p></li></ul></p></div><div id="tab-with-md-1" class="tab-pane" role="tabpanel" aria-labelledby="tab-with-md-1"><p><ul><li>Three plugins' weight are increased by default:<ul><li><code>InterPodAffinity</code> from 1 to 2</li><li><code>NodeAffinity</code> from 1 to 2</li><li><code>TaintToleration</code> from 1 to 3</li></ul></li></ul></p></div><div id="tab-with-md-2" class="tab-pane" role="tabpanel" aria-labelledby="tab-with-md-2"><p><ul><li>The scheduler plugin <code>SelectorSpread</code> is removed, instead, use the <code>PodTopologySpread</code> plugin (enabled by default)
to achieve similar behavior.</li></ul></p></div></div><h2 id="what-s-next">What's next</h2><ul><li>Read the <a href="/docs/reference/command-line-tools-reference/kube-scheduler/">kube-scheduler reference</a></li><li>Learn about <a href="/docs/concepts/scheduling-eviction/kube-scheduler/">scheduling</a></li><li>Read the <a href="/docs/reference/config-api/kube-scheduler-config.v1/">kube-scheduler configuration (v1)</a> reference</li></ul></div>