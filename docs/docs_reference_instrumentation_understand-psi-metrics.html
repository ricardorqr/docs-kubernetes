<div class="td-content"><h1 data-pagefind-weight="10">Understand Pressure Stall Information (PSI) Metrics</h1><div class="lead">Detailed explanation of Pressure Stall Information (PSI) metrics and how to use them to identify resource pressure in Kubernetes.</div><div class="feature-state-notice feature-beta"><span class="feature-state-name">FEATURE STATE:</span>
<code>Kubernetes v1.34 [beta]</code></div><p>As a beta feature, Kubernetes lets you configure the kubelet to collect Linux kernel
<a href="https://docs.kernel.org/accounting/psi.html">Pressure Stall Information</a>
(PSI) for CPU, memory, and I/O usage. The information is collected at node, pod and container level.
This feature is enabled by default by setting the <code>KubeletPSI</code> <a href="/docs/reference/command-line-tools-reference/feature-gates/">feature gate</a>.</p><p>PSI metrics are exposed through two different sources:</p><ul><li>The kubelet's <a href="/docs/reference/config-api/kubelet-stats.v1alpha1/">Summary API</a>, which provides PSI data at the node, pod, and container level.</li><li>The <code>/metrics/cadvisor</code> endpoint on the kubelet, which exposes PSI metrics in the <a href="/docs/concepts/cluster-administration/system-metrics/#psi-metrics">Prometheus format</a>.</li></ul><h3 id="requirements">Requirements</h3><p>Pressure Stall Information requires the following on your Linux nodes:</p><ul><li>The Linux kernel must be version <strong>4.20 or newer</strong>.</li><li>The kernel must be compiled with the <code>CONFIG_PSI=y</code> option. Most modern distributions enable this by default. You can check your kernel's configuration by running <code>zgrep CONFIG_PSI /proc/config.gz</code>.</li><li>Some Linux distributions may compile PSI into the kernel but disable it by default. If so, you need to enable it at boot time by adding the <code>psi=1</code> parameter to the kernel command line.</li><li>The node must be using <a href="/docs/concepts/architecture/cgroups/">cgroup v2</a>.</li></ul><h2 id="understanding-psi-metrics">Understanding PSI Metrics</h2><p>Pressure Stall Information (PSI) metrics are provided for three resources: CPU, memory, and I/O. They are categorized into two main types of pressure: <code>some</code> and <code>full</code>.</p><ul><li><strong><code>some</code></strong>: This value indicates that some tasks (one or more) are stalled on a resource. For example, if some tasks are waiting for I/O, this metric will increase. This can be an early indicator of resource contention.</li><li><strong><code>full</code></strong>: This value indicates that <em>all</em> non-idle tasks are stalled on a resource simultaneously. This signifies a more severe resource shortage, where the entire system is unable to make progress.</li></ul><p>Each pressure type provides four metrics: <code>avg10</code>, <code>avg60</code>, <code>avg300</code>, and <code>total</code>. The <code>avg</code> values represent the percentage of wall-clock time that tasks were stalled over 10-second, 60-second, and 3-minute moving averages. The <code>total</code> value is a cumulative counter in microseconds showing the total time tasks have been stalled.</p><h2 id="example-scenarios">Example Scenarios</h2><p>You can use a simple Pod with a stress-testing tool to generate resource pressure and observe the PSI metrics. The following examples use the <code>agnhost</code> container image, which includes the <code>stress</code> tool.</p><h3 id="generating-cpu-pressure">Generating CPU Pressure</h3><p>Create a Pod that generates CPU pressure using the <code>stress</code> utility. This workload will put a heavy load on one CPU core.</p><p>Create a file named <code>cpu-pressure-pod.yaml</code>:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>cpu-pressure-pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">restartPolicy</span>:<span style="color:#bbb"> </span>Never<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>cpu-stress<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>registry.k8s.io/e2e-test-images/agnhost:2.47<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">args</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:#b44">"stress"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:#b44">"--cpus"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:#b44">"1"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">resources</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">limits</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">cpu</span>:<span style="color:#bbb"> </span><span style="color:#b44">"500m"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">requests</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">cpu</span>:<span style="color:#bbb"> </span><span style="color:#b44">"500m"</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>Apply it to your cluster: <code>kubectl apply -f cpu-pressure-pod.yaml</code></p><h4 id="observing-cpu-pressure">Observing CPU Pressure</h4><p>After the Pod is running, you can observe the CPU pressure through either the Summary API or the Prometheus metrics endpoint.</p><p><strong>Using the Summary API:</strong></p><p>Watch the summary stats for your node. In a separate terminal, run:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Replace &lt;node-name&gt; with the name of a node in your cluster</span>
</span></span><span style="display:flex"><span>kubectl get --raw <span style="color:#b44">"/api/v1/nodes/&lt;node-name&gt;/proxy/stats/summary"</span> | jq <span style="color:#b44">'.pods[] | select(.podRef.name | contains("cpu-pressure-pod"))'</span>
</span></span></code></pre></div><p>You will see the <code>some</code> PSI metrics for CPU increase in the summary API output. The <code>avg10</code> value for <code>some</code> pressure should rise above zero, indicating that tasks are spending time stalled on the CPU.</p><p><strong>Using the Prometheus metrics endpoint:</strong></p><p>Query the <code>/metrics/cadvisor</code> endpoint to see the <code>container_pressure_cpu_waiting_seconds_total</code> metric.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Replace &lt;node-name&gt; with the name of the node where the pod is running</span>
</span></span><span style="display:flex"><span>kubectl get --raw <span style="color:#b44">"/api/v1/nodes/&lt;node-name&gt;/proxy/metrics/cadvisor"</span> | <span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>    grep <span style="color:#b44">'container_pressure_cpu_waiting_seconds_total{container="cpu-stress"'</span>
</span></span></code></pre></div><p>The output should show an increasing value, indicating that the container is spending time stalled waiting for CPU resources.</p><h4 id="cleanup">Cleanup</h4><p>Clean up the Pod when you are finished:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl delete pod cpu-pressure-pod
</span></span></code></pre></div><h3 id="generating-memory-pressure">Generating Memory Pressure</h3><p>This example creates a Pod that continuously writes to files in the container's writable layer, causing the kernel's page cache to grow and forcing memory reclamation, which generates pressure.</p><p>Create a file named <code>memory-pressure-pod.yaml</code>:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>memory-pressure-pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">restartPolicy</span>:<span style="color:#bbb"> </span>Never<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>memory-stress<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>registry.k8s.io/e2e-test-images/agnhost:2.47<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">command</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"/bin/sh"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"-c"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">args</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span>- <span style="color:#b44">"i=0; while true; do dd if=/dev/zero of=testfile.$i bs=1M count=50 &amp;&gt;/dev/null; i=$(((i+1)%5)); sleep 0.1; done"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">resources</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">limits</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">memory</span>:<span style="color:#bbb"> </span><span style="color:#b44">"200M"</span><span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span><span style="color:green;font-weight:700">requests</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">        </span><span style="color:green;font-weight:700">memory</span>:<span style="color:#bbb"> </span><span style="color:#b44">"200M"</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>Apply it to your cluster: <code>kubectl apply -f memory-pressure-pod.yaml</code></p><h4 id="observing-memory-pressure">Observing Memory Pressure</h4><p><strong>Using the Summary API:</strong></p><p>In the summary output, you will observe an increase in the <code>full</code> PSI metrics for memory, indicating that the system is under significant memory pressure.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Replace &lt;node-name&gt; with the name of a node in your cluster</span>
</span></span><span style="display:flex"><span>kubectl get --raw <span style="color:#b44">"/api/v1/nodes/&lt;node-name&gt;/proxy/stats/summary"</span> | jq <span style="color:#b44">'.pods[] | select(.podRef.name | contains("memory-pressure-pod"))'</span>
</span></span></code></pre></div><p><strong>Using the Prometheus metrics endpoint:</strong></p><p>Query the <code>/metrics/cadvisor</code> endpoint to see the <code>container_pressure_memory_waiting_seconds_total</code> metric.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Replace &lt;node-name&gt; with the name of the node where the pod is running</span>
</span></span><span style="display:flex"><span>kubectl get --raw <span style="color:#b44">"/api/v1/nodes/&lt;node-name&gt;/proxy/metrics/cadvisor"</span> | <span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>    grep <span style="color:#b44">'container_pressure_memory_waiting_seconds_total{container="memory-stress"'</span>
</span></span></code></pre></div><p>In the output, you will observe an increasing value for the metric, indicating that the system is under significant memory pressure.</p><h4 id="cleanup-1">Cleanup</h4><p>Clean up the Pod when you are finished:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl delete pod memory-pressure-pod
</span></span></code></pre></div><h3 id="generating-i-o-pressure">Generating I/O Pressure</h3><p>This Pod generates I/O pressure by repeatedly writing a file to disk and using <code>sync</code> to flush the data from memory, which creates I/O stalls.</p><p>Create a file named <code>io-pressure-pod.yaml</code>:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="display:flex"><span><span style="color:green;font-weight:700">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">kind</span>:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>io-pressure-pod<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb"/><span style="color:green;font-weight:700">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">restartPolicy</span>:<span style="color:#bbb"> </span>Never<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span><span style="color:green;font-weight:700">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">  </span>- <span style="color:green;font-weight:700">name</span>:<span style="color:#bbb"> </span>io-stress<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">image</span>:<span style="color:#bbb"> </span>registry.k8s.io/e2e-test-images/agnhost:2.47<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">command</span>:<span style="color:#bbb"> </span>[<span style="color:#b44">"/bin/sh"</span>,<span style="color:#bbb"> </span><span style="color:#b44">"-c"</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">    </span><span style="color:green;font-weight:700">args</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex"><span><span style="color:#bbb">      </span>- <span style="color:#b44">"while true; do dd if=/dev/zero of=testfile bs=1M count=128 &amp;&gt;/dev/null; sync; rm testfile &amp;&gt;/dev/null; done"</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>Apply this to your cluster: <code>kubectl apply -f io-pressure-pod.yaml</code></p><h4 id="observing-i-o-pressure">Observing I/O Pressure</h4><p><strong>Using the Summary API:</strong></p><p>You will see the <code>some</code> PSI metrics for I/O increase as the Pod continuously writes to disk.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Replace &lt;node-name&gt; with the name of a node in your cluster</span>
</span></span><span style="display:flex"><span>kubectl get --raw <span style="color:#b44">"/api/v1/nodes/&lt;node-name&gt;/proxy/stats/summary"</span> | jq <span style="color:#b44">'.pods[] | select(.podRef.name | contains("io-pressure-pod"))'</span>
</span></span></code></pre></div><p><strong>Using the Prometheus metrics endpoint:</strong></p><p>Query the <code>/metrics/cadvisor</code> endpoint to see the <code>container_pressure_io_waiting_seconds_total</code> metric.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span><span style="color:#080;font-style:italic"># Replace &lt;node-name&gt; with the name of the node where the pod is running</span>
</span></span><span style="display:flex"><span>kubectl get --raw <span style="color:#b44">"/api/v1/nodes/&lt;node-name&gt;/proxy/metrics/cadvisor"</span> | <span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>    grep <span style="color:#b44">'container_pressure_io_waiting_seconds_total{container="io-stress"'</span>
</span></span></code></pre></div><p>You will see the metric's value increase as the Pod continuously writes to disk.</p><h4 id="cleanup-2">Cleanup</h4><p>Clean up the Pod when you are finished:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl delete pod io-pressure-pod
</span></span></code></pre></div><h2 id="what-s-next">What's next</h2><p>The task pages for <a href="/docs/tasks/debug/debug-cluster/">Troubleshooting Clusters</a> discuss
how to use a metrics pipeline that rely on these data.</p></div>