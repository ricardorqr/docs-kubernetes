<div class="td-content"><h1 data-pagefind-weight="10">Mapping PodSecurityPolicies to Pod Security Standards</h1><p>The tables below enumerate the configuration parameters on
<code>PodSecurityPolicy</code> objects, whether the field mutates
and/or validates pods, and how the configuration values map to the
<a href="/docs/concepts/security/pod-security-standards/">Pod Security Standards</a>.</p><p>For each applicable parameter, the allowed values for the
<a href="/docs/concepts/security/pod-security-standards/#baseline">Baseline</a> and
<a href="/docs/concepts/security/pod-security-standards/#restricted">Restricted</a> profiles are listed.
Anything outside the allowed values for those profiles would fall under the
<a href="/docs/concepts/security/pod-security-standards/#privileged">Privileged</a> profile. "No opinion"
means all values are allowed under all Pod Security Standards.</p><p>For a step-by-step migration guide, see
<a href="/docs/tasks/configure-pod-container/migrate-from-psp/">Migrate from PodSecurityPolicy to the Built-In PodSecurity Admission Controller</a>.</p><h2 id="podsecuritypolicy-spec">PodSecurityPolicy Spec</h2><p>The fields enumerated in this table are part of the <code>PodSecurityPolicySpec</code>, which is specified
under the <code>.spec</code> field path.</p><table class="no-word-break"><caption style="display:none">Mapping PodSecurityPolicySpec fields to Pod Security Standards</caption><tbody><tr><th><code>PodSecurityPolicySpec</code></th><th>Type</th><th>Pod Security Standards Equivalent</th></tr><tr><td><code>privileged</code></td><td>Validating</td><td><b>Baseline &amp; Restricted</b>: <code>false</code> / undefined / nil</td></tr><tr><td><code>defaultAddCapabilities</code></td><td>Mutating &amp; Validating</td><td>Requirements match <code>allowedCapabilities</code> below.</td></tr><tr><td><code>allowedCapabilities</code></td><td>Validating</td><td><p><b>Baseline</b>: subset of</p><ul><li><code>AUDIT_WRITE</code></li><li><code>CHOWN</code></li><li><code>DAC_OVERRIDE</code></li><li><code>FOWNER</code></li><li><code>FSETID</code></li><li><code>KILL</code></li><li><code>MKNOD</code></li><li><code>NET_BIND_SERVICE</code></li><li><code>SETFCAP</code></li><li><code>SETGID</code></li><li><code>SETPCAP</code></li><li><code>SETUID</code></li><li><code>SYS_CHROOT</code></li></ul><p><b>Restricted</b>: empty / undefined / nil OR a list containing <i>only</i> <code>NET_BIND_SERVICE</code></p></td></tr><tr><td><code>requiredDropCapabilities</code></td><td>Mutating &amp; Validating</td><td><p><b>Baseline</b>: no opinion</p><p><b>Restricted</b>: must include <code>ALL</code></p></td></tr><tr><td><code>volumes</code></td><td>Validating</td><td><p><b>Baseline</b>: anything except</p><ul><li><code>hostPath</code></li><li><code>*</code></li></ul><p><b>Restricted</b>: subset of</p><ul><li><code>configMap</code></li><li><code>csi</code></li><li><code>downwardAPI</code></li><li><code>emptyDir</code></li><li><code>ephemeral</code></li><li><code>persistentVolumeClaim</code></li><li><code>projected</code></li><li><code>secret</code></li></ul></td></tr><tr><td><code>hostNetwork</code></td><td>Validating</td><td><b>Baseline &amp; Restricted</b>: <code>false</code> / undefined / nil</td></tr><tr><td><code>hostPorts</code></td><td>Validating</td><td><b>Baseline &amp; Restricted</b>: undefined / nil / empty</td></tr><tr><td><code>hostPID</code></td><td>Validating</td><td><b>Baseline &amp; Restricted</b>: <code>false</code> / undefined / nil</td></tr><tr><td><code>hostIPC</code></td><td>Validating</td><td><b>Baseline &amp; Restricted</b>: <code>false</code> / undefined / nil</td></tr><tr><td><code>seLinux</code></td><td>Mutating &amp; Validating</td><td><p><b>Baseline &amp; Restricted</b>:
<code>seLinux.rule</code> is <code>MustRunAs</code>, with the following <code>options</code></p><ul><li><code>user</code> is unset (<code>""</code> / undefined / nil)</li><li><code>role</code> is unset (<code>""</code> / undefined / nil)</li><li><code>type</code> is unset or one of: <code>container_t, container_init_t, container_kvm_t, container_engine_t</code></li><li><code>level</code> is anything</li></ul></td></tr><tr><td><code>runAsUser</code></td><td>Mutating &amp; Validating</td><td><p><b>Baseline</b>: Anything</p><p><b>Restricted</b>: <code>rule</code> is <code>MustRunAsNonRoot</code></p></td></tr><tr><td><code>runAsGroup</code></td><td>Mutating (MustRunAs) &amp; Validating</td><td><i>No opinion</i></td></tr><tr><td><code>supplementalGroups</code></td><td>Mutating &amp; Validating</td><td><i>No opinion</i></td></tr><tr><td><code>fsGroup</code></td><td>Mutating &amp; Validating</td><td><i>No opinion</i></td></tr><tr><td><code>readOnlyRootFilesystem</code></td><td>Mutating &amp; Validating</td><td><i>No opinion</i></td></tr><tr><td><code>defaultAllowPrivilegeEscalation</code></td><td>Mutating</td><td><i>No opinion (non-validating)</i></td></tr><tr><td><code>allowPrivilegeEscalation</code></td><td>Mutating &amp; Validating</td><td><p><i>Only mutating if set to <code>false</code></i></p><p><b>Baseline</b>: No opinion</p><p><b>Restricted</b>: <code>false</code></p></td></tr><tr><td><code>allowedHostPaths</code></td><td>Validating</td><td><i>No opinion (volumes takes precedence)</i></td></tr><tr><td><code>allowedFlexVolumes</code></td><td>Validating</td><td><i>No opinion (volumes takes precedence)</i></td></tr><tr><td><code>allowedCSIDrivers</code></td><td>Validating</td><td><i>No opinion (volumes takes precedence)</i></td></tr><tr><td><code>allowedUnsafeSysctls</code></td><td>Validating</td><td><b>Baseline &amp; Restricted</b>: undefined / nil / empty</td></tr><tr><td><code>forbiddenSysctls</code></td><td>Validating</td><td><i>No opinion</i></td></tr><tr><td><code>allowedProcMountTypes</code><br/><i>(alpha feature)</i></td><td>Validating</td><td><b>Baseline &amp; Restricted</b>: <code>["Default"]</code> OR undefined / nil / empty</td></tr><tr><td><code>runtimeClass</code><br/><code> .defaultRuntimeClassName</code></td><td>Mutating</td><td><i>No opinion</i></td></tr><tr><td><code>runtimeClass</code><br/><code> .allowedRuntimeClassNames</code></td><td>Validating</td><td><i>No opinion</i></td></tr></tbody></table><h2 id="podsecuritypolicy-annotations">PodSecurityPolicy annotations</h2><p>The <a href="/docs/concepts/overview/working-with-objects/annotations/">annotations</a> enumerated in this
table can be specified under <code>.metadata.annotations</code> on the PodSecurityPolicy object.</p><table class="no-word-break"><caption style="display:none">Mapping PodSecurityPolicy annotations to Pod Security Standards</caption><tbody><tr><th><code>PSP Annotation</code></th><th>Type</th><th>Pod Security Standards Equivalent</th></tr><tr><td><code>seccomp.security.alpha.kubernetes.io</code><br/><code>/defaultProfileName</code></td><td>Mutating</td><td><i>No opinion</i></td></tr><tr><td><code>seccomp.security.alpha.kubernetes.io</code><br/><code>/allowedProfileNames</code></td><td>Validating</td><td><p><b>Baseline</b>: <code>"runtime/default,"</code> <i>(Trailing comma to allow unset)</i></p><p><b>Restricted</b>: <code>"runtime/default"</code> <i>(No trailing comma)</i></p><p><i><code>localhost/*</code> values are also permitted for both Baseline &amp; Restricted.</i></p></td></tr><tr><td><code>apparmor.security.beta.kubernetes.io</code><br/><code>/defaultProfileName</code></td><td>Mutating</td><td><i>No opinion</i></td></tr><tr><td><code>apparmor.security.beta.kubernetes.io</code><br/><code>/allowedProfileNames</code></td><td>Validating</td><td><p><b>Baseline</b>: <code>"runtime/default,"</code> <i>(Trailing comma to allow unset)</i></p><p><b>Restricted</b>: <code>"runtime/default"</code> <i>(No trailing comma)</i></p><p><i><code>localhost/*</code> values are also permitted for both Baseline &amp; Restricted.</i></p></td></tr></tbody></table></div>