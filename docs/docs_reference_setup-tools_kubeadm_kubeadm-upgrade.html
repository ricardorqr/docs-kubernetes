<div class="td-content"><h1 data-pagefind-weight="10">kubeadm upgrade</h1><p><code>kubeadm upgrade</code> is a user-friendly command that wraps complex upgrading logic
behind one command, with support for both planning an upgrade and actually performing it.</p><h2 id="kubeadm-upgrade-guidance">kubeadm upgrade guidance</h2><p>The steps for performing an upgrade using kubeadm are outlined in <a href="/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/">this document</a>.
For older versions of kubeadm, please refer to older documentation sets of the Kubernetes website.</p><p>You can use <code>kubeadm upgrade diff</code> to see the changes that would be applied to static pod manifests.</p><p>In Kubernetes v1.15.0 and later, <code>kubeadm upgrade apply</code> and <code>kubeadm upgrade node</code> will also
automatically renew the kubeadm managed certificates on this node, including those stored in kubeconfig files.
To opt-out, it is possible to pass the flag <code>--certificate-renewal=false</code>. For more details about certificate
renewal see the <a href="/docs/tasks/administer-cluster/kubeadm/kubeadm-certs/">certificate management documentation</a>.</p><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>The commands <code>kubeadm upgrade apply</code> and <code>kubeadm upgrade plan</code> have a legacy <code>--config</code>
flag which makes it possible to reconfigure the cluster, while performing planning or upgrade of that particular
control-plane node. Please be aware that the upgrade workflow was not designed for this scenario and there are
reports of unexpected results.</div><h2 id="cmd-upgrade-plan">kubeadm upgrade plan</h2><h3 id="synopsis">Synopsis</h3><p>Check which versions are available to upgrade to and validate whether your current cluster is upgradeable. This command can only run on the control plane nodes where the kubeconfig file "admin.conf" exists. To skip the internet check, pass in the optional [version] parameter.</p><pre tabindex="0"><code>kubeadm upgrade plan [version] [flags]
</code></pre><h3 id="options">Options</h3><table style="width:100%;table-layout:fixed"><col span="1" style="width:10px"/><col span="1"/><tbody><tr><td colspan="2">--allow-experimental-upgrades</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Show unstable versions of Kubernetes as an upgrade alternative and allow upgrading to an alpha/beta/release candidate versions of Kubernetes.</p></td></tr><tr><td colspan="2">--allow-missing-template-keys     Default: true</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>If true, ignore any errors in templates when a field or map key is missing in the template. Only applies to golang and jsonpath output formats.</p></td></tr><tr><td colspan="2">--allow-release-candidate-upgrades</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Show release candidate versions of Kubernetes as an upgrade alternative and allow upgrading to a release candidate versions of Kubernetes.</p></td></tr><tr><td colspan="2">--config string</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Path to a kubeadm configuration file.</p></td></tr><tr><td colspan="2">--etcd-upgrade     Default: true</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Perform the upgrade of etcd.</p></td></tr><tr><td colspan="2">-h, --help</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>help for plan</p></td></tr><tr><td colspan="2">--ignore-preflight-errors strings</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>A list of checks whose errors will be shown as warnings. Example: 'IsPrivilegedUser,Swap'. Value 'all' ignores errors from all checks.</p></td></tr><tr><td colspan="2">--kubeconfig string     Default: "/etc/kubernetes/admin.conf"</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>The kubeconfig file to use when talking to the cluster. If the flag is not set, a set of standard locations can be searched for an existing kubeconfig file.</p></td></tr><tr><td colspan="2">-o, --output string     Default: "text"</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Output format. One of: text|json|yaml|go-template|go-template-file|template|templatefile|jsonpath|jsonpath-as-json|jsonpath-file.</p></td></tr><tr><td colspan="2">--print-config</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Specifies whether the configuration file that will be used in the upgrade should be printed or not.</p></td></tr><tr><td colspan="2">--show-managed-fields</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>If true, keep the managedFields when printing objects in JSON or YAML format.</p></td></tr></tbody></table><h3 id="options-inherited-from-parent-commands">Options inherited from parent commands</h3><table style="width:100%;table-layout:fixed"><col span="1" style="width:10px"/><col span="1"/><tbody><tr><td colspan="2">--rootfs string</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>The path to the 'real' host root filesystem. This will cause kubeadm to chroot into the provided path.</p></td></tr></tbody></table><h2 id="cmd-upgrade-apply">kubeadm upgrade apply</h2><h3 id="synopsis">Synopsis</h3><p>Upgrade your Kubernetes cluster to the specified version</p><p>The "apply [version]" command executes the following phases:</p><pre tabindex="0"><code>preflight        Run preflight checks before upgrade
control-plane    Upgrade the control plane
upload-config    Upload the kubeadm and kubelet configurations to ConfigMaps
  /kubeadm         Upload the kubeadm ClusterConfiguration to a ConfigMap
  /kubelet         Upload the kubelet configuration to a ConfigMap
kubelet-config   Upgrade the kubelet configuration for this node
bootstrap-token  Configures bootstrap token and cluster-info RBAC rules
addon            Upgrade the default kubeadm addons
  /coredns         Upgrade the CoreDNS addon
  /kube-proxy      Upgrade the kube-proxy addon
post-upgrade     Run post upgrade tasks
</code></pre><pre tabindex="0"><code>kubeadm upgrade apply [version]
</code></pre><h3 id="options">Options</h3><table style="width:100%;table-layout:fixed"><col span="1" style="width:10px"/><col span="1"/><tbody><tr><td colspan="2">--allow-experimental-upgrades</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Show unstable versions of Kubernetes as an upgrade alternative and allow upgrading to an alpha/beta/release candidate versions of Kubernetes.</p></td></tr><tr><td colspan="2">--allow-release-candidate-upgrades</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Show release candidate versions of Kubernetes as an upgrade alternative and allow upgrading to a release candidate versions of Kubernetes.</p></td></tr><tr><td colspan="2">--certificate-renewal     Default: true</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Perform the renewal of certificates used by component changed during upgrades.</p></td></tr><tr><td colspan="2">--config string</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Path to a kubeadm configuration file.</p></td></tr><tr><td colspan="2">--dry-run</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Do not change any state, just output what actions would be performed.</p></td></tr><tr><td colspan="2">--etcd-upgrade     Default: true</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Perform the upgrade of etcd.</p></td></tr><tr><td colspan="2">-f, --force</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Force upgrading although some requirements might not be met. This also implies non-interactive mode.</p></td></tr><tr><td colspan="2">-h, --help</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>help for apply</p></td></tr><tr><td colspan="2">--ignore-preflight-errors strings</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>A list of checks whose errors will be shown as warnings. Example: 'IsPrivilegedUser,Swap'. Value 'all' ignores errors from all checks.</p></td></tr><tr><td colspan="2">--kubeconfig string     Default: "/etc/kubernetes/admin.conf"</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>The kubeconfig file to use when talking to the cluster. If the flag is not set, a set of standard locations can be searched for an existing kubeconfig file.</p></td></tr><tr><td colspan="2">--patches string</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Path to a directory that contains files named "target[suffix][+patchtype].extension". For example, "kube-apiserver0+merge.yaml" or just "etcd.json". "target" can be one of "kube-apiserver", "kube-controller-manager", "kube-scheduler", "etcd", "kubeletconfiguration", "corednsdeployment". "patchtype" can be one of "strategic", "merge" or "json" and they match the patch formats supported by kubectl. The default "patchtype" is "strategic". "extension" must be either "json" or "yaml". "suffix" is an optional string that can be used to determine which patches are applied first alpha-numerically.</p></td></tr><tr><td colspan="2">--print-config</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Specifies whether the configuration file that will be used in the upgrade should be printed or not.</p></td></tr><tr><td colspan="2">--skip-phases strings</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>List of phases to be skipped</p></td></tr><tr><td colspan="2">-y, --yes</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Perform the upgrade and do not prompt for confirmation (non-interactive mode).</p></td></tr></tbody></table><h3 id="options-inherited-from-parent-commands">Options inherited from parent commands</h3><table style="width:100%;table-layout:fixed"><col span="1" style="width:10px"/><col span="1"/><tbody><tr><td colspan="2">--rootfs string</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>The path to the 'real' host root filesystem. This will cause kubeadm to chroot into the provided path.</p></td></tr></tbody></table><h2 id="cmd-upgrade-diff">kubeadm upgrade diff</h2><h3 id="synopsis">Synopsis</h3><p>Show what differences would be applied to existing static pod manifests. See also: kubeadm upgrade apply --dry-run</p><pre tabindex="0"><code>kubeadm upgrade diff [version] [flags]
</code></pre><h3 id="options">Options</h3><table style="width:100%;table-layout:fixed"><col span="1" style="width:10px"/><col span="1"/><tbody><tr><td colspan="2">--config string</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Path to a kubeadm configuration file.</p></td></tr><tr><td colspan="2">-c, --context-lines int     Default: 3</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>How many lines of context in the diff</p></td></tr><tr><td colspan="2">-h, --help</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>help for diff</p></td></tr><tr><td colspan="2">--kubeconfig string     Default: "/etc/kubernetes/admin.conf"</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>The kubeconfig file to use when talking to the cluster. If the flag is not set, a set of standard locations can be searched for an existing kubeconfig file.</p></td></tr></tbody></table><h3 id="options-inherited-from-parent-commands">Options inherited from parent commands</h3><table style="width:100%;table-layout:fixed"><col span="1" style="width:10px"/><col span="1"/><tbody><tr><td colspan="2">--rootfs string</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>The path to the 'real' host root filesystem. This will cause kubeadm to chroot into the provided path.</p></td></tr></tbody></table><h2 id="cmd-upgrade-node">kubeadm upgrade node</h2><h3 id="synopsis">Synopsis</h3><p>Upgrade commands for a node in the cluster</p><p>The "node" command executes the following phases:</p><pre tabindex="0"><code>preflight       Run upgrade node pre-flight checks
control-plane   Upgrade the control plane instance deployed on this node, if any
kubelet-config  Upgrade the kubelet configuration for this node
addon           Upgrade the default kubeadm addons
  /coredns        Upgrade the CoreDNS addon
  /kube-proxy     Upgrade the kube-proxy addon
post-upgrade    Run post upgrade tasks
</code></pre><pre tabindex="0"><code>kubeadm upgrade node [flags]
</code></pre><h3 id="options">Options</h3><table style="width:100%;table-layout:fixed"><col span="1" style="width:10px"/><col span="1"/><tbody><tr><td colspan="2">--certificate-renewal     Default: true</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Perform the renewal of certificates used by component changed during upgrades.</p></td></tr><tr><td colspan="2">--config string</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Path to a kubeadm configuration file.</p></td></tr><tr><td colspan="2">--dry-run</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Do not change any state, just output the actions that would be performed.</p></td></tr><tr><td colspan="2">--etcd-upgrade     Default: true</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Perform the upgrade of etcd.</p></td></tr><tr><td colspan="2">-h, --help</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>help for node</p></td></tr><tr><td colspan="2">--ignore-preflight-errors strings</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>A list of checks whose errors will be shown as warnings. Example: 'IsPrivilegedUser,Swap'. Value 'all' ignores errors from all checks.</p></td></tr><tr><td colspan="2">--kubeconfig string     Default: "/etc/kubernetes/admin.conf"</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>The kubeconfig file to use when talking to the cluster. If the flag is not set, a set of standard locations can be searched for an existing kubeconfig file.</p></td></tr><tr><td colspan="2">--patches string</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>Path to a directory that contains files named "target[suffix][+patchtype].extension". For example, "kube-apiserver0+merge.yaml" or just "etcd.json". "target" can be one of "kube-apiserver", "kube-controller-manager", "kube-scheduler", "etcd", "kubeletconfiguration", "corednsdeployment". "patchtype" can be one of "strategic", "merge" or "json" and they match the patch formats supported by kubectl. The default "patchtype" is "strategic". "extension" must be either "json" or "yaml". "suffix" is an optional string that can be used to determine which patches are applied first alpha-numerically.</p></td></tr><tr><td colspan="2">--skip-phases strings</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>List of phases to be skipped</p></td></tr></tbody></table><h3 id="options-inherited-from-parent-commands">Options inherited from parent commands</h3><table style="width:100%;table-layout:fixed"><col span="1" style="width:10px"/><col span="1"/><tbody><tr><td colspan="2">--rootfs string</td></tr><tr><td/><td style="line-height:130%;word-wrap:break-word"><p>The path to the 'real' host root filesystem. This will cause kubeadm to chroot into the provided path.</p></td></tr></tbody></table><h2 id="what-s-next">What's next</h2><ul><li><a href="/docs/reference/setup-tools/kubeadm/kubeadm-config/">kubeadm config</a> if you initialized your cluster using kubeadm v1.7.x or lower, to configure your cluster for <code>kubeadm upgrade</code></li></ul></div>