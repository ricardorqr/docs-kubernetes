<div class="td-content"><h1 data-pagefind-weight="10">List All Container Images Running in a Cluster</h1><p>This page shows how to use kubectl to list all of the Container images
for Pods running in a cluster.</p><h2 id="before-you-begin">Before you begin</h2><p><p>You need to have a Kubernetes cluster, and the kubectl command-line tool must
be configured to communicate with your cluster. It is recommended to run this tutorial on a cluster with at least two nodes that are not acting as control plane hosts. If you do not already have a
cluster, you can create one by using
<a href="https://minikube.sigs.k8s.io/docs/tutorials/multi_node/">minikube</a>
or you can use one of these Kubernetes playgrounds:</p><ul><li><a href="https://labs.iximiuz.com/playgrounds?category=kubernetes&amp;filter=all">iximiuz Labs</a></li><li><a href="https://killercoda.com/playgrounds/scenario/kubernetes">Killercoda</a></li><li><a href="https://kodekloud.com/public-playgrounds">KodeKloud</a></li><li><a href="https://labs.play-with-k8s.com/">Play with Kubernetes</a></li></ul><p>To check the version, enter <code>kubectl version</code>.</p></p><p>In this exercise you will use kubectl to fetch all of the Pods
running in a cluster, and format the output to pull out the list
of Containers for each.</p><h2 id="list-all-container-images-in-all-namespaces">List all Container images in all namespaces</h2><ul><li>Fetch all Pods in all namespaces using <code>kubectl get pods --all-namespaces</code></li><li>Format the output to include only the list of Container image names
using <code>-o jsonpath={.items[*].spec['initContainers', 'containers'][*].image}</code>. This will recursively parse out the
<code>image</code> field from the returned json.<ul><li>See the <a href="/docs/reference/kubectl/jsonpath/">jsonpath reference</a>
for further information on how to use jsonpath.</li></ul></li><li>Format the output using standard tools: <code>tr</code>, <code>sort</code>, <code>uniq</code><ul><li>Use <code>tr</code> to replace spaces with newlines</li><li>Use <code>sort</code> to sort the results</li><li>Use <code>uniq</code> to aggregate image counts</li></ul></li></ul><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get pods --all-namespaces -o <span style="color:#b8860b">jsonpath</span><span style="color:#666">=</span><span style="color:#b44">"{.items[*].spec['initContainers', 'containers'][*].image}"</span> |<span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>tr -s <span style="color:#b44">'[[:space:]]'</span> <span style="color:#b44">'\n'</span> |<span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>sort |<span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>uniq -c
</span></span></code></pre></div><p>The jsonpath is interpreted as follows:</p><ul><li><code>.items[*]</code>: for each returned value</li><li><code>.spec</code>: get the spec</li><li><code>['initContainers', 'containers'][*]</code>: for each container</li><li><code>.image</code>: get the image</li></ul><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>When fetching a single Pod by name, for example <code>kubectl get pod nginx</code>,
the <code>.items[*]</code> portion of the path should be omitted because a single
Pod is returned instead of a list of items.</div><h2 id="list-container-images-by-pod">List Container images by Pod</h2><p>The formatting can be controlled further by using the <code>range</code> operation to
iterate over elements individually.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get pods --all-namespaces -o <span style="color:#b8860b">jsonpath</span><span style="color:#666">=</span><span style="color:#b44">'{range .items[*]}{"\n"}{.metadata.name}{":\t"}{range .spec.containers[*]}{.image}{", "}{end}{end}'</span> |<span style="color:#b62;font-weight:700">\
</span></span></span><span style="display:flex"><span><span style="color:#b62;font-weight:700"/>sort
</span></span></code></pre></div><h2 id="list-container-images-filtering-by-pod-label">List Container images filtering by Pod label</h2><p>To target only Pods matching a specific label, use the -l flag. The
following matches only Pods with labels matching <code>app=nginx</code>.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get pods --all-namespaces -o <span style="color:#b8860b">jsonpath</span><span style="color:#666">=</span><span style="color:#b44">"{.items[*].spec.containers[*].image}"</span> -l <span style="color:#b8860b">app</span><span style="color:#666">=</span>nginx
</span></span></code></pre></div><h2 id="list-container-images-filtering-by-pod-namespace">List Container images filtering by Pod namespace</h2><p>To target only pods in a specific namespace, use the namespace flag. The
following matches only Pods in the <code>kube-system</code> namespace.</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get pods --namespace kube-system -o <span style="color:#b8860b">jsonpath</span><span style="color:#666">=</span><span style="color:#b44">"{.items[*].spec.containers[*].image}"</span>
</span></span></code></pre></div><h2 id="list-container-images-using-a-go-template-instead-of-jsonpath">List Container images using a go-template instead of jsonpath</h2><p>As an alternative to jsonpath, Kubectl supports using <a href="https://pkg.go.dev/text/template">go-templates</a>
for formatting the output:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>kubectl get pods --all-namespaces -o go-template --template<span style="color:#666">=</span><span style="color:#b44">"{{range .items}}{{range .spec.containers}}{{.image}} {{end}}{{end}}"</span>
</span></span></code></pre></div><h2 id="what-s-next">What's next</h2><h3 id="reference">Reference</h3><ul><li><a href="/docs/reference/kubectl/jsonpath/">Jsonpath</a> reference guide</li><li><a href="https://pkg.go.dev/text/template">Go template</a> reference guide</li></ul></div>