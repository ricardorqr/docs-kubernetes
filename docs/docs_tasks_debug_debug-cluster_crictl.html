<div class="td-content"><h1 data-pagefind-weight="10">Debugging Kubernetes nodes with crictl</h1><div class="feature-state-notice feature-stable"><span class="feature-state-name">FEATURE STATE:</span>
<code>Kubernetes v1.11 [stable]</code></div><p><code>crictl</code> is a command-line interface for CRI-compatible container runtimes.
You can use it to inspect and debug container runtimes and applications on a
Kubernetes node. <code>crictl</code> and its source are hosted in the
<a href="https://github.com/kubernetes-sigs/cri-tools">cri-tools</a> repository.</p><h2 id="before-you-begin">Before you begin</h2><p><code>crictl</code> requires a Linux operating system with a CRI runtime.</p><h2 id="installing-crictl">Installing crictl</h2><p>You can download a compressed archive <code>crictl</code> from the cri-tools
<a href="https://github.com/kubernetes-sigs/cri-tools/releases">release page</a>, for several
different architectures. Download the version that corresponds to your version
of Kubernetes. Extract it and move it to a location on your system path, such as
<code>/usr/local/bin/</code>.</p><h2 id="general-usage">General usage</h2><p>The <code>crictl</code> command has several subcommands and runtime flags. Use
<code>crictl help</code> or <code>crictl &lt;subcommand&gt; help</code> for more details.</p><p>You can set the endpoint for <code>crictl</code> by doing one of the following:</p><ul><li>Set the <code>--runtime-endpoint</code> and <code>--image-endpoint</code> flags.</li><li>Set the <code>CONTAINER_RUNTIME_ENDPOINT</code> and <code>IMAGE_SERVICE_ENDPOINT</code> environment
variables.</li><li>Set the endpoint in the configuration file <code>/etc/crictl.yaml</code>. To specify a
different file, use the <code>--config=PATH_TO_FILE</code> flag when you run <code>crictl</code>.</li></ul><div class="alert alert-info" role="alert"><h4 class="alert-heading">Note:</h4>If you don't set an endpoint, <code>crictl</code> attempts to connect to a list of known
endpoints, which might result in an impact to performance.</div><p>You can also specify timeout values when connecting to the server and enable or
disable debugging, by specifying <code>timeout</code> or <code>debug</code> values in the configuration
file or using the <code>--timeout</code> and <code>--debug</code> command-line flags.</p><p>To view or edit the current configuration, view or edit the contents of
<code>/etc/crictl.yaml</code>. For example, the configuration when using the <code>containerd</code>
container runtime would be similar to this:</p><pre tabindex="0"><code>runtime-endpoint: unix:///var/run/containerd/containerd.sock
image-endpoint: unix:///var/run/containerd/containerd.sock
timeout: 10
debug: true
</code></pre><p>To learn more about <code>crictl</code>, refer to the <a href="https://github.com/kubernetes-sigs/cri-tools/blob/master/docs/crictl.md"><code>crictl</code>
documentation</a>.</p><h2 id="example-crictl-commands">Example crictl commands</h2><p>The following examples show some <code>crictl</code> commands and example output.</p><h3 id="list-pods">List pods</h3><p>List all pods:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>crictl pods
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>POD ID              CREATED              STATE               NAME                         NAMESPACE           ATTEMPT
926f1b5a1d33a       About a minute ago   Ready               sh-84d7dcf559-4r2gq          default             0
4dccb216c4adb       About a minute ago   Ready               nginx-65899c769f-wv2gp       default             0
a86316e96fa89       17 hours ago         Ready               kube-proxy-gblk4             kube-system         0
919630b8f81f1       17 hours ago         Ready               nvidia-device-plugin-zgbbv   kube-system         0
</code></pre><p>List pods by name:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>crictl pods --name nginx-65899c769f-wv2gp
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>POD ID              CREATED             STATE               NAME                     NAMESPACE           ATTEMPT
4dccb216c4adb       2 minutes ago       Ready               nginx-65899c769f-wv2gp   default             0
</code></pre><p>List pods by label:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>crictl pods --label <span style="color:#b8860b">run</span><span style="color:#666">=</span>nginx
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>POD ID              CREATED             STATE               NAME                     NAMESPACE           ATTEMPT
4dccb216c4adb       2 minutes ago       Ready               nginx-65899c769f-wv2gp   default             0
</code></pre><h3 id="list-images">List images</h3><p>List all images:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>crictl images
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>IMAGE                                     TAG                 IMAGE ID            SIZE
busybox                                   latest              8c811b4aec35f       1.15MB
k8s-gcrio.azureedge.net/hyperkube-amd64   v1.10.3             e179bbfe5d238       665MB
k8s-gcrio.azureedge.net/pause-amd64       3.1                 da86e6ba6ca19       742kB
nginx                                     latest              cd5239a0906a6       109MB
</code></pre><p>List images by repository:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>crictl images nginx
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>IMAGE               TAG                 IMAGE ID            SIZE
nginx               latest              cd5239a0906a6       109MB
</code></pre><p>Only list image IDs:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>crictl images -q
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>sha256:8c811b4aec35f259572d0f79207bc0678df4c736eeec50bc9fec37ed936a472a
sha256:e179bbfe5d238de6069f3b03fccbecc3fb4f2019af741bfff1233c4d7b2970c5
sha256:da86e6ba6ca197bf6bc5e9d900febd906b133eaa4750e6bed647b0fbe50ed43e
sha256:cd5239a0906a6ccf0562354852fae04bc5b52d72a2aff9a871ddb6bd57553569
</code></pre><h3 id="list-containers">List containers</h3><p>List all containers:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>crictl ps -a
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>CONTAINER ID        IMAGE                                                                                                             CREATED             STATE               NAME                       ATTEMPT
1f73f2d81bf98       busybox@sha256:141c253bc4c3fd0a201d32dc1f493bcf3fff003b6df416dea4f41046e0f37d47                                   7 minutes ago       Running             sh                         1
9c5951df22c78       busybox@sha256:141c253bc4c3fd0a201d32dc1f493bcf3fff003b6df416dea4f41046e0f37d47                                   8 minutes ago       Exited              sh                         0
87d3992f84f74       nginx@sha256:d0a8828cccb73397acb0073bf34f4d7d8aa315263f1e7806bf8c55d8ac139d5f                                     8 minutes ago       Running             nginx                      0
1941fb4da154f       k8s-gcrio.azureedge.net/hyperkube-amd64@sha256:00d814b1f7763f4ab5be80c58e98140dfc69df107f253d7fdd714b30a714260a   18 hours ago        Running             kube-proxy                 0
</code></pre><p>List running containers:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>crictl ps
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>CONTAINER ID        IMAGE                                                                                                             CREATED             STATE               NAME                       ATTEMPT
1f73f2d81bf98       busybox@sha256:141c253bc4c3fd0a201d32dc1f493bcf3fff003b6df416dea4f41046e0f37d47                                   6 minutes ago       Running             sh                         1
87d3992f84f74       nginx@sha256:d0a8828cccb73397acb0073bf34f4d7d8aa315263f1e7806bf8c55d8ac139d5f                                     7 minutes ago       Running             nginx                      0
1941fb4da154f       k8s-gcrio.azureedge.net/hyperkube-amd64@sha256:00d814b1f7763f4ab5be80c58e98140dfc69df107f253d7fdd714b30a714260a   17 hours ago        Running             kube-proxy                 0
</code></pre><h3 id="execute-a-command-in-a-running-container">Execute a command in a running container</h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>crictl <span style="color:#a2f">exec</span> -i -t 1f73f2d81bf98 ls
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>bin   dev   etc   home  proc  root  sys   tmp   usr   var
</code></pre><h3 id="get-a-container-s-logs">Get a container's logs</h3><p>Get all container logs:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>crictl logs 87d3992f84f74
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>10.240.0.96 - - [06/Jun/2018:02:45:49 +0000] "GET / HTTP/1.1" 200 612 "-" "curl/7.47.0" "-"
10.240.0.96 - - [06/Jun/2018:02:45:50 +0000] "GET / HTTP/1.1" 200 612 "-" "curl/7.47.0" "-"
10.240.0.96 - - [06/Jun/2018:02:45:51 +0000] "GET / HTTP/1.1" 200 612 "-" "curl/7.47.0" "-"
</code></pre><p>Get only the latest <code>N</code> lines of logs:</p><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="display:flex"><span>crictl logs --tail<span style="color:#666">=</span><span style="color:#666">1</span> 87d3992f84f74
</span></span></code></pre></div><p>The output is similar to this:</p><pre tabindex="0"><code>10.240.0.96 - - [06/Jun/2018:02:45:51 +0000] "GET / HTTP/1.1" 200 612 "-" "curl/7.47.0" "-"
</code></pre><h2 id="what-s-next">What's next</h2><ul><li><a href="https://github.com/kubernetes-sigs/cri-tools">Learn more about <code>crictl</code></a>.</li></ul></div>